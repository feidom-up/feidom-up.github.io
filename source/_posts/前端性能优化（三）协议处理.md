---
title: 前端性能优化（三）协议处理
date: 2020-07-21 09:28:22
tags: 前端性能优化
categories: 前端性能优化
---

### http请求的代价是昂贵的
HTTP 缓存，对于前端的性能优化方面来讲，是非常关键的，从缓存中读取数据和直接向服务器请求数据。

### 协议缓存规则

浏览器发起请求，服务器响应请求。在这个过程中，双方协商了两种方式来规定缓存规则。
* 强缓存：
    浏览器在加载资源时，根据请求头的 `Expires` 和 `Cache-control` 判断，是则直接从缓存读取资源，不会发请求到服务器。
    优先级高于**协商缓存**
    ![强缓存命中](http://i.feidom.com/%E5%BC%BA%E7%BC%93%E5%AD%98%E5%91%BD%E4%B8%AD.gif)
    ![强缓存未命中](http://i.feidom.com/%E5%BC%BA%E7%BC%93%E5%AD%98%E5%A4%B1%E6%95%88.gif)
* 协商缓存
    如果没有命中**强缓存**，加载资源的请求会发送到服务器，通过 `Last-Modified` 和 `Etag` 验证资源是否命中协商缓存，如果命中，服务器会将这个请求返回**304**（Not Modified），但是不会返回这个资源的数据，依然是从缓存中读取资源。
    ![协商缓存命中](http://i.feidom.com/%E5%8D%8F%E5%95%86%E7%BC%93%E5%AD%98%E5%91%BD%E4%B8%AD.gif)
    ![协商缓存未命中](http://i.feidom.com/%E5%8D%8F%E5%95%86%E7%BC%93%E5%AD%98%E6%9C%AA%E5%91%BD%E4%B8%AD.gif)
如果前面两者都没有命中，直接从服务器加载资源。
