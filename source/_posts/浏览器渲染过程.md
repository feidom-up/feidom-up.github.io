---
title: 浏览器渲染过程
date: 2020-07-22 14:32:38
tags:
---

Frames 每一帧
Interactions 交互
    Animation 动画
Timing 
    FP
    FCP  
    FMp
Experience 经历
Main 主线程
Raster 光栅
GPU
Chrome_ChildOThread
Compositor
 
Composite Layers  合成层
Update Layer Tree 更新Layer树
Recalculate Style 计算样式
Layout 重排
Paint 重绘
Parse HTML  解析HTML
Evaluate Script   评估Script
    Compile Script 编译脚本






1. Dom是分层的
2. 对DOM元素节点计算样式结果 Recalculate Style
3. 为每个节点生成图形位置 Layout 回流/重排
4. 将每个节点绘制填充到图层位图中 Paint
5. 把图层作为纹理，上传到GPU
6. Composite Layers  合成层  把符合的图层生成到页面上

Layout =》 Paint =》 Composite Layers


Composite Layers做了啥？
    图层的绘制列表，准备好，commit给（合成线程）主线程
    合成线程 viewport 划分图块 
    生成位图的过程  就是光栅化 Raster
    所有图块 合成DarwQuad提交给浏览器渲染进程
    viz组件接收到DarwQuad 后，绘制到屏幕上


什么元素会分层？
    根元素，position层，transform、半透明、css滤镜、canvas、video、overflow

什么会触发硬件加速，让GPU加入进来
    CSS3D、video、webgl、transform、css滤镜、will-change:transform



什么会重绘重排？
    盒子模型的盒子变了=》重排
    读属性时：offset、scroll、client、width会造成重排
    解决方式: 读写读写读写=》读读读写写写
    ```javascript
        const width = document.getElementById("xx").width;
        requestAnimationFrame(function(){
            // 写逻辑
            // react基础
        })
    ```

跳过重排重绘 直接触发了GPU执行  这就是硬件加速

cpu主要负责操作系统和程序  gpu负责显式  数据处理效率更高  gpu.js

csstriggers.com