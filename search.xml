<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>hhkbå¿«æ·é”®å¤‡å¿˜</title>
    <url>/2024/08/22/hhkb%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%A4%87%E5%BF%98/</url>
    <content><![CDATA[<h3 id="åˆ‡æ¢è¿æ¥æ–¹å¼ï¼š"><a href="#åˆ‡æ¢è¿æ¥æ–¹å¼ï¼š" class="headerlink" title="åˆ‡æ¢è¿æ¥æ–¹å¼ï¼š"></a>åˆ‡æ¢è¿æ¥æ–¹å¼ï¼š</h3><ul>
<li>fn+ctrl+0 æœ‰çº¿</li>
<li>fn+ctrl+1~4 è“ç‰™è®¾å¤‡</li>
</ul>
<h3 id="è“ç‰™é…å¯¹ä¿¡æ¯æ³¨å†Œï¼š"><a href="#è“ç‰™é…å¯¹ä¿¡æ¯æ³¨å†Œï¼š" class="headerlink" title="è“ç‰™é…å¯¹ä¿¡æ¯æ³¨å†Œï¼š"></a>è“ç‰™é…å¯¹ä¿¡æ¯æ³¨å†Œï¼š</h3><ul>
<li>fn+q è¿›å…¥ç­‰å¾…é…å¯¹æ¨¡å¼</li>
<li>fn+ctrl+1<del>4 å°†å³å°†è¦é…å¯¹çš„è®¾å¤‡å­˜æ”¾åˆ° 1</del>4 ä½ç½®ã€‚</li>
</ul>
<h3 id="åˆ é™¤æ‰€æœ‰é…å¯¹ä¿¡æ¯ï¼š"><a href="#åˆ é™¤æ‰€æœ‰é…å¯¹ä¿¡æ¯ï¼š" class="headerlink" title="åˆ é™¤æ‰€æœ‰é…å¯¹ä¿¡æ¯ï¼š"></a>åˆ é™¤æ‰€æœ‰é…å¯¹ä¿¡æ¯ï¼š</h3><ul>
<li>fn+q è¿›å…¥ç­‰å¾…é…å¯¹æ¨¡å¼</li>
<li>fn+z+delete</li>
</ul>
<h3 id="åˆ é™¤ä¸ªåˆ«é…å¯¹ä¿¡æ¯ï¼š"><a href="#åˆ é™¤ä¸ªåˆ«é…å¯¹ä¿¡æ¯ï¼š" class="headerlink" title="åˆ é™¤ä¸ªåˆ«é…å¯¹ä¿¡æ¯ï¼š"></a>åˆ é™¤ä¸ªåˆ«é…å¯¹ä¿¡æ¯ï¼š</h3><ul>
<li>fn+q è¿›å…¥ç­‰å¾…é…å¯¹æ¨¡å¼</li>
<li>fn+ctrl+delete+1~4</li>
</ul>
<h3 id="é…å¯¹ä¸­é€”å–æ¶ˆé…å¯¹ï¼š"><a href="#é…å¯¹ä¸­é€”å–æ¶ˆé…å¯¹ï¼š" class="headerlink" title="é…å¯¹ä¸­é€”å–æ¶ˆé…å¯¹ï¼š"></a>é…å¯¹ä¸­é€”å–æ¶ˆé…å¯¹ï¼š</h3><ul>
<li>fn+q è¿›å…¥ç­‰å¾…é…å¯¹æ¨¡å¼</li>
<li>fn+x</li>
</ul>
<h3 id="è½¯æ”¹åˆ‡æ¢æ¨¡å¼ï¼ˆé-DIPï¼Œä»…åœ¨æ— çº¿çŠ¶æ€ä¸‹æœ‰æ•ˆï¼‰"><a href="#è½¯æ”¹åˆ‡æ¢æ¨¡å¼ï¼ˆé-DIPï¼Œä»…åœ¨æ— çº¿çŠ¶æ€ä¸‹æœ‰æ•ˆï¼‰" class="headerlink" title="è½¯æ”¹åˆ‡æ¢æ¨¡å¼ï¼ˆé DIPï¼Œä»…åœ¨æ— çº¿çŠ¶æ€ä¸‹æœ‰æ•ˆï¼‰"></a>è½¯æ”¹åˆ‡æ¢æ¨¡å¼ï¼ˆé DIPï¼Œä»…åœ¨æ— çº¿çŠ¶æ€ä¸‹æœ‰æ•ˆï¼‰</h3><ul>
<li>åˆ‡æ¢ä¸º win æ¨¡å¼ï¼šfn+ctrl+w</li>
<li>åˆ‡æ¢ä¸º mac æ¨¡å¼ï¼šfn+ctrl+m</li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>Javascript-in-V8</title>
    <url>/2021/12/30/Javascript-in-V8/</url>
    <content><![CDATA[<p>ä¹‹å‰å¯¹<a class="link"   href="http://www.feidom.com/2021/08/09/js%E5%AF%B9%E8%B1%A1%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%89%B9%E7%82%B9/"  target="_blank" rel="noopener">jså¯¹è±¡ä½ ä¸çŸ¥é“çš„é‚£äº›ç‰¹ç‚¹<i class="fas fa-external-link-alt"></i></a> æœ‰ä¸€äº›ç²—æµ…çš„è®¤è¯†ï¼Œè¿™ä¸ªç¬”è®°å†™çš„å¾ˆæ— ç†å–é—¹ã€‚ç°åœ¨ç ”ç©¶æ¸…æ¥šä»¥åï¼Œé‡æ–°è¡¥ä¸€ç¯‡ç¬”è®°æ¥å®Œå–„çŸ¥è¯†ã€‚ä¹‹å‰çš„è¿™ç¯‡å°±ç•™ç€å§ï¼Œä¹Ÿæ˜¯å­¦ä¹ å’Œæ€è€ƒä¸­ä¸€ä¸ªå¿…æœ‰çš„è®¤çŸ¥é˜¶æ®µã€‚</p>
<h4 id="JS-Object-ä¸­çš„å¸¸è§„å±æ€§å’Œæ’åºå±æ€§"><a href="#JS-Object-ä¸­çš„å¸¸è§„å±æ€§å’Œæ’åºå±æ€§" class="headerlink" title="JS Object ä¸­çš„å¸¸è§„å±æ€§å’Œæ’åºå±æ€§"></a>JS Object ä¸­çš„å¸¸è§„å±æ€§å’Œæ’åºå±æ€§</h4><ul>
<li><p>å¸¸è§„å±æ€§(V8:properties)<br>åœ¨propertieså¯¹è±¡ä¸­ï¼Œä¼šæŒ‰ç…§åˆ›å»ºæ—¶çš„é¡ºåºä¿å­˜å¸¸è§„å±æ€§ã€‚</p>
</li>
<li><p>æ’åºå±æ€§(V8:elements)<br>å½“keyä¸ºæ•°å­—æ—¶ï¼Œä¼šå°†è¿™ç±»å±æ€§å­˜å‚¨åœ¨elementså¯¹è±¡ä¸­ï¼Œå°†å…¶ä½œä¸ºä¸€å—è¿ç»­çš„å†…å­˜ä»¥Arrayçš„å½¢å¼è¿›è¡Œå­˜å‚¨ã€‚åœ¨elementså¯¹è±¡ä¸­ï¼Œä¼šæŒ‰ç…§æ•°å­—å¤§å°çš„é¡ºåºæ¥å­˜æ”¾æ’åºå±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassA</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>[<span class="number">100</span>] = <span class="string">'100'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="number">1</span>] = <span class="string">'1'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="string">'B1'</span>] = <span class="string">'B'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="number">50</span>] = <span class="string">'50'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="number">3</span>] = <span class="string">'3'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="string">'A2'</span>] = <span class="string">'A'</span>;</span><br><span class="line">  <span class="keyword">this</span>[<span class="string">'C'</span>] = <span class="string">'C'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> ClassA();</span><br><span class="line"><span class="keyword">for</span>(key <span class="keyword">in</span> a)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;a[key]&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line">a.qwf = <span class="string">'qwf'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i&lt;num; i++)&#123;</span><br><span class="line">    <span class="keyword">this</span>[i] = <span class="string">`eeeeee_<span class="subst">$&#123;i&#125;</span>`</span></span><br><span class="line">    <span class="keyword">this</span>[<span class="string">`p_<span class="subst">$&#123;i&#125;</span>`</span>] = <span class="string">`pppppp_<span class="subst">$&#123;i&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> ClassB(<span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(b)</span><br></pre></td></tr></table></figure>

<p>ä½œä¸ºä¸¤ä¸ªå±æ€§ï¼Œä¸ºå•¥åœ¨consoleçš„æ§åˆ¶å°æ‰“å°çš„ç»“æœä¸­æ²¡æœ‰å‘ç°å‘¢ã€‚å…¶å®consoleçš„æ§åˆ¶å°æ‰“å°çš„æ²¡é‚£ä¹ˆæ·±ï¼Œé‚£æ€ä¹ˆèƒ½æ‰¾åˆ°ä»–ä»¬å‘¢ã€‚åœ¨Memoryæ§åˆ¶å°å½•åˆ¶å¿«ç…§ï¼Œå°±èƒ½å¾ˆæ˜æ˜¾çš„çœ‹åˆ°ä»–ä»¬ã€‚</p>
</li>
</ul>
<h4 id="V8å¼•æ“å¯¹Objectåšäº†ä»€ä¹ˆæ®‹å¿çš„äº‹"><a href="#V8å¼•æ“å¯¹Objectåšäº†ä»€ä¹ˆæ®‹å¿çš„äº‹" class="headerlink" title="V8å¼•æ“å¯¹Objectåšäº†ä»€ä¹ˆæ®‹å¿çš„äº‹"></a>V8å¼•æ“å¯¹Objectåšäº†ä»€ä¹ˆæ®‹å¿çš„äº‹</h4><ul>
<li><p>Hidden Class éšè—ç±»</p>
</li>
<li><p>Properties pointer å¸¸è§„å±æ€§æŒ‡é’ˆ</p>
</li>
<li><p>Elements pointer æ’åºå…ƒç´ æŒ‡é’ˆ</p>
<p>ä¸ºä»€ä¹ˆè¦è¿™æ ·åˆ†å¼€å‘¢ï¼Ÿï¼Ÿï¼Ÿ<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦èŠä¸€ä¸‹å…¬è®¤æœ€å¿«çš„Cè¯­è¨€ï¼Œå®ƒçš„å¿«å¾ˆå¤§ç¨‹åº¦ä¸Šå½’åŠŸäºå®ƒä¸¥æ ¼çš„ç±»å‹çº¦æŸã€‚ä¹Ÿå°±æ˜¯è¯´å¤§å‹çš„é¢å‘å¯¹è±¡ç³»ç»Ÿéƒ½æœ‰ä¸¥æ ¼çš„æ•°æ®ç»“æ„ï¼Œè¿™å¯¹å¿«é€Ÿçš„å±æ€§æŸ¥è¯¢å¾ˆå…³é”®ã€‚<br>æ‰€ä»¥ï¼ŒJsä¸­çš„Objectçš„å®šä¹‰éå¸¸å·®,å› ä¸ºå®ƒå¤ªçµæ´»äº†ï¼Œæ²¡æœ‰ç±»å‹çš„æ¦‚å¿µã€‚è€Œä¸”å­˜åœ¨å¯ä»¥ä»»æ€§ä¿®æ”¹çš„åŸå‹é“¾ï¼Œå®ƒæ²¡æœ‰é™åˆ¶ã€‚<br>æ‰€ä»¥åœ¨V8å¯¹JS Objectè¿›è¡Œå¤„ç†æ—¶ï¼Œä¸ºäº†å¿«é€Ÿçš„å±æ€§æŸ¥è¯¢ï¼Œæœ‰ä¸€ä¸ªå†…éƒ¨çš„ç±»å‹ç³»ç»Ÿï¼šå¯¹å…·æœ‰ç›¸åŒç»“æ„çš„å¯¹è±¡è¿›è¡Œåˆ†ç»„ï¼›å„ä¸ªå¯¹è±¡ä¹‹é—´å¯ä»¥å…±äº«ï¼›ç”Ÿæˆçš„æˆæœ¬å¾ˆé«˜ï¼Œä½†æ˜¯ä¹‹åçš„æˆæœ¬å¾ˆä½ã€‚</p>
</li>
</ul>
<h4 id="V8å¯¹Objectåšçš„ä¼˜åŒ–"><a href="#V8å¯¹Objectåšçš„ä¼˜åŒ–" class="headerlink" title="V8å¯¹Objectåšçš„ä¼˜åŒ–"></a>V8å¯¹Objectåšçš„ä¼˜åŒ–</h4><p>  å±æ€§å†…è”ç¼“å­˜<br>  åœ¨å±æ€§æŸ¥è¯¢ä¸­æ£€æŸ¥éšè—ç±»</p>
<ol>
<li>åœ¨ç¬¬ä¸€æ¬¡æ—¶å®Œå…¨é€šç”¨æŸ¥è¯¢</li>
<li>ç„¶åè®°ä½ä½ åœ¨å“ªä¸ªåœ°æ–¹æ‰¾åˆ°çš„è¿™ä¸ªå±æ€§<br>ç”Ÿæˆæ–°çš„ä¼˜åŒ–ä»£ç </li>
<li>ä¸‹æ¬¡ä½¿ç”¨ï¼Œç›´æ¥è®¿é—®</li>
</ol>
<h4 id="Object-å±æ€§çš„å­˜å‚¨"><a href="#Object-å±æ€§çš„å­˜å‚¨" class="headerlink" title="Object å±æ€§çš„å­˜å‚¨"></a>Object å±æ€§çš„å­˜å‚¨</h4><ul>
<li>ç›´æ¥åœ¨objectä¸Šï¼Œå³é»˜è®¤çŠ¶æ€ï¼Œè¿™ä¸ªå¾ˆå¿«</li>
<li>arrayå½¢å¼å­˜å‚¨ï¼Œä¹Ÿå¾ˆå¿«</li>
<li>å“ˆå¸Œè¡¨ç»“æ„ï¼ˆå­—å…¸æ¨¡å¼ï¼‰ï¼Œè¿™ä¸ªçš„äº¤äº’ä¼šæ…¢å¾ˆå¤š<br>å­—å…¸æ¨¡å¼ç›¸æ¯”äºå…¶ä»–æ¨¡å¼ï¼Œè¿è¡Œé€Ÿåº¦é™ä½ã€‚è§¦å‘å­—å…¸æ¨¡å¼çš„è¡Œä¸ºå¦‚ä¸‹ï¼š</li>
<li>éå¸¸å¤šçš„å±æ€§ï¼Œä»–ä»¬æ²¡æœ‰åŠæ³•è¢«æ”¾åœ¨é»˜è®¤çŠ¶æ€çš„å†…å­˜ä¸­ï¼Œè¿™ä¸ªæ•°å­—å¯èƒ½æ˜¯10 ï¼Ÿ30ï¼Ÿ</li>
<li>æ”¹å˜å±æ€§</li>
<li>åˆ é™¤å±æ€§</li>
</ul>
<h4 id="JS-Array-å­—å…¸æ¨¡å¼"><a href="#JS-Array-å­—å…¸æ¨¡å¼" class="headerlink" title="JS Array å­—å…¸æ¨¡å¼"></a>JS Array å­—å…¸æ¨¡å¼</h4><p>  åŒæ ·å¯¹æ¯”Cï¼ŒJsä¸­çš„Arrayä¹Ÿå› ä¸ºæ²¡æœ‰ç±»å‹çº¦æŸç»™äº†ç”¨æˆ·å¾ˆå¤§çš„è‡ªç”±ï¼Œä¹ŸæŒºæ ·å¸¦æ¥äº†ä¸å¯æ§çš„æ€§èƒ½é—®é¢˜ã€‚<br>  è¿ç»­å†…å­˜çš„å­˜å‚¨å’Œhashè¡¨ï¼ˆå­—å…¸æ¨¡å¼ï¼‰ä¸åŒçš„å­˜å‚¨æ–¹å¼ï¼Œä¸ä¸€æ ·çš„æ€§èƒ½ä½“éªŒã€‚<br>  è§¦å‘å­—å…¸æ¨¡å¼çš„è¡Œä¸ºå¦‚ä¸‹ï¼š</p>
<ol>
<li><p>éå¸¸å¤šçš„å±æ€§ï¼Œå¤§äº1024ï¼Ÿ 10000ï¼Ÿ</p>
</li>
<li><p>åŠ¨æ€æ‰©å®¹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">a[<span class="number">1000</span>] = <span class="number">8</span>;</span><br><span class="line"><span class="comment">// ok</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1000</span>);</span><br><span class="line">a[<span class="number">0</span>] = <span class="string">'nihao'</span>;</span><br><span class="line">a[<span class="number">100</span>] = <span class="number">8</span>;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="ç»“åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬åº”è¯¥åšä»€ä¹ˆ"><a href="#ç»“åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬åº”è¯¥åšä»€ä¹ˆ" class="headerlink" title="ç»“åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬åº”è¯¥åšä»€ä¹ˆ"></a>ç»“åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œæˆ‘ä»¬åº”è¯¥åšä»€ä¹ˆ</h4><p>  Jsç»™æˆ‘ä»¬å¾ˆé«˜çš„çµæ´»åº¦è®©æˆ‘ä»¬éšå¿ƒæ‰€æ¬²ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸åº”è¯¥ä¸ºæ‰€æ¬²ä¸ºï¼Œè‡ªç”±åº¦é«˜ï¼Œå¸¦æ¥çš„å°±æ˜¯æ€§èƒ½çš„ä¸å‹å¥½ã€‚<br>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassA</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>[<span class="number">100</span>] = <span class="string">'100'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> ClassA();</span><br><span class="line">a.qwf = <span class="string">'qwf'</span>;  <span class="comment">// è¿™æ ·ç›´æ¥æ·»åŠ å±æ€§ï¼Œæ”¹å˜äº†éšè—ç±»</span></span><br></pre></td></tr></table></figure><br>  æ‰€ä»¥å°½é‡å®šä¹‰å¥½é»˜è®¤å±æ€§ï¼Œä¸è¦åœ¨æ„é€ å‡½æ•°ä¹‹å¤–åšå¤§é‡çš„åŠ¨æ€å±æ€§æ·»åŠ å’Œåˆ é™¤ï¼Œå°½é‡å…±äº«éšè—ç±»ã€‚</p>
<h4 id="V8"><a href="#V8" class="headerlink" title="V8"></a>V8</h4><p>  <a class="link"   href="https://v8.dev/"  target="_blank" rel="noopener">V8<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">The first type of attry to talk about in javascript is the TypedArray</span><br><span class="line"></span><br><span class="line">So TypedArrays are going to make a lot of aense to you if</span><br><span class="line">you are coming from a C background</span><br><span class="line"></span><br><span class="line">They are contiguous blocks of memory that are specified for a particylar data type.</span><br><span class="line"></span><br><span class="line">So you have Uint32Array, Float64Array, Unit8Array, and so on, and so forth, which actually, if you are familiar with Javascript,is sort of unusual. Because most things in Javascript have no type. </span><br><span class="line"></span><br><span class="line">So this idea that we are specifying a very specific size for our numbers id actually like pretty unique. And that&#39;s because the TypedArray specification grew up alongside the WebGL specification.</span><br><span class="line"></span><br><span class="line">And you can inagine how you need that level of specificity if you are doing graphics programming.</span><br><span class="line"></span><br><span class="line">So that&#39;s sort of where the TypedArray specification came from.</span><br><span class="line"></span><br><span class="line">But it&#39;s been adopted into other things now that it&#39;s there.</span><br><span class="line"></span><br><span class="line">So agein, they&#39;re memory efficient. You don&#39;t have to box them.</span><br><span class="line"></span><br><span class="line">They behave as you&#39;d expect.</span><br><span class="line"></span><br><span class="line">They&#39;re a very nice option for arrays.</span><br><span class="line"></span><br><span class="line">But if you can&#39;t use TypedArrays for whatever reason, you need to use Javascript Arrays.</span><br><span class="line"></span><br><span class="line">SO Javascript Array object --Array with a captital A-- has an API which is going to look a little weird to you if you are used to C-style arrays.</span><br><span class="line"></span><br><span class="line">It&#39;s going to have operations that are different.</span><br><span class="line"></span><br><span class="line">It&#39;s going to have like push and pop.</span><br><span class="line"></span><br><span class="line">It&#39;s going to allow you to index out of bounds.</span><br><span class="line"></span><br><span class="line">It&#39;s going to have just sort of odd behavior to me as somebody coming from C.</span><br><span class="line"></span><br><span class="line">So as you can imagine, because the API allows all these non-C array-like things, the backing storage in V8 is not always somethings that looks like array. There are actually two diffent types of backing storage for arrays. Thewe are sparse arrays and dense arrays, which map to either something tach looks like a C-style array. like you&#39;d expect, or a hash table. And if you array is backed by a V8 hash table, that&#39;s called being in dictionary mode, and it&#39;s considerably less efficient. It&#39;s case that you want to avoid.</span><br><span class="line"></span><br><span class="line">There are many factors in V8 that causes you to be kicked into dictionary mode or not. </span><br><span class="line"></span><br><span class="line">So it&#39;s kind of complicated to define them all. </span><br><span class="line"></span><br><span class="line">But one of them, for instance, is space efficiency.</span><br><span class="line"></span><br><span class="line">So is the codes you wrote will be three times more effcient, use three times less space if it was backed by a hash table than an array, then it&#39;ll be a hsah table on back end. So there are criteria like that. </span><br><span class="line"></span><br><span class="line">js allows you to create a new uninitialized array and then just suddenly index into it at whatever index.</span><br><span class="line"></span><br><span class="line">This, doesn&#39;t make any sense in C. It&#39;s not something you&#39;d actually do. And in V8, it will immediately trigger dictionary mode. So this, you will now have a nice, slow array to waok with, not something you want.</span><br><span class="line"></span><br><span class="line">So real simple change.</span><br><span class="line"></span><br><span class="line">All you have to do is declare how much storage you want up font.Now you have declared to V8 that you actually want an array of a certain size. V8 will back your array by a contigous array of that size, and you can go from there.</span><br><span class="line"></span><br><span class="line">Veay sensible, kind of no-brainerish, but again, Javascript allows you to do it in a way that ends up being very inefficient, so it&#39;s important to know.</span><br><span class="line"></span><br><span class="line">So that is the numeric representation and the immediate representation of objects.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">Object in V8 </span><br><span class="line">-------------------------------</span><br><span class="line"></span><br><span class="line">So objects in JavaScript are there very poorly defined things.</span><br><span class="line"></span><br><span class="line">They are associative arrays.</span><br><span class="line"></span><br><span class="line">They&#39;re just bundles of key value pairs of properties.</span><br><span class="line"></span><br><span class="line">So you have string balue for key, property value.</span><br><span class="line"></span><br><span class="line">And all property values are these undefined whatevers, because Javascript doesn&#39;t have a notion of type.</span><br><span class="line"></span><br><span class="line">Object have prototype chains. You can add and remove properties anywhere at the prototype chain and on the object inself at any point. </span><br><span class="line"></span><br><span class="line">Javascript doesn&#39;t enforce any specificity or structure in your code.</span><br><span class="line"></span><br><span class="line">So if you wanted to, you could make every single object in your whole program absolutely a unique set of properties.</span><br><span class="line"></span><br><span class="line">Nothing in Javascript will enforce structure or self-similarity.</span><br><span class="line"></span><br><span class="line">But just because JavaScript allows you to do that, you really,really shouldn&#39;t.</span><br><span class="line"></span><br><span class="line">That&#39;s actually a terrible thing to do for performance.</span><br><span class="line"></span><br><span class="line">And I&#39;ll explain why in a minute.</span><br><span class="line"></span><br><span class="line">So in V8,the V8 team looked at trying to write a large-scale application in JavaScript and thought, hey, you know what&#39;s important in large-scale systems is object-orientenness.</span><br><span class="line"></span><br><span class="line">And if you have object-orientenness in your system, then now, property access is one of the key things that you need to make fast. </span><br><span class="line"></span><br><span class="line">So V8 designed its structure to make property access on objects as efficient as it could be.</span><br><span class="line"></span><br><span class="line">So the internal representation of an object in V8 is three words.</span><br><span class="line"></span><br><span class="line">So first, we have a hidden class pointer, which is an internal notion of type, which I&#39;ll explain in a second.</span><br><span class="line"></span><br><span class="line">And then we have two pointers to different kinds of properties.</span><br><span class="line"></span><br><span class="line">We have properties that have string names and then properties that have int names. </span><br><span class="line"></span><br><span class="line">But really, the only thing that&#39;s important is your have a type, and then you have property storage.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">So waht&#39;s this hidden class thing?</span><br><span class="line"></span><br><span class="line">So hidden classes, again, ther&#39;re V8&#39;s interbal notion of type.</span><br><span class="line"></span><br><span class="line">JavaScript itself isn&#39;t going to enforce any kind of notionof type on you.</span><br><span class="line"></span><br><span class="line">BUt in order to make things effcient, V8itself need to have some sort of structure in whst it things you&#39;re doing. </span><br><span class="line"></span><br><span class="line">So it introduces a type system.</span><br><span class="line"></span><br><span class="line">And that type system froups objects with the same structure.</span><br><span class="line"></span><br><span class="line">So as you&#39;re adding properties to objects, which you can do in JavaScript, V8 will be looking at the properties on each object and mapping ta&#x3D;hat bundle of properties to a hidden class, which defines an object with exactly those properties.</span><br><span class="line"></span><br><span class="line">So, dor instance, if I have this constructor in JavaScript where I have a point, and it has an x and y, and the way those values are added by first adding x to the object and then adding y, thay&#39;s going to generate a hidden class that backs objects that are created from this function that has exactle the properties x and y.</span><br><span class="line"></span><br><span class="line">And that really seems sort of obvious.</span><br><span class="line"></span><br><span class="line">But then, the first time this function is run, that hidden class is going to be built for the first time. And then, all subsequent times this dunction is run, those new objects can share the same hidden class.So you only pay the price for building it the very first time.</span><br><span class="line"></span><br><span class="line">After that, you can just use the same object.</span><br><span class="line"></span><br><span class="line">So we went through all this trouble of building up a notion of type.</span><br><span class="line"></span><br><span class="line">So now, we have types that correspond to specifically what exact </span><br><span class="line">properties are on an object.</span><br><span class="line"></span><br><span class="line">We can use taht notion of type to make property access quick using something called inline caching.</span><br><span class="line"></span><br><span class="line">So if yoiu want to look up a property on an object in Javascript, you&#39;re going to say, I am looking for property with name x on object y.</span><br><span class="line"></span><br><span class="line">The first thing you do whrn you&#39;re trying to look up a property is check the hidden class of the object.</span><br><span class="line"></span><br><span class="line">If you&#39;re never tried to look up that property on an object of that type before, then what you&#39;re going to have to do is a fully generic search for that property.</span><br><span class="line"></span><br><span class="line">So again, we just have a bundle of properties somewhere.</span><br><span class="line"></span><br><span class="line">They all have string names.</span><br><span class="line"></span><br><span class="line">You have a string of the property you&#39;re looking for.</span><br><span class="line"></span><br><span class="line">And you&#39;re going to have to look through taht list for the property that has a matching name.</span><br><span class="line"></span><br><span class="line">That&#39;s a pretty slow operation.</span><br><span class="line"></span><br><span class="line">But once you found thst property once, you can remember the offset to it. you can remember where you found that property and use it later, which means that you can use that to generate new optimized code which specifies how you look up that particular property on that particular object.</span><br><span class="line"></span><br><span class="line">And next time you want to look up property with that name on an object of that type, you can have direct access You know exactly where to go in an object of that type.</span><br><span class="line"></span><br><span class="line">And it&#39;s much much much faster.</span><br><span class="line"></span><br><span class="line">So thst&#39;s really what the notion of having hidden class is getting us, is now we can make property access really fast through inline caching.</span><br><span class="line"></span><br><span class="line">So this is a classic example of bad idea. </span><br><span class="line"></span><br><span class="line">function Vec2(x,y)&#123;</span><br><span class="line">	this.x &#x3D; x;</span><br><span class="line">	this.y &#x3D; y;</span><br><span class="line">&#125;</span><br><span class="line">var v0 &#x3D; new  Vec2(5,8);</span><br><span class="line">v0.z &#x3D; 34;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">So I have another constructor. It&#39;s creating a vector object. </span><br><span class="line"></span><br><span class="line">But then, after I go through the trouble of doing that, I decide that I now wanted property z on this object.</span><br><span class="line"></span><br><span class="line">The problem with that is that if you add a property z to that object at some future point, if you just dynamically do that, you&#39;re going to change the hidden class of the object, which means that all this nice caching you&#39;re done and building up a notion of where the properties are, that&#39;s just blown away because now you have a new hidden class. </span><br><span class="line"></span><br><span class="line">You have to pay to build the new hidden class, and now you have to deal with a new hidden class.</span><br><span class="line"></span><br><span class="line">So one of the best things you can do to make you code efficient is to create a few well-defined types.</span><br><span class="line"></span><br><span class="line">Don&#39;t do alot of dynamic property adding and removing outside of constructors.</span><br><span class="line"></span><br><span class="line">Pretty much set things up once, have them look alike so that they can share the same hidden class, and don&#39;t mess with the properties they have.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------</span><br><span class="line">Object properties storage</span><br><span class="line">-------------------------------</span><br><span class="line"></span><br><span class="line">So now we know an object has properties.</span><br><span class="line"></span><br><span class="line">those properties can be in different storage states.</span><br><span class="line"></span><br><span class="line">So the first state ,the default, is that they can be stored directly in an array on the object.</span><br><span class="line"></span><br><span class="line">that great, that&#39;s fast. that&#39;s where you want to be. </span><br><span class="line"></span><br><span class="line">A second state they can be in is being stored in array off the objects. still great. No problem.</span><br><span class="line"></span><br><span class="line">The third case, which is the one you really have to look out for, is when they&#39;re stored in a hash table.</span><br><span class="line"></span><br><span class="line">So mush like just the array case in general where arrays can have different types of backing storage, properties can have different types of backing storage too.</span><br><span class="line"></span><br><span class="line">So properties can either be in normal mode where they&#39;re stored as an array or a dictionary mode where they&#39;re stored as a hash table. </span><br><span class="line"></span><br><span class="line">And if you have an object in dictionary mode, it&#39;s going to be mush slower to interact with.</span><br><span class="line"></span><br><span class="line">So you don&#39;t want that.</span><br><span class="line"></span><br><span class="line">So what triggers dictionary mode ,and how do you avoid it? Well, one thing that triggers itis toomany properties.</span><br><span class="line"></span><br><span class="line">So if you have so many properties that they won&#39;t fit into the internal storage for properties, then you have to have a hash table elsewhere. And that number of too many properties is somewhere around 30. It&#39;s quite generous, but you mighe hit it in some cases.</span><br><span class="line"></span><br><span class="line">The other things you can do to confuse your object and kick it into dictionary mode are to change the properties on the object.</span><br><span class="line"></span><br><span class="line">You can change the attribute, you can delete properties, that kind of thing. Those things are all going to kick you straight to dictionary mode.</span><br><span class="line"></span><br><span class="line">Again, and now you&#39;re going to make your object mush slower to interact with.</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>jsåŸç†</category>
      </categories>
      <tags>
        <tag>jsåŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>jså¯¹è±¡ä½ ä¸çŸ¥é“çš„é‚£äº›ç‰¹ç‚¹</title>
    <url>/2021/08/09/js%E5%AF%B9%E8%B1%A1%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%89%B9%E7%82%B9/</url>
    <content><![CDATA[<h4 id="jså¯¹è±¡çš„â€œå¿«-æ…¢â€å±æ€§"><a href="#jså¯¹è±¡çš„â€œå¿«-æ…¢â€å±æ€§" class="headerlink" title="jså¯¹è±¡çš„â€œå¿«/æ…¢â€å±æ€§"></a>jså¯¹è±¡çš„â€œå¿«/æ…¢â€å±æ€§</h4><p>å®šä¹‰ä¸€ä¸ªobjï¼Œå®ƒæ˜¯ä¸‹é¢è¿™æ ·çš„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="number">5</span>: <span class="string">'1'</span>,</span><br><span class="line">  <span class="number">6</span>: <span class="string">'2'</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="string">'6'</span>,</span><br><span class="line">  <span class="string">'qwf'</span>: <span class="string">'ä¹”æ–‡é£'</span>,</span><br><span class="line">  <span class="string">'yy'</span>: <span class="string">'qwf'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>initåˆå§‹åŒ–æ—¶ï¼Œå±æ€§ä¼šå°½é‡å½’ä¸ºâ€œå¿«â€å±æ€§ï¼ŒåŒæ—¶ä¹Ÿä¼šå­˜åœ¨â€œæ…¢â€å±æ€§ã€‚<br>é‚£ä¹ˆå®ƒåœ¨jsä¸­ï¼Œä¸ºäº†æœ‰æ•ˆçš„æå‡å­˜å‚¨å’Œè®¿é—®å±æ€§çš„æ€§èƒ½ï¼Œjså¯¹æ…¢å±æ€§çš„å­˜å‚¨æ˜¯ä¸‹å›¾è¿™æ ·çš„ã€‚<br><img src="http://i.feidom.com/%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7.png" alt="å¯¹è±¡å±æ€§"></p>
<ul>
<li>å¿«å±æ€§ï¼šç›´æ¥åŠ åœ¨å¯¹è±¡å†…å±æ€§ä¸Šï¼Œæ–¹ä¾¿è¯»å–ã€‚</li>
<li>æ…¢å±æ€§ï¼šåŠ è½½æ’åºæˆ–å¸¸è§„å±æ€§ä¸Šï¼Œæ–¹ä¾¿æ“ä½œã€‚ï¼ˆåœ¨å¯¹è±¡è®¾ç½®å±æ€§æ—¶ï¼Œä¼šåŠ åˆ°æ…¢å±æ€§ï¼‰</li>
</ul>
<p>Qï¼šä¸ºå•¥æ…¢ï¼Ÿ<br>Aï¼šå¤šäº†ä¸€å±‚æ·±åº¦ï¼Œå½±å“æ•°æ®æ“ä½œï¼Œå¤šäº†Elementå±‚å’ŒPropertieså±‚ã€‚</p>
<p>Qï¼šä¸ºå•¥ä¸ç›´æ¥éƒ½å­˜åœ¨å†…å±æ€§ä¸Šï¼Ÿ<br>Aï¼šåœ¨å†…å±æ€§ä¸­ï¼Œobjè¶Šæ¥è¶Šå¤§ï¼Œå½±å“å­˜å‚¨ã€‚ï¼ˆä»¥å‰å†…å±æ€§åªèƒ½åŠ¨æ€è®¾ç½®10ä¸ªï¼Œç°åœ¨ä¸æ­¢-ç¡¬ä»¶åŠ å¼ºç­‰åŸå› ï¼‰</p>
<h4 id="jsæ•°ç»„çš„â€œå¿«-æ…¢â€æ•°ç»„"><a href="#jsæ•°ç»„çš„â€œå¿«-æ…¢â€æ•°ç»„" class="headerlink" title="jsæ•°ç»„çš„â€œå¿«/æ…¢â€æ•°ç»„"></a>jsæ•°ç»„çš„â€œå¿«/æ…¢â€æ•°ç»„</h4><ul>
<li>å¿«æ•°ç»„ï¼šçº¿æ€§ç»“æ„ï¼Œè¿ç»­å†…å­˜ï¼ˆåŠ¨æ€æ‰©å®¹ï¼‰ï¼Œå½“å®šä¹‰åˆå§‹åŒ–é•¿åº¦å°äº1024æ—¶ï¼Œå±äºå¿«æ•°ç»„</li>
<li>æ…¢æ•°ç»„ï¼šå®šä¹‰é•¿åº¦å¤§äº1024æ—¶ï¼Œéœ€è¦ç»´æŠ¤é¢å¤–çš„å“ˆå¸Œç±³è¡¨ã€‚</li>
</ul>
<p>ç”±å¿«åˆ°æ…¢ï¼š</p>
<ol>
<li>å®šä¹‰é•¿åº¦å¤§äº1024æ—¶ã€‚åŠ¨æ€æ‰©å®¹æ—¶ï¼Œlength*1.5+16ä»¥ä¸Šã€‚</li>
<li>å¿«æ•°ç»„çš„æ–°å®¹é‡æ—¶æ‰©å®¹å®¹é‡çš„3å€ä»¥ä¸Šæ—¶ã€‚</li>
</ol>
<p>ç”±æ…¢åˆ°å¿«ï¼š</p>
<ol>
<li>æ•°é‡åœ¨1024å†…</li>
<li>å®¹é‡ä¸€ä¸‹ç¼©å‡50%ã€‚<br>å‡å®¹æ—¶ï¼Œæ–°æ•°ç»„é•¿åº¦æ˜¯åŸæ¥é•¿åº¦çš„1/2ï¼Œå°±è®¡ç®—éœ€è¦é‡Šæ”¾çš„ç©ºé—´ï¼Œåšå¥½æ ‡è®°ï¼Œç­‰å¾…GCå›æ”¶ã€‚<br>å¦‚æœ1/2 &lt; length &lt; 1,ç”¨holeså¯¹è±¡å¡«å……ï¼Œholeså¤ªå¤šä¹Ÿæ˜¯æ…¢æ•°ç»„ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>jsåŸç†</category>
      </categories>
      <tags>
        <tag>jsåŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>jsä¸Šä¸‹æ–‡æ‰§è¡Œæœºåˆ¶</title>
    <url>/2021/08/09/js%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<h4 id="æ‰§è¡Œä¸Šä¸‹æ–‡"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡"></a>æ‰§è¡Œä¸Šä¸‹æ–‡</h4><ul>
<li>ECS(Execute Context Stack): jså‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä»é€»è¾‘ä¸Šå½¢æˆä¸€ä¸ªæ ˆã€‚æ ˆåº•æ€»æ˜¯å…¨å±€ä¸Šä¸‹æ–‡ï¼Œæ ˆé¡¶æ˜¯å½“å‰ï¼ˆæ´»åŠ¨çš„ï¼‰æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚</li>
<li>GC(Global Context): å…¨å±€ä¸Šä¸‹æ–‡ã€‚</li>
<li>GO(Global Context): å…¨å±€ä¸Šä¸‹æ–‡ç”Ÿæˆçš„å¯¹è±¡ã€‚</li>
<li>VO(Var Object): å£°æ˜æ—¶å¯¹è±¡ã€‚</li>
<li>AO(Action Object): æ‰§è¡Œæ—¶å¯¹è±¡ã€‚</li>
</ul>
<p><img src="http://i.feidom.com/%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6.png" alt="çœ‹ä¸‹è¿™å¼ å›¾"></p>
<p>åœ¨AOæ‰§è¡Œæ—¶ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>å˜é‡å®šä¹‰ï¼šAOçš„å‡†å¤‡é˜¶æ®µï¼Œes6ä¹‹å‰çš„<strong>å˜é‡æå‡</strong>å°±åœ¨è¿™ä¸ªé˜¶æ®µ</li>
<li>å˜é‡èµ‹å€¼ã€‚</li>
</ul>
<h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…¨å±€ä¸Šä¸‹æ–‡</span></span><br><span class="line">GC:&#123;</span><br><span class="line">  lexicalEnvironment: &#123; <span class="comment">// è¯æ³•ç¯å¢ƒ</span></span><br><span class="line">    EnvironmentRecord: &#123; <span class="comment">// ç¯å¢ƒè®°å½•</span></span><br><span class="line">      Type: <span class="string">"Object"</span>,</span><br><span class="line">      &#123;...&#125;, <span class="comment">// æ ‡è¯†ç¬¦ä»€ä¹ˆçš„å…¶ä»–ä¿¡æ¯</span></span><br><span class="line">      outer: <span class="literal">null</span>, <span class="comment">// å…¨å±€ä¸Šä¸‹æ–‡æ²¡æœ‰å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  variablesEnvironment:&#123; <span class="comment">// å˜é‡ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ Function Exection Context</span></span><br><span class="line">EC:&#123;</span><br><span class="line">  lexicalEnvironment: &#123; <span class="comment">// è¯æ³•ç¯å¢ƒ</span></span><br><span class="line">    EnvironmentRecord: &#123; <span class="comment">// ç¯å¢ƒè®°å½•</span></span><br><span class="line">      Type: <span class="string">"Declarative"</span>, <span class="comment">//å‡½æ•°ç¯å¢ƒ</span></span><br><span class="line">      &#123;...&#125;, <span class="comment">// æ ‡è¯†ç¬¦ä»€ä¹ˆçš„å…¶ä»–ä¿¡æ¯</span></span><br><span class="line">      outer: <span class="string">'&lt;Global outer&gt;, &lt;function enviroment reference&gt;,'</span>, <span class="comment">// å¯¹å…¨å±€ç¯å¢ƒæˆ–å¤–éƒ¨å‡½æ•°ç¯å¢ƒçš„å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  variablesEnvironment:&#123; <span class="comment">// å˜é‡ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†é€‚é…æ—©èµ·çš„ES5çš„varç­‰ï¼Œå¢åŠ äº†å˜é‡ç¯å¢ƒã€‚å˜é‡ç¯å¢ƒä¹Ÿæ˜¯ä¸€ä¸ªè¯æ³•ç¯å¢ƒï¼Œå…¶ç¯å¢ƒè®°å½•å…¶åŒ…å«äº†ç”±å˜é‡å£°æ˜è¯­å¥ã€‚<br>åœ¨ES6ä¸­ï¼Œè¯æ³•ç¯å¢ƒè®°å½•å™¨å’Œå˜é‡ç¯å¢ƒè®°å½•å™¨çš„åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li>è¯æ³•ç¯å¢ƒï¼šç”¨äºå­˜å‚¨å‡½æ•°å£°æ˜å’Œå˜é‡ï¼ˆletï¼Œconstï¼‰çš„ç»‘å®šã€‚</li>
<li>å˜é‡ç¯å¢ƒï¼šä»…ç”¨äºå­˜å‚¨å˜é‡ï¼ˆvarï¼‰çš„ç»‘å®š</li>
</ul>
<h4 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h4><ul>
<li>scope chainï¼šä½œç”¨åŸŸé“¾<br>å…¶å®å°±æ˜¯åœ¨ [AO,GC,VO] æ—¶ã€‚</li>
<li><em>é—­åŒ…åŸç†*</em> åœ¨ä½œç”¨åŸŸscopeå †ç©ºé—´ä¸­å­˜å‚¨closore(fn)ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>jsåŸç†</category>
      </categories>
      <tags>
        <tag>jsåŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>OTåœ¨çº¿åä½œ</title>
    <url>/2021/08/05/ot%E5%8D%8F%E4%BD%9C/</url>
    <content><![CDATA[<h4 id="OTåä½œæ€æƒ³"><a href="#OTåä½œæ€æƒ³" class="headerlink" title="OTåä½œæ€æƒ³"></a>OTåä½œæ€æƒ³</h4><p><strong>è§£å†³å†²çª</strong></p>
<p>A, Bä¸¤ä¸ªç”¨æˆ·åœ¨åä½œåŒä¸€æ®µåˆå§‹æ–‡æœ¬ï¼šâ€™aaabâ€™ã€‚<br>å†²çªæ“ä½œï¼š<br>  Aåœ¨ç¬¬3ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>c</code>(â€˜aaacbâ€™)ã€‚<br>  Båœ¨ç¬¬3ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>d</code>(â€˜aaadbâ€™)ã€‚</p>
<p>è‹¥Aå…ˆæäº¤ï¼Œotåæ­£ç¡®ç»“æœï¼šâ€™aaacdbâ€™ã€‚<br>ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯æŒ‰é¡ºåºçš„â€™aaadcbâ€™ã€‚å› ä¸ºä¸æ˜¯é¡ºåºæ‰§è¡Œï¼Œäº§ç”Ÿå†²çªæ—¶ï¼Œä¸ºä¿è¯åŒæ–¹æ“ä½œæœ€å¤§ç¨‹åº¦å¾—åˆ°ä¿å­˜ï¼Œotåä½œåï¼ŒBçš„æ“ä½œå®é™…å˜ä¸ºåœ¨ç¬¬4ä¸ªå­éƒ½åæ’å…¥ã€‚<br>Aè§†è§’ï¼šAçš„ç»“æœâ€™aaacbâ€™è¢«Bæ‹¿å»æ“ä½œï¼Œç»“æœâ€™aaadcbâ€™ã€‚<br>Bè§†è§’ï¼šBçš„ç»“æœâ€™aaadbâ€™è¢«Aæ‹¿å»æ“ä½œï¼Œç»“æœâ€™aaacdbâ€™ã€‚å¯è§è¿™ä¸ªç»“æœæ˜¯æ­£ç¡®ç»“æœã€‚</p>
<p>åå°èªæ˜çš„otè½¬å‘åŠŸèƒ½å°±æ˜¯æŠŠæ¯ä¸ªäººæäº¤çš„è¡Œä¸ºè½¬å˜ä¸€ä¸‹å†å‘Šè¯‰åˆ«äººï¼Œä¸¤æ–¹çš„ç»“æœå°±ä¸€è‡´äº†ã€‚å…¶å®è¿™ä¸ªæŠ€æœ¯å°±æ˜¯ OT ç®—æ³•ï¼š<br>Aæ¥æ”¶åˆ°çš„Bæ“ä½œï¼šâ€™åœ¨ç¬¬3ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>d</code>â€˜  ==ot==&gt; â€˜aaacbåœ¨ç¬¬4ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>d</code>â€˜(aaacdb)<br>Bæ¥æ”¶åˆ°çš„Aæ“ä½œï¼šâ€™åœ¨ç¬¬3ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>c</code>â€˜  ==ot==&gt; â€˜aaadbåœ¨ç¬¬3ä¸ªå­—ç¬¦åé¢æ’å…¥äº†ä¸€ä¸ª<code>c</code>â€˜(aaacdb)</p>
<p>OT ç®—æ³•å…¨åå« Operation Transformationï¼Œä½ çœ‹ä»åå­—å°±å¯¹åº”äº†ä¸Šé¢æˆ‘è¯´çš„è½¬å˜ç®—æ³•ã€‚<br>å‡è®¾æˆ‘ä»¬çš„ OT ç®—æ³•çš„è½¬æ¢åŠŸèƒ½å« transformï¼Œé‚£ transformï¼ˆAï¼ŒBï¼‰= Aâ€™,Bâ€™ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ä½ è¾“å…¥ä¸¤ä¸ªå…ˆåæ‰§è¡Œçš„è¡Œä¸ºï¼Œå®ƒä¼šå‘Šè¯‰ä½ ä¸¤ä¸ªè½¬æ¢è¿‡åçš„è¡Œä¸ºï¼Œç„¶åæŠŠ Aâ€™è¡Œä¸ºå‘Šè¯‰ Bï¼ŒæŠŠ Bâ€™è¡Œä¸ºå‘Šè¯‰ Aï¼Œè¿™æ ·å¤§å®¶å†åº”ç”¨å°±ç›¸å®‰æ— äº‹äº†ã€‚</p>
<p>æ ¸å¿ƒå…¬å¼ï¼šapply(apply(S,A),B) = apply(apply(S,B),A)<br>S:å¼€å§‹çŠ¶æ€<br>Aï¼šAçš„æ“ä½œA<br>Bï¼šBçš„æ“ä½œB<br>å†²çªæ—¶ï¼ŒAæ‰§è¡Œå®Œè‡ªå·±çš„æ“ä½œåï¼Œå†æ‰§è¡Œç»OTè½¬æ¢çš„Bæ“ä½œã€‚ä¸Bæ‰§è¡Œå®Œè‡ªå·±çš„æ“ä½œï¼Œå†æ‰§è¡Œç»OTè½¬æ¢çš„Aæ“ä½œï¼ŒåŒæ–¹çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚<br>å›¾ç¤ºï¼š<br><img src="http://www.alloyteam.com/wp-content/uploads/2019/07/0973dffd-399c-48e9-8fcf-77ff3a6809e6-272x300.png" alt="ot"></p>
<p><a class="link"   href="http://operational-transformation.github.io/"  target="_blank" rel="noopener">ä¸€ä¸ªæ¼”ç¤ºOTçš„å°ç½‘ç«™<i class="fas fa-external-link-alt"></i></a></p>
<blockquote>
<p>å‚è€ƒ:<a class="link"   href="http://www.alloyteam.com/2019/07/13659/"  target="_blank" rel="noopener">æ­å¼€åœ¨çº¿åä½œçš„ç¥ç§˜é¢çº±-OTç®—æ³•<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>OT</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»propsçš„childrenä¸­è·å–ref</title>
    <url>/2021/07/12/%E4%BB%8Eprops%E7%9A%84children%E4%B8%AD%E8%8E%B7%E5%8F%96ref/</url>
    <content><![CDATA[<h4 id="ä»props-childrenä¸­å¤„ç†ref"><a href="#ä»props-childrenä¸­å¤„ç†ref" class="headerlink" title="ä»props.childrenä¸­å¤„ç†ref"></a>ä»<code>props.children</code>ä¸­å¤„ç†ref</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Child<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetRef</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.ref);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> childElement = React.Children.only(<span class="keyword">this</span>.props.children);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> React.cloneElement(</span><br><span class="line">      childElement, </span><br><span class="line">      &#123; <span class="attr">ref</span>: <span class="function"><span class="params">el</span> =&gt;</span> <span class="keyword">this</span>.ref = el &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">GetRef</span>&gt;</span><span class="tag">&lt;<span class="name">Child</span>/&gt;</span><span class="tag">&lt;/<span class="name">GetRef</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç»“åˆè½¬å‘refå°†refç»‘å®šåˆ°childrenç»„ä»¶ä¸­çš„divä¸­"><a href="#ç»“åˆè½¬å‘refå°†refç»‘å®šåˆ°childrenç»„ä»¶ä¸­çš„divä¸­" class="headerlink" title="ç»“åˆè½¬å‘refå°†refç»‘å®šåˆ°childrenç»„ä»¶ä¸­çš„divä¸­"></a>ç»“åˆè½¬å‘refå°†refç»‘å®šåˆ°childrenç»„ä»¶ä¸­çš„divä¸­</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Comç»„ä»¶</span></span><br><span class="line">interface Props &#123;</span><br><span class="line">  forwardedRef: ref | <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Com</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">Props</span>, <span class="title">State</span>&gt; </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;forwardedRef&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;div ref=&#123;forwardedRef&#125;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="xml">  &#125; </span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">const forwardRefCom =  React.forwardRef((props, ref) =&gt; (</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Com</span> <span class="attr">forwardedRef</span>=<span class="string">&#123;ref&#125;</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="xml">  ));</span></span><br><span class="line"><span class="xml">return forwardRefCom;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>reactçš„è½¬å‘ref</title>
    <url>/2021/07/12/react%E7%9A%84%E8%BD%AC%E5%8F%91ref/</url>
    <content><![CDATA[<h4 id="ç®€å•ç†è§£"><a href="#ç®€å•ç†è§£" class="headerlink" title="ç®€å•ç†è§£"></a>ç®€å•ç†è§£</h4><p>ä½¿ç”¨é€šç”¨çš„é«˜é˜¶ç»„ä»¶æ—¶ï¼Œå¤–å±‚ç»„ä»¶refæ§åˆ¶é«˜é˜¶ç»„ä»¶ä¸­åŒ…è£¹çš„å­ç»„ä»¶ä¸­çš„å…ƒç´ ï¼Œæ­¤æ—¶å¤–å±‚ç»„ä»¶ä¼ å…¥çš„refå¹¶ä¸ä½œç”¨äºé«˜é˜¶ä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œé«˜é˜¶ç»„ä»¶å°±è¦ç”¨åˆ°<code>React.forwardRef</code>è¿›è¡Œrefè½¬å‘ã€‚</p>
<h4 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h4><p><a class="link"   href="https://zh-hans.reactjs.org/docs/react-api.html#reactforwardref"  target="_blank" rel="noopener">React.forwardRef<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="ç®€å•ä¸¾æ —ğŸŒ°"><a href="#ç®€å•ä¸¾æ —ğŸŒ°" class="headerlink" title="ç®€å•ä¸¾æ —ğŸŒ°"></a>ç®€å•ä¸¾æ —ğŸŒ°</h4><p>ğŸŒ°æ —å­ æ¥è‡ª<a class="link"   href="https://www.jianshu.com/p/ea89610dbbfd"  target="_blank" rel="noopener">JamesSawyerâ€”-React ä¸­çš„è½¬å‘ref<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">  <span class="comment">// é«˜é˜¶ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logProps</span>(<span class="params">Component</span>) </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">LogProps</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    componentDidUpdate(prevProps) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'å…ˆå‰çš„å±æ€§ï¼š'</span>, prevProps);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'å½“å‰å±æ€§ï¼š'</span>, <span class="keyword">this</span>.props);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="comment">// ä½¿ç”¨forwardedRefä½œä¸ºä¸€ä¸ªrefå±æ€§ä¼ å…¥ç»„ä»¶ä¸­</span></span><br><span class="line">      <span class="keyword">const</span> &#123; forwardedRef, ...rest &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;Component ref=&#123;forwardedRef&#125; &#123;...rest&#125; /&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä½¿ç”¨React.forwardRefå¯¹LogPropsç»„ä»¶è¿›è¡Œè½¬å‘</span></span><br><span class="line">  <span class="keyword">return</span> React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">    &#123;<span class="string">' ä¸Šé¢å®šä¹‰çš„LogPropsç»„ä»¶æ¥å—ä¸€ä¸ªforwardedå±æ€§ '</span>&#125;</span><br><span class="line">    &lt;LogProps forwardedRef=&#123;ref&#125; &#123;...props&#125; /&gt;</span><br><span class="line">  ));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// FancyButton.js å­ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logProps <span class="keyword">from</span> <span class="string">'./logProps'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥å—propså’Œrefä½œä¸ºå‚æ•°</span></span><br><span class="line"><span class="comment">// è¿”å›ä¸€ä¸ªReact ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">    &lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"fancybutton"</span> ref=&#123;ref&#125;&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ ä½¿ç”¨é«˜é˜¶ç»„ä»¶å¯¹å…¶è¿›è¡Œå°è£…</span></span><br><span class="line"><span class="regexp">export default logProps(FancyButton);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ çˆ¶ç»„ä»¶</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ app.js</span></span><br><span class="line"><span class="regexp">class App extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">    super(props);</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ åˆ›å»ºä¸€ä¸ªref åå­—éšæ„</span></span><br><span class="line"><span class="regexp">    this.ref = React.createRef();</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  componentDidMount() &#123;</span></span><br><span class="line"><span class="regexp">    console.log('ref', this.ref);</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ this.ref.current è¡¨ç¤ºè·å–refæŒ‡å‘çš„DOMå…ƒç´ </span></span><br><span class="line"><span class="regexp">    this.ref.current.classList.add('primary'); /</span><span class="regexp">/ ç»™FancyButtonä¸­çš„buttonæ·»åŠ ä¸€ä¸ªclass</span></span><br><span class="line"><span class="regexp">    this.ref.current.focus(); /</span><span class="regexp">/ focusåˆ°buttonå…ƒç´ ä¸Š</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  </span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ ç›´æ¥ä½¿ç”¨ref=&#123;this.fancyButtonRef&#125;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">        &lt;FancyButton ref=&#123;this.fancyButtonRef&#125;&gt;å­ç»„ä»¶&lt;/</span>FancyButton&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>React-é˜²æ­¢å†…å­˜æ³„æ¼å¤„ç†</title>
    <url>/2021/06/18/React-%E9%98%B2%E6%AD%A2%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E5%A4%84%E7%90%86/</url>
    <content><![CDATA[<p>ç”¨Reactå†™äº†ä¸€æ®µä»£ç ï¼Œæµè§ˆå™¨çš„æ§åˆ¶å°<font color=red size=5>Error </font>å¦‚ä¸‹ï¼š<br><font color=red>Warning: Canâ€™t perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in a useEffect cleanup function.</font></p>
<p>å•¥æ„æ€å‘¢ï¼šä¸èƒ½åœ¨æœªæŒ‚è½½çš„ç»„ä»¶ä¸Šæ‰§è¡ŒReactçŠ¶æ€æ›´æ–°ã€‚è¿™æ˜¯ä¸€ä¸ªæ— ç”¨åŠŸï¼Œä½†å®ƒè¡¨æ˜ä½ çš„åº”ç”¨ç¨‹åºä¸­å­˜åœ¨å†…å­˜æ³„æ¼ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨useEffectæ¸…ç†å‡½æ•°ä¸­å–æ¶ˆæ‰€æœ‰çš„è®¢é˜…å’Œå¼‚æ­¥ä»»åŠ¡ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è¿™æ®µé—®é¢˜ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Component = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; itemId &#125; = props;</span><br><span class="line">  <span class="keyword">const</span> [ isRemoveing, setIsRemoveing ] = useState(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> handlerRemove = <span class="keyword">async</span>() =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span>(isRemoveing) <span class="keyword">return</span>;</span><br><span class="line">    setIsRemoveing(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">await</span> removeItem(itemId); <span class="comment">// åˆ é™¤å½“å‰è¿™ä¸ªç»„ä»¶çš„æ•°æ®ï¼Œè¿™ä¸ªç»„ä»¶å¸è½½</span></span><br><span class="line">    setIsRemoveing(<span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div class_name=&#123; !isRemoveing ? <span class="string">'class1'</span> : <span class="string">'class2'</span> &#125; onClick=&#123;handlerRemove&#125; &gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åŸå› æ˜¯å•¥å‘¢</strong>ï¼šawaitç­‰å¾…ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚çš„è¿”å›å†<code>setIsRemoveing</code>ã€‚å‡å¦‚è¿™ä¸ªç»„ä»¶unmountedä¹‹åï¼Œè¯·æ±‚è¿˜æ²¡å›æ¥ï¼Œä½ è¿˜åœ¨è¿™setStateï¼Œä¸å°±ç‚¸äº†ã€‚</p>
<p>å¥½å§ï¼Œé‚£è§£å†³æ–¹å¼æ˜¯ä¸æ˜¯åœ¨<code>useEffect</code>ä¸­å®šä¹‰ä¸€ä¸ªå¸è½½æ—¶çš„å˜é‡<code>unmounted</code>ï¼Œç„¶ååœ¨setIsRemoveingæ—¶åˆ¤æ–­å¸è½½çŠ¶æ€ï¼Ÿ</p>
<p>å—¯ï¼ŒåŸºæœ¬æ˜¯è¿™ä¸ªæ€è·¯ã€‚é‚£è¿™ä¸ª<code>unmounted</code>è¯¥æ€ä¹ˆå®šä¹‰ï¼Œæ˜¯ç›´æ¥<code>const unmounted = false;</code>, è¿˜æ˜¯<code>const [ unmounted, setUnmounted ] = useState(false);</code>ï¼Ÿ<br>ä»¥ä¸‹æ˜¯Stack Overflowé‡Œä¸€ä¸ªå¸–å­çš„å›å¤ï¼š</p>
<ul>
<li>æ–¹å¼ä¸€ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> unmounted = <span class="literal">false</span>;</span><br><span class="line">  setPageLoading(<span class="literal">true</span>);</span><br><span class="line">  props</span><br><span class="line">    .dispatch(fetchCourses())</span><br><span class="line">    .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!unmounted) &#123;</span><br><span class="line">        setPageLoading(<span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function">(<span class="params">error: string</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!unmounted) &#123;</span><br><span class="line">        toast.error(error);</span><br><span class="line">        setPageLoading(<span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123; unmounted = <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure></li>
<li>æ–¹å¼äºŒï¼šuseRef<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Example = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> unmounted = useRef(<span class="literal">false</span>);</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123; unmounted.current = <span class="literal">true</span> &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> setFilter = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    props.dispatch(fetchCourses()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!unmounted.current) &#123;</span><br><span class="line">        setLoading(<span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ReactTable onFetchData=&#123;setFilter&#125; <span class="comment">/* other props omitted */</span> /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>æ–¹å¼äºŒä¸­å¦‚æœä¸ç”¨refï¼Œç”¨stateæˆ–è€…ç›´æ¥å®šä¹‰å˜é‡çš„è¯ï¼Œéƒ½å®ç°ä¸äº†ã€‚<br>å¥½å§ï¼Œæ˜¯æˆ‘ä¸ç†Ÿæ‚‰çš„<a class="link"   href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useref"  target="_blank" rel="noopener">useRef<i class="fas fa-external-link-alt"></i></a>,è¿™ä¸ªé“¾æ¥æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥å…ˆçœ‹ä¸‹ã€‚<br>ç„¶åä¸ºäº†ç ”ç©¶å®ƒï¼Œæˆ‘æ‰¾åˆ°ä¸€ç¯‡æ¥è‡ª<a class="link"   href="https://leewarrick.com/"  target="_blank" rel="noopener">Lee Warrick<i class="fas fa-external-link-alt"></i></a>çš„<a class="link"   href="https://leewarrick.com/blog/react-use-effect-explained/"  target="_blank" rel="noopener">Reactâ€™s useEffect and useRef Explained for Mortals<i class="fas fa-external-link-alt"></i></a>ã€‚<a href="/2021/06/18/useEffect-useRef/">è¿™é‡Œ</a>æ˜¯æˆ‘å¯¹è¿™ç¯‡æ–‡ç« çš„ç¿»è¯‘ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a class="link"   href="https://daviseford.com/blog/2019/07/11/react-hooks-check-if-mounted.html"  target="_blank" rel="noopener">React Hooks - Check If A Component Is Mounted<i class="fas fa-external-link-alt"></i></a><br><a class="link"   href="https://stackoverflow.com/questions/58038008/how-to-stop-memory-leak-in-useeffect-hook-react/58038029"  target="_blank" rel="noopener">how-to-stop-memory-leak-in-useeffect-hook-react<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>useEffect &amp; useRef</title>
    <url>/2021/06/18/useEffect-useRef/</url>
    <content><![CDATA[<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>æœ¬æ–‡æ˜¯ä¸€ç‰‡ç¿»è¯‘ï¼ŒåŸæ–‡æ¥è‡ª<a class="link"   href="https://leewarrick.com/"  target="_blank" rel="noopener">Lee Warrick<i class="fas fa-external-link-alt"></i></a>çš„<a class="link"   href="https://leewarrick.com/blog/react-use-effect-explained/"  target="_blank" rel="noopener">Reactâ€™s useEffect and useRef Explained for Mortals<i class="fas fa-external-link-alt"></i></a>ã€‚<br>ä¸ºå•¥ç¿»è¯‘å¹¶è®°å½•è¿™ç¯‡æ–‡ç« å‘¢ï¼Œå› ä¸ºçœ‹äº†ä»¥åè§‰å¾—é€šä¿—æ˜“æ‡‚çš„ä¸ºå‡¡äººè§£é‡Šäº†<code>useEffect</code>å’Œ<code>useRef</code>ã€‚<br>åœ¨æ­¤è®°å½•ï¼Œæ–¹ä¾¿ä»¥åå›å¤´å¤ä¹ ã€‚</p>
<h4 id="é€šä¿—çš„è§£é‡ŠReactçš„-useEffect-å’Œ-useRef"><a href="#é€šä¿—çš„è§£é‡ŠReactçš„-useEffect-å’Œ-useRef" class="headerlink" title="é€šä¿—çš„è§£é‡ŠReactçš„ useEffect å’Œ useRef"></a>é€šä¿—çš„è§£é‡ŠReactçš„ useEffect å’Œ useRef</h4><p><img src="https://leewarrick.com/blog/static/fdb92914fc9093dee6a2c20dad8fbd50/c35de/acropolis.jpg" alt="åŸæ–‡ä¸­è¿‡çš„å›¾"><br>&emsp;&emsp;å¦‚æœReactæ–‡æ¡£è®©ä½ ä¸€ç­¹è«å±•ï¼Œæˆ–è€…Dan Abramovçš„åšå®¢è®©ä½ è§‰å¾—ä½ åœ¨é˜…è¯»ä»å¥¥æ—åŒ¹æ–¯å±±æµä¼ ä¸‹æ¥çš„å¤å¸Œè…Šæ–‡å·è½´ï¼Œä½ å¹¶ä¸å­¤å•,ä¸æ˜¯åªæœ‰ä½ è¿™æ ·è®¤ä¸ºã€‚<br>&emsp;&emsp;æœ‰æ—¶ï¼ŒReactç¥æ®¿çš„ä¼—ç¥ä»¬å¾ˆéš¾å°†ä»–ä»¬çš„æ™ºæ…§è½¬åŒ–ä¸ºæˆ‘ä»¬å…¶ä»–äººå¯ä»¥ç†è§£çš„è¯­è¨€ã€‚äº‹æƒ…é€šå¸¸æ˜¯è¿™æ ·çš„ã€‚ä½ åœ¨ä½¿ç”¨Reactæ—¶é‡åˆ°å›°éš¾ï¼Œç”¨è°·æ­Œæœç´¢ä½ çš„é—®é¢˜ï¼Œç„¶åè¯»åˆ°ä¸€ä¸ªåšå®¢æˆ–Stack Overflowçš„å¸–å­ï¼Œå…¶ä¸­çš„ä¸€äº›å»ºè®®è®©ä½ æ„Ÿåˆ°æ¯”å¼€å§‹æ—¶æ›´è¿·èŒ«ã€‚<br>&emsp;&emsp;æˆ‘å½“ç„¶ä¹Ÿæ›¾å¤šæ¬¡æˆä¸ºè¿™ç§æƒ…å†µçš„å—å®³è€…ã€‚ç‰¹åˆ«æ˜¯useEffectã€‚åœ¨æˆ‘ä»¬æ·±å…¥ç ”ç©¶è¿™ä¸ªç‰¹æ®Šçš„é’©å­ä¹‹å‰ï¼Œè®©æˆ‘è¯´æˆ‘å–œæ¬¢ç”¨hooksæ¥å†™Reactï¼Œè€Œä¸”ä¸æƒ³å†å›åˆ°ç±»ä¸­å»ã€‚è¿™å°±æ˜¯è¯´ï¼ŒuseEffectæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ç—›ç‚¹ã€‚</p>
<h6 id="åˆ°åº•ä»€ä¹ˆæ˜¯â€œeffectå‰¯ä½œç”¨â€"><a href="#åˆ°åº•ä»€ä¹ˆæ˜¯â€œeffectå‰¯ä½œç”¨â€" class="headerlink" title="åˆ°åº•ä»€ä¹ˆæ˜¯â€œeffectå‰¯ä½œç”¨â€"></a>åˆ°åº•ä»€ä¹ˆæ˜¯â€œeffectå‰¯ä½œç”¨â€</h6><p>&emsp;&emsp;ä¸ºäº†è®©ä½ çœŸæ­£ç†è§£useEffectï¼Œè®©æˆ‘ä»¬é€€åä¸€ç‚¹ï¼Œè°ˆè°ˆç¼–ç¨‹å’ŒJavaScriptã€‚<br>&emsp;&emsp;useEffectçš„åå­—å°±æ˜¯æˆ‘ä»¬äº²åˆ‡åœ°ç§°ä¸º â€œå‰¯ä½œç”¨ â€œçš„æ•ˆæœã€‚<br>&emsp;&emsp;é‚£ä¹ˆä»€ä¹ˆæ˜¯å‰¯ä½œç”¨å‘¢ï¼Ÿå®ƒæ˜¯ä¸€æ®µä»£ç ï¼Œå®ƒä¼¸å‡ºæ‰‹æ¥â€¦â€¦åšåˆ«çš„äº‹æƒ…ã€‚è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç”¨ä¾‹å­æ¥è¯´æ˜ã€‚<br>&emsp;&emsp;è¿™é‡Œæœ‰ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å‡½æ•°addé™¤äº†æ¥å—ä¸€ä¸ªè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªè¾“å‡ºå¤–ï¼Œä»€ä¹ˆä¹Ÿæ²¡åšã€‚å®ƒå¹¶æ²¡æœ‰ä¼¸æ‰‹åˆ°è‡ªèº«ä»¥å¤–çš„åœ°æ–¹å»æ£ä¹±!<br>&emsp;&emsp;æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸ªå‰¯ä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> resultDiv = <span class="built_in">document</span>.getElementById(<span class="string">'add-example'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = a + b</span><br><span class="line">  resultDiv.textContent = <span class="string">`The Result is <span class="subst">$&#123;result&#125;</span>`</span></span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;add-example&quot;&gt;&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç°åœ¨ï¼Œæˆ‘ä»¬çš„å‡½æ•°ä¼¸åˆ°äº†è‡ªèº«ä¹‹å¤–æ¥æ›´æ–°DOMï¼ˆDocument Object Modelçš„ç¼©å†™ï¼‰ï¼Œå¹¶æ˜¾ç¤ºäº†ç»“æœã€‚è¿™ä¸ªé¢å¤–çš„è¡Œä¸ºæ˜¯ä¸€ä¸ªå‰¯ä½œç”¨ã€‚</p>
<h6 id="Reactä¸­çš„å‰¯ä½œç”¨"><a href="#Reactä¸­çš„å‰¯ä½œç”¨" class="headerlink" title="Reactä¸­çš„å‰¯ä½œç”¨"></a>Reactä¸­çš„å‰¯ä½œç”¨</h6><p>&emsp;&emsp;é‚£ä¹ˆReactå‘¢ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªå‡ ä¹åªæ›´æ–°DOMçš„åº“ã€‚ä¸€ä¸ªè§†å›¾åº“ï¼Œå¦‚æœä½ æ„¿æ„çš„è¯ã€‚é‚£ä¹ˆåœ¨Reactä¸­ï¼Œä½ ä¼šæŠŠä»€ä¹ˆå«åšå‰¯ä½œç”¨å‘¢ï¼Ÿ<br>&emsp;&emsp;ä»»ä½•åœ¨æ›´æ–°é¡µé¢ä¹‹å¤–çš„ä¸œè¥¿ã€‚å¦‚æœä½ ä¸ä½¿ç”¨Reactæ¥æ›´æ–°çŠ¶æ€æˆ–æ¸²æŸ“HTMLï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå‰¯ä½œç”¨ã€‚å®ƒæ˜¯ä»»ä½•éReactçš„ä¸œè¥¿ã€‚<br>&emsp;&emsp;è¿™æ„å‘³ç€ä»»ä½•æ—¶å€™ä½ è°ƒç”¨APIï¼Œä½¿ç”¨setInterval/setTimeoutï¼Œæ·»åŠ é”®ç›˜ç›‘å¬å™¨ï¼Œæˆ–è€…çœŸçš„ä»»ä½•æ—¶å€™ä½ æä¹±çª—å£å¯¹è±¡ï¼Œä½ éƒ½åœ¨å¼•å…¥å‰¯ä½œç”¨ã€‚<br>&emsp;&emsp;hookså¾ˆç¥å¥‡ï¼Œè®©ä½ å†™å‡ºçœŸæ­£å¯è¯»ã€å¯é‡ç”¨çš„ä»£ç â€¦â€¦é™¤äº†å½“ä½ å¤„ç†å‰¯ä½œç”¨çš„æ—¶å€™ã€‚è¿™å¾ˆä¸å¹¸ï¼Œå› ä¸ºå½“ä½ ä»”ç»†æƒ³æƒ³ï¼Œä½œä¸ºç½‘ç»œå¼€å‘è€…ï¼Œæˆ‘ä»¬æ‰€åšçš„å¤§å¤šæ•°æœ‰è¶£çš„äº‹æƒ…éƒ½æ˜¯å›´ç»•ç€å‰¯ä½œç”¨å±•å¼€çš„ã€‚<br>&emsp;&emsp;è®©æˆ‘ä»¬ä»é’©å­ä¸Šé€€ä¸€æ­¥ï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•åœ¨åŸºäºç±»çš„ç»„ä»¶ä¸­å¤„ç†å‰¯ä½œç”¨ã€‚</p>
<h6 id="ç±»ç»„ä»¶å’Œå‰¯ä½œç”¨"><a href="#ç±»ç»„ä»¶å’Œå‰¯ä½œç”¨" class="headerlink" title="ç±»ç»„ä»¶å’Œå‰¯ä½œç”¨"></a>ç±»ç»„ä»¶å’Œå‰¯ä½œç”¨</h6><p>&emsp;&emsp;åœ¨åŸºäºç±»çš„ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥æ‰§è¡Œä¾§é¢æ•ˆæœã€‚ä¾‹å¦‚ï¼Œåœ¨componentDidMountä¸Šï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨APIæ¥è·å–æ¸²æŸ“çš„æ•°æ®ã€‚<br>&emsp;&emsp;â€ä¸ºä»€ä¹ˆä¸åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨APIï¼Ÿâ€ä½ å¯èƒ½ä¼šé—®ã€‚å¥½å§ï¼Œå› ä¸ºReactè¯´æˆ‘ä»¬ç”¨äºæ¸²æŸ“çš„ä¸œè¥¿éƒ½åœ¨ â€œçŠ¶æ€ â€œä¸­ï¼Œåœ¨æˆ‘ä»¬çš„ç»„ä»¶è¢«åŠ è½½åˆ°é¡µé¢ä¸Šä¹‹å‰ï¼Œæˆ‘ä»¬ä¸èƒ½ä¹±ç”¨çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬è¯•å›¾åœ¨ç»„ä»¶åŠ è½½ä¹‹å‰æ›´æ–°çŠ¶æ€ï¼Œå°±ä¼šå‡ºç°é”™è¯¯ã€‚<br>&emsp;&emsp;ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„åŸºäºç±»çš„ç»„ä»¶çš„æƒ…å†µ,è¿™æ˜¯ä¸€ä¸ªå°ç²¾çµçš„ä¾‹å­ï¼ˆåé¢ä¼šç”¨hooksæ”¹å†™ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pokemon</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.state = <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    fetch(<span class="string">'https://pokeapi.co/api/v2/pokemon/gengar/'</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(res)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> pokemon = <span class="keyword">this</span>.state</span><br><span class="line">    <span class="keyword">const</span> style = &#123;<span class="attr">textTransform</span>: <span class="string">'capitalize'</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">      &#123; pokemon</span><br><span class="line">        ? <span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line">          &lt;img src=&#123;pokemon.sprites.front_default&#125;</span><br><span class="line"><span class="xml">            alt=&#123;'Image of ' + pokemon.name&#125;/&gt;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span>Name: &#123;pokemon.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">          &lt;p style=&#123;style&#125;&gt;</span><br><span class="line">            Type: &#123;pokemon.types.map(x =&gt; x.type.name).join(', ')&#125;</span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">        : <span class="string">'Loading...'</span></span><br><span class="line">      &#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;è¿™æ ·åšå¾ˆå¥½ï¼Œé™¤äº†ä¸è¿™æ ·åšçš„æ—¶å€™ã€‚å½“æˆ‘ä»¬æƒ³å†æ¬¡ç‚¹å‡»APIæ¥æŠ“å–ä¸åŒçš„å°ç²¾çµæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœè¿™ä¸ªç»„ä»¶è¢«è¿æ¥åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­çš„æŸä¸ªè·¯ç”±ä¸Šï¼Œè€Œè¿™ä¸ªè·¯ç”±å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†è¿™ä¸ªç»„ä»¶å¹¶æ²¡æœ‰å¸è½½/é‡è£…ã€‚å¦‚æœç”¨æˆ·è¿›å…¥äº†ä¸åŒçš„é¡µé¢ï¼Œè€Œç»„ä»¶åœ¨APIè°ƒç”¨ç»“æŸå‰å°±å¸è½½äº†æ€ä¹ˆåŠï¼Ÿ<br>&emsp;&emsp;ç­”æ¡ˆæ˜¯å¢åŠ æ›´å¤šçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¦‚<code>componentDidUpdate</code>å’Œ<code>componentWillUnmount</code>ï¼Œä»¥æ‰§è¡Œæ›´å¤šçš„APIè°ƒç”¨ï¼Œé˜²æ­¢å¥‡æ€ªçš„å¸è½½é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬æ·»åŠ äº†è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥å¤„ç†æˆ‘ä»¬æ‰€æœ‰çš„è¾¹ç¼˜æƒ…å†µã€‚å½“æˆ‘ä»¬å®Œæˆåï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„å¤§éƒ¨åˆ†ç»„ä»¶éƒ½æ˜¯ç”±ç”Ÿå‘½å‘¨æœŸä»£ç ç»„æˆçš„ã€‚</p>
<h5 id="ç„¶åæ¥è¯•ä¸€ä¸‹Hooks"><a href="#ç„¶åæ¥è¯•ä¸€ä¸‹Hooks" class="headerlink" title="ç„¶åæ¥è¯•ä¸€ä¸‹Hooks"></a>ç„¶åæ¥è¯•ä¸€ä¸‹Hooks</h5><p>&emsp;&emsp;Reactå›¢é˜Ÿæ„è¯†åˆ°ï¼Œç±»çš„APIæœ‰ç‚¹ç¬¨é‡ï¼Œéš¾ä»¥æ¨ç†ã€‚äººä»¬æ­£åœ¨åˆ¶ä½œç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼Œè¯•å›¾äº†è§£Reactçš„å†…éƒ¨è¿ä½œâ€¦â€¦è¿™æ˜¯ä¸€ä¸ªæ··ä¹±ã€‚<br>&emsp;&emsp;å› æ­¤ï¼Œåœ¨2018å¹´10æœˆçš„ReactConfä¸Šï¼Œåœ¨Sophie Alpertæ¦‚è¿°äº†ç±»çš„ä½¿ç”¨æœ‰å¤šä¹ˆç³Ÿç³•ä¹‹åï¼ŒDan Abramovä¸Šå°ä»‹ç»äº†é’©å­ï¼ˆä½ å¯ä»¥åœ¨è¿™é‡Œè§‚çœ‹è§†é¢‘ï¼‰ã€‚<br>&emsp;&emsp;é’©å­åœ¨åŠŸèƒ½ç»„ä»¶ä¸­å¼•å…¥äº†çŠ¶æ€æ€§ï¼Œä»¥åŠå¤„ç†å‰¯ä½œç”¨çš„æ–°æ–¹æ³•ã€‚é’©å­ä½¿Reactçš„ä»£ç æ›´å®¹æ˜“é‡å¤ä½¿ç”¨ï¼Œè€Œä¸”ä»£ç é‡æ›´å°‘â€“è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„èƒœåˆ©ï¼ä½†æ˜¯æœ‰ä¸€ä¸ªå°é—®é¢˜ã€‚<br>&emsp;&emsp;é™¤äº†ä¸€ä¸ªå°é—®é¢˜ã€‚<strong>æ¯æ¬¡æ¸²æŸ“ï¼Œæ•´ä¸ªç»„ä»¶/åŠŸèƒ½éƒ½è¦é‡æ–°è¿è¡Œ</strong>ã€‚<br>&emsp;&emsp;è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåŸºäºHookså¼€å‘çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RerenderExample</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [bool, setBool] = React.useState(<span class="literal">false</span>)</span><br><span class="line">  <span class="keyword">const</span> randomNum = <span class="built_in">Math</span>.random()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;This number will be different each time you click the button:&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;p&gt;&#123;randomNum&#125;&lt;/</span>p&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setBool(!bool)&#125;&gt;Trigger a render&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æˆ‘ä»¬åœ¨æ¸²æŸ“çš„JSXä¸­ç”šè‡³æ²¡æœ‰ä½¿ç”¨boolï¼Œä½†æ¯æ¬¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ•´ä¸ªå‡½æ•°éƒ½ä¼šè¿è¡Œã€‚æ¯æ¬¡æ¸²æŸ“ï¼Œç»„ä»¶å†…çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šé‡æ–°è¿è¡Œï¼šå‡½æ•°å®šä¹‰ã€å˜é‡åˆ›å»º/åˆ†é…ç­‰ç­‰ã€‚<br>&emsp;&emsp;å¦‚æœä½ åœ¨æƒ³ â€œå¦‚æœæˆ‘å¿…é¡»åœ¨ç»„ä»¶ä¸­åšä¸€äº›è®¡ç®—é‡å¤§çš„äº‹æƒ…æ€ä¹ˆåŠï¼Ÿè¿™ä¸å¯èƒ½æ˜¯é«˜æ€§èƒ½çš„â€¦â€¦â€ï¼Œè¿™æ˜¯ä¸ªæ•é”çš„è§‚å¯Ÿã€‚åœ¨ä¸€ä¸ªåŠŸèƒ½æ€§ç»„ä»¶ä¸­è¿›è¡Œæ˜‚è´µçš„æ“ä½œæ˜¯ä¸å¯èƒ½æœ‰æ€§èƒ½çš„ã€‚äº‹å®ä¸Šï¼ŒuseCallbackå’ŒuseMemoçš„å­˜åœ¨æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè®¾ç½®çš„é¿éš¾æ‰€ã€‚Kent C Doddsåœ¨è¿™é‡Œå¯¹è¿™äº›é—®é¢˜æœ‰ä¸€ä¸ªæŒ‘æˆ˜æ€§çš„è§£è¯»ï¼Œä½†æ€»ç»“èµ·æ¥ï¼Œæ ¹æ®Kentçš„è¯´æ³•ï¼Œåœ¨ä½ çœ‹åˆ°æ€§èƒ½å½±å“ä¹‹å‰ï¼Œä½ ä¸åº”è¯¥æ‹…å¿ƒé‡è¯»çš„é—®é¢˜ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœä½ å¯¹é’©å­ä¸ç†Ÿæ‚‰ï¼Œè¯·æŠŠè¿™ç¯‡æ–‡ç« æ”¶è—èµ·æ¥ï¼Œç­‰ä½ å‡†å¤‡å¥½äº†å†æ¥çœ‹çœ‹ã€‚é™¤éä½ å¿…é¡»è¦æ‹…å¿ƒè®°å¿†åŒ–çš„é—®é¢˜<br>&emsp;&emsp;åƒuseStateè¿™æ ·çš„é’©å­é‡‡ç”¨äº†ä¸€äº›å†…åœ¨çš„é­”æ³•æ¥é¿å…é‡ç°çš„é—®é¢˜ã€‚è¿™å¾ˆå¥½ï¼Œè€Œä¸”ä½¿ç”¨useStateä¼¼ä¹å¾ˆç®€å•ï¼Œä½†æ˜¯<strong>å½“ä½ éœ€è¦åšè®¾ç½®çŠ¶æ€ä»¥å¤–çš„äº‹æƒ…æ—¶ï¼Œæ€ä¹ˆåŠï¼Ÿ</strong><br>&emsp;&emsp;ä½¿ç”¨useEffectã€‚é‚£äº›è®¨åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ²¡æœ‰äº†ï¼Œä¸‡å²ï¼ç„¶è€Œï¼Œè¿™ä¸ªé’©å­ä¹Ÿæœ‰å®ƒè‡ªå·±çš„å¥‡æ€ªä¹‹å¤„ã€‚é¦–å…ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹è¯­æ³•ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//accepts two arguments: a function, and dependency array</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// do stuff</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125; <span class="comment">//function to undo our stuff from above when component unmounts</span></span><br><span class="line">&#125;, []) <span class="comment">//dependency array of things to watch for changes on</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ‰€ä»¥ä½ ç»™useEffectä¼ é€’ä¸€ä¸ªè¦è¿è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå…¶ä¸­åŒ…å«ä½ çš„å‰¯ä½œç”¨ï¼Œç„¶åæ˜¯ä¸€ä¸ªè¦è§‚å¯Ÿçš„äº‹ç‰©çš„æ•°ç»„ã€‚å¦‚æœè¢«ç›‘è§†çš„äº‹ç‰©å‘ç”Ÿå˜åŒ–ï¼ŒuseEffectå°†é‡æ–°è¿è¡Œæˆ‘ä»¬çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœä½ éœ€è¦åœ¨å¸è½½æ—¶æ¸…ç†ä½ çš„å‰¯ä½œç”¨ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«è¯¥ä»£ç çš„å‡½æ•°ã€‚<br>&emsp;&emsp;è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„å°ç²¾çµçš„ä¾‹å­ï¼Œç”¨é’©å­å’ŒuseEffectã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pokemon</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [pokemon, setPokemon] = React.useState(<span class="literal">null</span>)</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    fetch(<span class="string">'https://pokeapi.co/api/v2/pokemon/gengar/'</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      setPokemon(res)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, []) <span class="comment">// empty array means nothing to watch, so run once and no more</span></span><br><span class="line">  <span class="keyword">const</span> style = &#123;<span class="attr">textTransform</span>: <span class="string">'capitalize'</span>&#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &#123; pokemon</span><br><span class="line">      ? <span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line">        &lt;img src=&#123;pokemon.sprites.front_default&#125;</span><br><span class="line"><span class="xml">            alt=&#123;'Image of ' + pokemon.name&#125;/&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span>Name: &#123;pokemon.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">        &lt;p style=&#123;style&#125;&gt;</span><br><span class="line">          Type: &#123;pokemon.types.map(x =&gt; x.type.name).join(', ')&#125;</span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">      : <span class="string">'Loading...'</span></span><br><span class="line">    &#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¦‚æœä½ ç›¯ç€é‚£ä¸ªç©ºçš„ä¾èµ–æ€§æ•°ç»„ï¼Œä½ å·²ç»æ³¨æ„åˆ°äº†ç¬¬ä¸€ä¸ªuseEffectçš„æ€ªç™–ã€‚é€šè¿‡ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼Œæˆ‘ä»¬åœ¨è¯´ â€œåªåšè¿™ä¸€æ¬¡â€ã€‚Reactä¸‡ç¥æ®¿å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨æå°‘æ•°æƒ…å†µä¸‹è¿™æ˜¯å¯ä»¥çš„ï¼Œä½†å¤§å¤šæ•°æ—¶å€™ä½ éƒ½å¸Œæœ›é‡Œé¢æœ‰ä¸œè¥¿ã€‚åŸå› æ˜¯ï¼Œé€šå¸¸ä½ æƒ³ä¸ä½ çš„ä»£ç ä¸­çš„ä¸œè¥¿åŒæ­¥ï¼Œè€Œä¸æ˜¯åªæ‰§è¡Œä¸€æ¬¡æ•ˆæœã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„å°ç²¾çµç»„ä»¶ä¾èµ–äºä¸€ä¸ªè·¯ç”±å‚æ•°æˆ–é“å…·ï¼Œä»»ä½•å¯ä»¥è¯´ â€œå»è·å¾—ä¸€ä¸ªæ–°çš„å°ç²¾çµ â€œè€Œä¸éœ€è¦æŒ‚è½½/å¸è½½çš„ä¸œè¥¿å‘¢ï¼Ÿ<br>&emsp;&emsp;æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬çš„ç»„ä»¶ä¾èµ–äºä¸€ä¸ªé“å…·pokemonToGetï¼Œå®ƒæ˜¯ä¸€ä¸ªå‚æ•°ï¼Œå‘Šè¯‰å®ƒè¦ä»APIä¸­è·å¾—å“ªäº›å°ç²¾çµã€‚è®©æˆ‘ä»¬ä¹Ÿä¸ºæµ‹è¯•ç›®çš„æ·»åŠ ä¸€ä¸ªå°å°çš„è¡¨å•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pokemon</span>(<span class="params">&#123;pokemonToGet&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [pokemon, setPokemon] = React.useState(<span class="literal">null</span>)</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    fetch(<span class="string">`https://pokeapi.co/api/v2/pokemon/<span class="subst">$&#123;pokemonToGet&#125;</span>/`</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      setPokemon(res)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [pokemonToGet]) <span class="comment">// get a new pokemon with the pokemonToGet prop changes</span></span><br><span class="line">  <span class="keyword">const</span> style = &#123;<span class="attr">textTransform</span>: <span class="string">'capitalize'</span>&#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">    &#123; pokemon</span><br><span class="line">      ? <span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line">        &lt;img src=&#123;pokemon.sprites.front_default&#125;</span><br><span class="line"><span class="xml">          alt=&#123;'Image of ' + pokemon.name&#125;/&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span>Name: &#123;pokemon.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">        &lt;p style=&#123;style&#125;&gt;</span><br><span class="line">          Type: &#123;pokemon.types.map(x =&gt; x.type.name).join(', ')&#125;</span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">      : <span class="string">'Loading...'</span></span><br><span class="line">    &#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">function PokemonForm() &#123;</span></span><br><span class="line"><span class="regexp">  const [inputValue, setInputValue] = React.useState("rowlet")</span></span><br><span class="line"><span class="regexp">  const [pokemonToGet, setPokemonToGet] = React.useState("gengar")</span></span><br><span class="line"><span class="regexp">  function getPokemon() &#123;</span></span><br><span class="line"><span class="regexp">    setPokemonToGet(inputValue.trim().toLowerCase())</span></span><br><span class="line"><span class="regexp">    setInputValue("")</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;input onChange=&#123;(e) =&gt; setInputValue(e.target.value)&#125;</span></span><br><span class="line"><span class="regexp">        value=&#123;inputValue&#125; type="text"/</span>&gt;</span><br><span class="line">      &lt;button onClick=&#123;getPokemon&#125;&gt;</span><br><span class="line">        Get Pokemon</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Pokemon pokemonToGet=&#123;pokemonToGet&#125; /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">render(&lt;PokemonForm /</span>&gt;)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬çš„ç»„ä»¶æ ¹æ®æˆ‘ä»¬çš„é“å…·å˜åŒ–è·å–äº†ä¸€ä¸ªæ–°çš„å°ç²¾çµã€‚å¦‚æœä½¿ç”¨ç±»ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä½¿ç”¨<code>componentDidUpdate</code>ä¹‹ç±»çš„ä¸œè¥¿æ¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœã€‚<br>&emsp;&emsp;Ryan Florenceåœ¨æ¨ç‰¹ä¸Šå¯¹useEffectçš„ç”¨æ³•åšäº†å¾ˆå¥½çš„æ€»ç»“ã€‚</p>
<blockquote>
<p>The question is not â€œwhen does this effect runâ€ the question is â€œwith which state does this effect synchronize withâ€<br>  useEffect(fn) // all state<br>  useEffect(fn, []) // no state<br>  useEffect(fn, [these, states])</p>
</blockquote>
<p>&emsp;&emsp;ä»–æåˆ°çš„ â€œæ‰€æœ‰çŠ¶æ€ â€œçš„æƒ…å†µï¼Œå³ä½ æ²¡æœ‰ä¼ å…¥ä»»ä½•ä¾èµ–å…³ç³»çš„æƒ…å†µæ˜¯ä¸€ä¸ªå¥‡æ€ªçš„æƒ…å†µã€‚æˆ‘ä¸ªäººä»æœªå‘ç°å®ƒçš„ç”¨é€”ã€‚æˆ‘ä»¬çŸ¥é“æ•´ä¸ªç»„ä»¶åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè¿è¡Œï¼Œæ‰€ä»¥æˆ‘æƒ³çŸ¥é“æ˜¯å¦æœ‰ä¸€äº›å¥‡æ€ªçš„è¾¹ç¼˜æƒ…å†µéœ€è¦ä½ ä½¿ç”¨<code>useEffect(fn)</code>è€Œä¸ä½¿ç”¨ä»»ä½•ä¾èµ–é˜µåˆ—ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°æ—¶å€™ä½ éƒ½ä¼šç”¨è¿™ä¸ªæ–¹æ³•ï¼š<code>useEffect(fn, [these, states])</code>ã€‚</p>
<h5 id="UseEffectå’ŒPrevious-State-äº‹æƒ…è´¥éœ²çš„åœ°æ–¹ã€‚"><a href="#UseEffectå’ŒPrevious-State-äº‹æƒ…è´¥éœ²çš„åœ°æ–¹ã€‚" class="headerlink" title="UseEffectå’ŒPrevious State: äº‹æƒ…è´¥éœ²çš„åœ°æ–¹ã€‚"></a>UseEffectå’ŒPrevious State: äº‹æƒ…è´¥éœ²çš„åœ°æ–¹ã€‚</h5><p>&emsp;&emsp;åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒuseEffectçš„å¿ƒç†æ¨¡å‹ä¼¼ä¹å¾ˆç®€å•ï¼šå°†å®ƒä¸ä½ é€‰æ‹©çš„æŸäº›çŠ¶æ€å˜åŒ–åŒæ­¥ã€‚é—®é¢˜æ˜¯ï¼Œå½“ä½ éœ€è¦åœ¨ä¸€ä¸ªæ•ˆæœä¸­å¼•ç”¨è¯¥çŠ¶æ€ï¼Œè€Œä¸ä»…ä»…æ˜¯çŸ¥é“å®ƒæ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚<br>&emsp;&emsp;åœ¨useEffectä¸­ï¼Œä½ æ— æ³•è·å¾—å¯¹å½“å‰çŠ¶æ€çš„è®¿é—®ã€‚<br>&emsp;&emsp;åœ¨æˆ‘ä»¬çš„APIè°ƒç”¨ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯è¦†ç›–äº†ä¹‹å‰çš„çŠ¶æ€ã€‚<br>&emsp;&emsp;è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>);</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(count + <span class="number">1</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¼¼ä¹æˆ‘ä»¬åšäº†æ‰€æœ‰æ­£ç¡®çš„äº‹æƒ…ï¼ˆç”šè‡³æ¸…ç†äº†å¸è½½æ—¶çš„å‰¯ä½œç”¨ï¼‰ï¼Œä½†æˆ‘ä»¬çš„è®¡æ•°å™¨æ²¡æœ‰é€’å¢ã€‚è¿™æ˜¯ä¸€ä¸ªé—®é¢˜å—ï¼Ÿæˆ‘ä»¬æ˜¯å¦æ— æ³•è®¿é—®setIntervalæ‰€å±çš„çª—å£å¯¹è±¡ï¼Ÿ<br>&emsp;&emsp;ä¸æ˜¯ï¼Œä¹Ÿä¸æ˜¯ã€‚å¦‚æœä½ æŠŠconsole.logæ·»åŠ åˆ°é‚£ä¸ªé—´éš”ä¸­ï¼Œä½ ä¼šçœ‹åˆ°å®ƒæ¯ç§’é’Ÿéƒ½åœ¨è·³åŠ¨ã€‚<br>&emsp;&emsp;æˆ‘å¯ä»¥è¯æ˜ç»™ä½ çœ‹:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> [randomNum, setRandomNum] = React.useState(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      setCount(count + <span class="number">1</span>)</span><br><span class="line">      setRandomNum(<span class="built_in">Math</span>.random())</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;p&gt;RandomNum is &#123;randomNum&#125;&lt;/</span>p&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ³¨æ„ï¼Œæˆ‘ä»¬æ¯ç§’é’Ÿéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„éšæœºæ•°ã€‚æˆ‘ä»¬çš„æ—¶é—´é—´éš”ä»£ç æ˜¯å¥½çš„ã€‚<br>&emsp;&emsp;æˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®æ–°çš„çŠ¶æ€ï¼Œä½†æ— æ³•è®¿é—®å½“å‰çŠ¶æ€ã€‚<br>&emsp;&emsp;è¿™å°±æ˜¯ä¸€ä¸ª â€œé™ˆæ—§çš„é—­åŒ…â€ã€‚æˆ‘ä¸ä¼šå»è®¨è®ºé—­åŒ…ï¼Œä½†åªéœ€çŸ¥é“ï¼Œç”±äºReact/hooksçš„å®ç°ï¼Œåœ¨æˆ‘ä»¬çš„é—´éš”å‡½æ•°ä¸­ï¼Œcountå˜é‡æ€»æ˜¯ä¼šæ˜¯0ã€‚è¿™æ˜¯ä¸€ä¸ªæ—§çš„å‚è€ƒã€‚<br>&emsp;&emsp;äº‹å®è¯æ˜ï¼Œåƒä¸Šé¢è¿™æ ·çš„ç®€å•ä¾‹å­æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ­£å¦‚John Tuckeræ‰€æŒ‡å‡ºçš„ï¼ˆè°¢è°¢Johnï¼ï¼‰ã€‚å’ŒåŸºäºç±»çš„ç»„ä»¶ä¸­çš„setStateä¸€æ ·ï¼ŒuseStateä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¥æ”¶ä¹‹å‰çš„çŠ¶æ€ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚Reactæ–‡æ¡£ä¹Ÿæ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹ã€‚<br>&emsp;&emsp;ä¸‹é¢æ˜¯ä¸€ä¸ªå¿«é€Ÿä¿®å¤çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>);</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//let's pass a function instead</span></span><br><span class="line">      <span class="comment">//the argument is the current state</span></span><br><span class="line">      setCount(<span class="function"><span class="params">count</span> =&gt;</span> count + <span class="number">1</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¸è¿‡ï¼Œè¿™ä»ç„¶ä¸èƒ½è§£å†³æˆ‘ä»¬æ‰€æœ‰çš„é—®é¢˜ã€‚å¦‚æœä½ éœ€è¦åœ¨useEffectä¸­è®¿é—®æœ€æ–°çš„çŠ¶æ€ï¼Œä½†ä¸æ›´æ–°å®ƒï¼Œä½ å°†ä¸å¾—ä¸å¼€å§‹ç”¨setStateå›è°ƒæ¥åŒ…è£…ä½ çš„useEffectä»£ç ï¼Œç„¶ååœ¨æœ€åè¿”å›æœªæ”¹å˜çš„çŠ¶æ€ã€‚è¿™å¾ˆå¿«å°±ä¼šå˜æˆä¸€ä¸ªç»å¯¹çš„æ··ä¹±ï¼Œç‰¹åˆ«æ˜¯å½“ä½ åœ¨å¤„ç†å¤šä¸ªçŠ¶æ€å€¼çš„æ—¶å€™ã€‚<br>&emsp;&emsp;å¦ä¸€ä¸ªå¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯åªä½¿ç”¨useReducerï¼Œå› ä¸ºå®ƒå¯ä»¥æ¥æ”¶ä¹‹å‰çš„çŠ¶æ€ï¼Œä½†æ˜¯ç”¨å‰¯ä½œç”¨å¡«å……ä½ çš„reducerä¹Ÿæ˜¾å¾—éå¸¸æ··ä¹±ï¼Œè€Œä¸”æˆ‘ä¸å»ºè®®ä»»ä½•äººå®Œå…¨åœæ­¢ä½¿ç”¨useStateã€‚<br>&emsp;&emsp;æ— è®ºå¦‚ä½•ï¼Œåœ¨å†™é’©å­çš„æ—¶å€™ï¼Œæˆ‘å·²ç»é™·å…¥äº†é™ˆæ—§çš„é—­åŒ…é™·é˜±å¾ˆå¤šå¾ˆå¤šæ¬¡ã€‚æˆ‘ç”šè‡³ä¸çŸ¥é“å®ƒæœ‰ä¸ªåå­—ï¼Œç›´åˆ°æˆ‘åœ¨SvelteèƒŒåçš„äººRich Harrisçš„æ¼”è®²ä¸­çœ‹åˆ°å®ƒ<br>&emsp;&emsp;æ˜¾ç„¶ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨é’©å­ä¸Šè¢«å®ƒä»¬ç»Šå€’çš„äººã€‚<br><img src="https://leewarrick.com/blog/static/5a5dbcc6667a5da9eeabc5cbe90a1427/ed46b/staleclosures.png" alt="Rich Harrisçš„"><br>&emsp;&emsp; <strong>Reactç”šè‡³åœ¨ä»–ä»¬çš„æ–‡æ¡£ä¸­æåˆ°äº†è¿™ä¸€ç‚¹ã€‚</strong></p>
<blockquote>
<p>â€œAny function inside a component, including event handlers and effects, â€œseesâ€ the props and state from the render it was created in.â€<br>  è¯‘ï¼šç»„ä»¶å†…çš„ä»»ä½•åŠŸèƒ½ï¼ŒåŒ…æ‹¬äº‹ä»¶å¤„ç†ç¨‹åºå’Œæ•ˆæœï¼Œéƒ½èƒ½ â€œçœ‹åˆ° â€œå®ƒæ‰€åˆ›å»ºçš„æ¸²æŸ“ä¸­çš„é“å…·å’ŒçŠ¶æ€ã€‚<br>&emsp;&emsp;æˆ‘ä¹‹å‰è¯»è¿‡è¿™ä¸ªï¼Œåœ¨çœŸæ­£æ·±å…¥äº†è§£è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘è§‰å¾—æ²¡ä»€ä¹ˆæ„ä¹‰ã€‚æˆ‘æƒ³è±¡è¿™å¯èƒ½æ˜¯Reactçš„ä¸€ä¸ªä¸å¥½çš„ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿè®¸ä»–ä»¬ä¸å¸Œæœ›å¤ªå¤§å£°åœ°å«å‡ºæ¥ã€‚<br>&emsp;&emsp;ç„¶è€Œï¼ŒDan Abramovåœ¨ä»–çš„åšå®¢ä¸­æ›´å¥½åœ°æè¿°äº†è¿™ä¸ªé—®é¢˜ï¼Œç”šè‡³æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚<br>â€œEffects always â€œseeâ€ props and state from the render they were defined in. That helps prevent bugs but in some cases can be annoying. For those cases, you can explicitly maintain some value in a mutable ref.â€<br>  è¯‘ï¼šæ•ˆæœæ€»æ˜¯ â€œçœ‹åˆ° â€œå®ƒä»¬æ‰€å®šä¹‰çš„æ¸²æŸ“ä¸­çš„é“å…·å’ŒçŠ¶æ€ã€‚è¿™æœ‰åŠ©äºé˜²æ­¢bugï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¾ˆçƒ¦äººã€‚å¯¹äºè¿™äº›æƒ…å†µï¼Œä½ å¯ä»¥æ˜ç¡®åœ°åœ¨ä¸€ä¸ªå¯å˜çš„ä¸Šä¸‹æ–‡ä¸­ä¿å­˜ä¸€äº›å€¼ã€‚</p>
</blockquote>
<p>&emsp;&emsp;è¿™å¾ˆæœ‰å¸®åŠ©ï¼Œå› ä¸ºå®ƒä»¥useRefçš„å½¢å¼æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆæ„Ÿè°¢Danï¼ï¼‰ï¼Œä½†å®ƒè®©æˆ‘å¯¹å¦‚ä½•å¸®åŠ©é¿å…è¿™ä¸ªé—®é¢˜ä¸€æ— æ‰€çŸ¥ï¼ˆä¸»è¦æ˜¯å› ä¸ºæˆ‘ä¸äº†è§£useRefï¼‰ã€‚</p>
<h5 id="ä»€ä¹ˆæ˜¯â€œrefâ€ï¼Œä½ ä¼šæ€ä¹ˆä½¿ç”¨å®ƒ"><a href="#ä»€ä¹ˆæ˜¯â€œrefâ€ï¼Œä½ ä¼šæ€ä¹ˆä½¿ç”¨å®ƒ" class="headerlink" title="ä»€ä¹ˆæ˜¯â€œrefâ€ï¼Œä½ ä¼šæ€ä¹ˆä½¿ç”¨å®ƒ"></a>ä»€ä¹ˆæ˜¯â€œrefâ€ï¼Œä½ ä¼šæ€ä¹ˆä½¿ç”¨å®ƒ</h5><p>&emsp;&emsp;ä¼ ç»Ÿä¸Šï¼Œå¼•ç”¨çš„ç›®çš„æ˜¯è®©ä½ ç›´æ¥è®¿é—®ä¸€ä¸ªhtmlå…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ éœ€è¦å…³æ³¨ä¸€ä¸ªè¾“å…¥å­—æ®µã€‚ä½ å¿…é¡»è·³å‡ºReactï¼Œä½¿ç”¨å¸¸è§„çš„JavaScriptæ¥è°ƒç”¨.focus()ã€‚é’©å­å®é™…ä¸Šè®©è¿™ä¸€åˆ‡å˜å¾—ç›¸å½“ç®€å•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">InputField</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = React.useRef()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input type=<span class="string">"text"</span> ref=&#123;inputRef&#125; /&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; inputRef.current.focus()&#125;&gt;</span><br><span class="line">        Click to Focus the input</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¾ˆå¥½! å½“æˆ‘ä»¬éœ€è¦çš„æ—¶å€™ï¼ŒRefsæ˜¯è®¿é—®æœ¬åœ°DOM APIsçš„ä¸€ä¸ªç®€å•çš„é€ƒç”Ÿé€šé“ã€‚<br>&emsp;&emsp;â€¦ä½†è¿™å¦‚ä½•å¸®åŠ©æˆ‘ä»¬è§£å†³æˆ‘ä»¬é™ˆæ—§çš„å…³é—­è®¡æ•°å™¨çš„ä¾‹å­å‘¢ï¼Ÿ</p>
<h5 id="ä½¿ç”¨â€œRefsâ€æ¥é¿å…é™ˆæ—§çš„é—­åŒ…"><a href="#ä½¿ç”¨â€œRefsâ€æ¥é¿å…é™ˆæ—§çš„é—­åŒ…" class="headerlink" title="ä½¿ç”¨â€œRefsâ€æ¥é¿å…é™ˆæ—§çš„é—­åŒ…"></a>ä½¿ç”¨â€œRefsâ€æ¥é¿å…é™ˆæ—§çš„é—­åŒ…</h5><p>&emsp;&emsp;Reactæ–‡æ¡£å°†â€œRefsâ€æ¯”ä½œ â€œå®ä¾‹å˜é‡â€ã€‚æˆ‘ä¸çŸ¥é“é‚£æ˜¯ä»€ä¹ˆæ„æ€ï¼ˆè°¢è°¢ç»´åŸºç™¾ç§‘ï¼‰ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—é‚£æ²¡ä»€ä¹ˆç”¨ã€‚<br>&emsp;&emsp;æˆ‘è®¾æ³•é€šè¿‡è¿™æ ·æ€è€ƒæ¥ç†è§£Refsçš„å«ä¹‰ã€‚<br>&emsp;&emsp;<strong>Refså­˜åœ¨äºé‡æ–°æ¸²æŸ“å‘¨æœŸä¹‹å¤–ã€‚</strong><br>&emsp;&emsp;<strong>æŠŠRefsçœ‹ä½œæ˜¯ä½ è®¾ç½®åœ¨ä¸€è¾¹çš„ä¸€ä¸ªå˜é‡ã€‚å½“ä½ çš„ç»„ä»¶é‡æ–°è¿è¡Œæ—¶ï¼Œå®ƒä¼šå¾ˆé«˜å…´åœ°è·³è¿‡è¿™ä¸ªåå°„ï¼Œç›´åˆ°ä½ ç”¨<code>.current</code>è°ƒç”¨å®ƒã€‚</strong><br>&emsp;&emsp;è®©æˆ‘ä»¬çœ‹çœ‹å¯¹æˆ‘ä»¬çš„å®šæ—¶å™¨ä¾‹å­çš„ä¿®æ­£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> countRef = React.useRef(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      countRef.current = countRef.current + <span class="number">1</span></span><br><span class="line">      setCount(countRef.current)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¦‚æœæˆ‘ä»¬æƒ³æŠŠè®¡æ—¶å™¨åœåœ¨æ¯”å¦‚è¯´10çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨refsæ¥åšã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> countRef = React.useRef(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (countRef.current === <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">return</span> clearInterval(intervalId)</span><br><span class="line">      countRef.current = countRef.current + <span class="number">1</span></span><br><span class="line">      setCount(countRef.current)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¸ºäº†ä¾¿äºæ¯”è¾ƒï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨setStateå›è°ƒæ–¹æ³•çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(<span class="function"><span class="params">count</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (count === <span class="number">10</span>) &#123;</span><br><span class="line">            clearInterval(intervalId)</span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">return</span> count + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¯ä»¥çœ‹åˆ°è¿™å¾ˆå¿«å°±ä¼šæ¥è¿‘å›è°ƒåœ°ç‹±ï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨åšæ›´å¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘ä¼šæé†’ä½ ä¸è¦ä½¿ç”¨å›è°ƒæ–¹æ³•ã€‚</p>
<h5 id="State-Versus-Refs"><a href="#State-Versus-Refs" class="headerlink" title="State Versus Refs"></a>State Versus Refs</h5><p>&emsp;&emsp;æ˜¯å¦æœ‰å¯èƒ½å®Œå…¨æŠ›å¼ƒçŠ¶æ€è€Œåªä½¿ç”¨refsï¼Ÿ<br>&emsp;&emsp;ä½ å¯èƒ½å€¾å‘äºè®¤ä¸ºä½ å¯ä»¥ç”¨ refs æ¥ä»£æ›¿ä½ çš„ç»„ä»¶çš„çŠ¶æ€ï¼Œä»è€Œé¿å¼€æ‰€æœ‰è¿™äº›å¥‡æ€ªçš„è¡Œä¸ºã€‚<br>&emsp;&emsp;ä½ ä¸èƒ½è¿™æ ·åšã€‚refsä¸æ˜¯ååº”æ€§çš„ã€‚å½“ä½ æ”¹å˜ä¸€ä¸ª ref æ—¶ï¼Œå®ƒä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“ã€‚è®°ä½ï¼Œ<strong>å®ƒä»¬å­˜åœ¨äºé‡æ–°æ¸²æŸ“å‘¨æœŸä¹‹å¤–</strong>ã€‚<br>&emsp;&emsp;ä»¥ä¸‹æ˜¯ä¸å¯èƒ½çš„:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> count = React.useRef(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      count.current = count.current + <span class="number">1</span></span><br><span class="line">      <span class="comment">//console.log('Ref example count: ' + count.current)</span></span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> clearInterval(intervalId)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;The count is: &#123;count.current&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‚£ä¸ªç»„ä»¶å®é™…ä¸Šæ˜¯åœ¨å†…éƒ¨è¿›è¡Œè®¡æ•°ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å¯¼è‡´HTMLçš„æ›´æ–°ã€‚ä½ éœ€è¦useStateæ¥å®ç°è¿™ä¸€ç‚¹ã€‚å¦‚æœä½ ä¸ç›¸ä¿¡æˆ‘çš„è¯ï¼Œè¯·ç»§ç»­å–æ¶ˆå¯¹console.logçš„æ³¨é‡Šï¼‰ã€‚<br>&emsp;&emsp;è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­æ¥è¯æ˜Refsä¸stateã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> countRef = React.useRef(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;State Count: &#123;count&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Increment State Count</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">      &lt;p&gt;Ref Count: &#123;countRef.current&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; countRef.current = countRef.current + 1&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Increment Ref Count</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">render(&lt;Counter/</span>&gt;)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;åœ¨ä½ é€šè¿‡è®¾ç½®çŠ¶æ€è§¦å‘é‡æ–°æ¸²æŸ“ä¹‹å‰ï¼Œä½ ä¸ä¼šçœ‹åˆ°Refè®¡æ•°çš„å˜åŒ–ã€‚</p>
<h5 id="ç¦»åˆ«æ„Ÿè¨€"><a href="#ç¦»åˆ«æ„Ÿè¨€" class="headerlink" title="ç¦»åˆ«æ„Ÿè¨€"></a>ç¦»åˆ«æ„Ÿè¨€</h5><p>&emsp;&emsp;æˆ‘å–œæ¬¢Reactä¸­çš„é’©å­å’ŒåŠŸèƒ½ç»„ä»¶ï¼Œä½†æˆ‘æ‰€æ¦‚è¿°çš„æ€ªå¼‚ç°è±¡è®©æˆ‘æš‚åœäº†ã€‚æˆ‘ä¸å–œæ¬¢è¢«è¦æ±‚å¯¹Reactçš„å†…éƒ¨å·¥ä½œäº†è§£è¿™ä¹ˆå¤šæ‰èƒ½ä½¿ç”¨å®ƒã€‚æˆ‘è®¤ä¸ºè¿™ç»™å­¦ä¹ Reactçš„äººå¸¦æ¥äº†éšœç¢ï¼Œæˆ‘å¸Œæœ›å°†æ¥Reactå›¢é˜Ÿèƒ½æƒ³å‡ºä¸€äº›æ›´å¥½çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›é—®é¢˜ã€‚</p>
<h4 id="ç¿»è¯‘ç»“æŸ"><a href="#ç¿»è¯‘ç»“æŸ" class="headerlink" title="ç¿»è¯‘ç»“æŸ"></a>ç¿»è¯‘ç»“æŸ</h4><p>å¾ˆæ£’çš„æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>Touchå’ŒMouseäº‹ä»¶</title>
    <url>/2021/06/07/touch%E5%92%8Cmouse%E4%BA%8B%E4%BB%B6/</url>
    <content><![CDATA[<h4 id="ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ"><a href="#ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ" class="headerlink" title="ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ"></a>ä¸€ä¸ªé—®é¢˜å¼•å‘çš„æ€è€ƒ</h4><p>ç§»åŠ¨ç«¯çš„ä¸€ä¸ªé¡µé¢ï¼ŒçŒœæµ‹å“ˆï¼Œhoveräº‹ä»¶&amp;mouseoveräº‹ä»¶éƒ½è¢«ç›‘å¬æ—¶ï¼Œmouseåº”è¯¥å¤±æ•ˆå§ã€‚å› ä¸ºç§»åŠ¨ç«¯åªæœ‰ç‚¹è§¦ï¼Œæ²¡æœ‰mouseã€‚<br>äº‹å®ï¼šå‡ºç°mouseoverï¼ˆå®šä¹‰äº†è¿™ä¸ªæ—¶å€™çš„æ ·å¼ï¼‰çŠ¶æ€ï¼Œå°±å¾ˆå¥‡æ€ªã€‚<br>ç„¶åï¼Œæœ¬ä»¥ä¸ºmouseå’Œtouchåœ¨æµè§ˆå™¨ä¸­æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>pcç«¯ï¼šmouseäº‹ä»¶ç”Ÿæ•ˆï¼Œtouchäº‹ä»¶<del>å¤±æ•ˆ</del></li>
<li>ç§»åŠ¨ç«¯ï¼šmouseäº‹ä»¶<del>å¤±æ•ˆ</del>ï¼Œtouchäº‹ä»¶ç”Ÿæ•ˆ</li>
<li><strong>ä½†æ˜¯</strong>ï¼Œç»“æœæ˜¯è¿™æ ·çš„ï¼š<br>åŒæ—¶ç›‘å¬äº†mouseå’Œtouchä¸¤ç§äº‹ä»¶ï¼Œåœ¨iosç§»åŠ¨è®¾å¤‡ä¸­çš„safariæµè§ˆå™¨ä¸­ï¼Œç‚¹å‡»è§¦å‘touchäº‹ä»¶ä¹‹åï¼Œå®šä¹‰çš„mouseoveräº‹ä»¶ä¹Ÿè§¦å‘äº†ï¼Œäº§ç”Ÿäº†bugã€‚</li>
</ul>
<h4 id="ç ”ç©¶å®ƒ"><a href="#ç ”ç©¶å®ƒ" class="headerlink" title="ç ”ç©¶å®ƒ"></a>ç ”ç©¶å®ƒ</h4><p>æ•²é»‘æ¿ï¼š</p>
<ul>
<li>pcç«¯ï¼šonTouchäº‹ä»¶ä¼šè¢«å±è”½ã€‚</li>
<li>ç§»åŠ¨ç«¯ï¼šä¸¤ç§äº‹ä»¶éƒ½ä¼šè¢«è§¦å‘ã€‚ä¸”é¡ºåºæ˜¯è¿™æ ·çš„ï¼š<ol>
<li>touchstart</li>
<li>touchmove</li>
<li>touchend</li>
<li>mouseover</li>
<li>mousemove</li>
<li>mousedown</li>
<li>mouseup</li>
<li>click</li>
</ol>
</li>
</ul>
<p>å¥½å§ï¼Œè¿™æ˜¯è¿™ä¸€åˆ‡å‡ºç°çš„åŸå› ã€‚<br>åœ¨é€‚é…å¤šç§è®¾å¤‡çš„é¡¹ç›®ä¸­ï¼Œæ€ä¹ˆåŒºåˆ†è¿™ä¸¤ç§äº‹ä»¶ï¼Œè®©mouseäº‹ä»¶åœ¨ç§»åŠ¨ç«¯å¤±æ•ˆå‘¢ã€‚</p>
<h4 id="æ–¹æ³•ï¼š"><a href="#æ–¹æ³•ï¼š" class="headerlink" title="æ–¹æ³•ï¼š"></a>æ–¹æ³•ï¼š</h4><ul>
<li>è®¾ç½®ä¸€ä¸ªflagï¼Œmouseäº‹ä»¶æ—¶åˆ¤æ–­touchFlagå†³å®šreturnæˆ–è€…æ‰§è¡Œã€‚</li>
<li>åˆ†å¼€å†™ï¼Œåˆ¤æ–­è®¾å¤‡åéœ€è¦mouseçš„å†™mouseï¼Œéœ€è¦touchçš„å†™touchã€‚</li>
<li>æœ€å¥½çš„æ–¹æ³•ï¼špreventDefault()<blockquote>
<p><strong>Use preventDefault() inside touch event handlers, so the default mouse-emulation handling doesnâ€™t occur.</strong></p>
</blockquote>
</li>
</ul>
<h4 id="preventDefault"><a href="#preventDefault" class="headerlink" title="preventDefault()"></a>preventDefault()</h4><p>ä¸“é—¨æŒ‘å‡ºæ¥è¯´ä¸€ä¸‹è¿™ä¸ªï¼špreventDefault()ã€è¯¥æ–¹æ³•å°†é€šçŸ¥ Web æµè§ˆå™¨ä¸è¦æ‰§è¡Œä¸äº‹ä»¶å…³è”çš„é»˜è®¤åŠ¨ä½œï¼ˆå¦‚æœå­˜åœ¨è¿™æ ·çš„åŠ¨ä½œï¼‰ã€‚ã€‘<br>äºæ˜¯ï¼Œåœ¨<code>touchstart</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>e.preventDefault()</code>å»é˜»æ­¢ä¹‹åçš„mouseoveräº‹ä»¶ã€‚<br><font color='red'>æŠ¥é”™äº†</font>ï¼šUnable to preventDefault inside passive event listener due to target being treated as passive.</p>
<blockquote>
<p>ç¿»è¯‘ï¼š ç”±äºç›®æ ‡è¢«è§†ä¸ºè¢«åŠ¨ï¼Œæ— æ³•åœ¨è¢«åŠ¨äº‹ä»¶ç›‘å¬å™¨å†…é˜²æ­¢ã€‚</p>
</blockquote>
<h5 id="passive-çš„äº‹ä»¶ç›‘å¬å™¨"><a href="#passive-çš„äº‹ä»¶ç›‘å¬å™¨" class="headerlink" title="passive çš„äº‹ä»¶ç›‘å¬å™¨"></a>passive çš„äº‹ä»¶ç›‘å¬å™¨</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">addEventListener(type, listener, &#123;</span><br><span class="line">    capture: <span class="literal">false</span>,</span><br><span class="line">    passive: <span class="literal">true</span>,</span><br><span class="line">    once: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä¸‰ä¸ªå±æ€§éƒ½æ˜¯å¸ƒå°”ç±»å‹çš„å¼€å…³ã€‚å…¶ä¸­ capture å±æ€§ç­‰ä»·äºä»¥å‰çš„ useCapture å‚æ•°ï¼›once å±æ€§å°±æ˜¯è¡¨æ˜è¯¥ç›‘å¬å™¨æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ‰§è¡Œä¸€æ¬¡åå°±è¢«è‡ªåŠ¨ removeEventListener æ‰ï¼Œè¿˜æ²¡æœ‰æµè§ˆå™¨å®ç°å®ƒï¼›passive å±æ€§åœ¨ Firefox å’Œ Chrome å·²ç»å®ç°ã€‚<br>å¾ˆå¤šç§»åŠ¨ç«¯çš„é¡µé¢éƒ½ä¼šç›‘å¬ touchstart ç­‰ touch äº‹ä»¶ï¼Œåƒè¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"touchstart"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    ... <span class="comment">// æµè§ˆå™¨ä¸çŸ¥é“è¿™é‡Œä¼šä¸ä¼šæœ‰ e.preventDefault()</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç”±äº touchstart äº‹ä»¶å¯¹è±¡çš„ cancelable å±æ€§ä¸º trueï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„é»˜è®¤è¡Œä¸ºå¯ä»¥è¢«ç›‘å¬å™¨é€šè¿‡ preventDefault() æ–¹æ³•é˜»æ­¢ï¼Œé‚£å®ƒçš„é»˜è®¤è¡Œä¸ºæ˜¯ä»€ä¹ˆå‘¢ï¼Œé€šå¸¸æ¥è¯´å°±æ˜¯æ»šåŠ¨å½“å‰é¡µé¢ï¼ˆè¿˜å¯èƒ½æ˜¯ç¼©æ”¾é¡µé¢ï¼‰ï¼Œå¦‚æœå®ƒçš„é»˜è®¤è¡Œä¸ºè¢«é˜»æ­¢äº†ï¼Œé¡µé¢å°±å¿…é¡»é™æ­¢ä¸åŠ¨ã€‚ä½†æµè§ˆå™¨æ— æ³•é¢„å…ˆçŸ¥é“ä¸€ä¸ªç›‘å¬å™¨ä¼šä¸ä¼šè°ƒç”¨ preventDefault()ï¼Œå®ƒèƒ½åšçš„åªæœ‰ç­‰ç›‘å¬å™¨æ‰§è¡Œå®Œåå†å»æ‰§è¡Œé»˜è®¤è¡Œä¸ºï¼Œè€Œç›‘å¬å™¨æ‰§è¡Œæ˜¯è¦è€—æ—¶çš„ï¼Œæœ‰äº›ç”šè‡³è€—æ—¶å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´é¡µé¢å¡é¡¿ã€‚</p>
<p>Passive Event Listenersï¼šå°±æ˜¯å‘Šè¯‰å‰é¡µé¢å†…çš„äº‹ä»¶ç›‘å¬å™¨å†…éƒ¨æ˜¯å¦ä¼šè°ƒç”¨<code>preventDefault</code>å‡½æ•°æ¥é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œä»¥ä¾¿æµè§ˆå™¨æ ¹æ®è¿™ä¸ªä¿¡æ¯æ›´å¥½åœ°åšå‡ºå†³ç­–æ¥ä¼˜åŒ–é¡µé¢æ€§èƒ½ã€‚å½“å±æ€§passiveçš„å€¼ä¸ºtrueçš„æ—¶å€™ï¼Œä»£è¡¨è¯¥ç›‘å¬å™¨å†…éƒ¨ä¸ä¼šè°ƒç”¨<code>preventDefault</code>å‡½æ•°æ¥é˜»æ­¢é»˜è®¤æ»‘åŠ¨è¡Œä¸ºï¼ŒChromeæµè§ˆå™¨ç§°è¿™ç±»å‹çš„ç›‘å¬å™¨ä¸ºè¢«åŠ¨ï¼ˆpassiveï¼‰ç›‘å¬å™¨ã€‚ç›®å‰Chromeä¸»è¦åˆ©ç”¨è¯¥ç‰¹æ€§æ¥ä¼˜åŒ–é¡µé¢çš„æ»‘åŠ¨æ€§èƒ½ï¼Œæ‰€ä»¥Passive Event Listenersç‰¹æ€§å½“å‰ä»…æ”¯æŒmousewheel/touchç›¸å…³äº‹ä»¶ã€‚</p>
<p><strong>è€—æ—¶æ˜¯ä»€ä¹ˆ</strong><br>å½“ç”¨æˆ·åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šç‚¹å‡»ç½‘é¡µä¸­çš„æŸä¸ªå…ƒç´ æ—¶ï¼Œæ²¡æœ‰ä¸ºç§»åŠ¨äº¤äº’è®¾è®¡çš„ç½‘é¡µåœ¨è§¦æ‘¸å¼€å§‹äº‹ä»¶å’Œå¤„ç†é¼ æ ‡äº‹ä»¶ï¼ˆmousedownï¼‰ä¹‹é—´è‡³å°‘æœ‰300æ¯«ç§’çš„å»¶è¿Ÿã€‚å¦‚æœä½ æœ‰è§¦æ‘¸è®¾å¤‡ï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚æˆ–è€…ï¼Œä½¿ç”¨Chromeæµè§ˆå™¨ï¼Œä½ å¯ä»¥åœ¨Chromeå¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€ â€œæ¨¡æ‹Ÿè§¦æ‘¸äº‹ä»¶â€ï¼Œä»¥å¸®åŠ©ä½ åœ¨éè§¦æ‘¸ç³»ç»Ÿä¸Šæµ‹è¯•è§¦æ‘¸ç•Œé¢!</p>
<p>è¿™ä¸ªå»¶è¿Ÿæ˜¯ä¸ºäº†è®©æµè§ˆå™¨æœ‰æ—¶é—´åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨åšå…¶ä»–æ‰‹åŠ¿â€“ç‰¹åˆ«æ˜¯åŒå‡»ç¼©æ”¾ã€‚å¾ˆæ˜æ˜¾ï¼Œåœ¨ä½ æƒ³å¯¹æ‰‹æŒ‡è§¦æ‘¸åšå‡ºå³æ—¶ååº”çš„æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½æ˜¯ä¸ªé—®é¢˜ã€‚ç›®å‰æ­£åœ¨è¿›è¡Œçš„å·¥ä½œæ˜¯è¯•å›¾é™åˆ¶è¿™ç§å»¶è¿Ÿè‡ªåŠ¨å‘ç”Ÿçš„æƒ…å†µã€‚</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Chrome for Android</th>
<th align="left">Android Browser</th>
<th align="left">Opera Mobile for Android</th>
<th align="left">Firefox for Android</th>
<th align="left">Safari iOS</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Non-scalable viewport</td>
<td align="left">No delay</td>
<td align="left">300ms</td>
<td align="left">300ms</td>
<td align="left">No delay</td>
<td align="left">300ms</td>
</tr>
<tr>
<td align="left">No Viewport</td>
<td align="left">300ms</td>
<td align="left">300ms</td>
<td align="left">300ms</td>
<td align="left">300ms</td>
<td align="left">300ms</td>
</tr>
</tbody></table>
<p>é¿å…è¿™ç§é—®é¢˜çš„ä¸€ä¸ªç®€å•æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œæˆ‘è¿™ä¸ªé¡µé¢ä¸éœ€è¦æ»šåŠ¨ï¼š<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,user-scalable=no&quot;&gt;</code>ï¼Œä¸€èˆ¬åœ¨ç§»åŠ¨ç«¯è¿™æ ·å†™å¯ä»¥ã€‚</p>
<p><strong>ç»¼ä¸Š</strong>ï¼š<br>  äº‹ä»¶ç›‘å¬æ—¶ï¼Œè®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­ï¼špassiveä¸ºfalseï¼Œå‘Šè¯‰æµè§ˆå™¨æˆ‘è¦è‡ªå·±æ§åˆ¶<code>preventDefault</code>å‡½æ•°æ¥é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºã€‚</p>
<p><strong>å¦‚ä¸‹</strong>ï¼š<br>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">private onTouchStart(e:MouseEvent) &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'onTouchStart'</span>, e.cancelable);</span><br><span class="line">&#125;</span><br><span class="line">private onMouseOver(e:MouseEvent) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'onMouseOver'</span>, e.cancelable);</span><br><span class="line">&#125;</span><br><span class="line">componentDidMount() &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.touchElement) &#123;</span><br><span class="line">    <span class="keyword">this</span>.touchElement.addEventListener(<span class="string">'touchstart'</span>, <span class="keyword">this</span>.onTouchStart, &#123;<span class="attr">passive</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">    <span class="keyword">this</span>.touchElement.addEventListener(<span class="string">'mouseover'</span>, <span class="keyword">this</span>.onMouseOver, &#123;<span class="attr">passive</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>  <figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;div styleName=&#123;<span class="string">'btn-start-wrap'</span>&#125; ref=&#123;</span><br><span class="line">  (ref) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (ref) &#123;</span><br><span class="line">      <span class="keyword">this</span>.touchElement = ref;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;&#125;&gt;</span><br></pre></td></tr></table></figure><br>  ä»¥ä¸Šçš„ä»£ç touchstartåä¸ä¼šè§¦å‘mouseoverã€‚å®ç°äº†é˜»æ­¢ç§»åŠ¨ç«¯ä¹Ÿè§¦å‘mouseäº‹ä»¶çš„é€»è¾‘ã€‚</p>
<h4 id="å‚è§ï¼š"><a href="#å‚è§ï¼š" class="headerlink" title="å‚è§ï¼š"></a>å‚è§ï¼š</h4><p>  <a class="link"   href="https://www.jianshu.com/p/5bae6433025f"  target="_blank" rel="noopener">Passive Event Listenersâ€”â€”è®©é¡µé¢æ»‘åŠ¨æ›´åŠ æµç•…çš„æ–°ç‰¹æ€§<i class="fas fa-external-link-alt"></i></a><br>  <a class="link"   href="https://www.cnblogs.com/ziyunfei/p/5545439.html"  target="_blank" rel="noopener">ç´«äº‘é£ â€“ passive çš„äº‹ä»¶ç›‘å¬å™¨<i class="fas fa-external-link-alt"></i></a><br>  <a class="link"   href="https://www.html5rocks.com/en/mobile/touchandmouse/"  target="_blank" rel="noopener">touch&amp;mouse<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <categories>
        <category>ç§»åŠ¨ç«¯</category>
      </categories>
      <tags>
        <tag>ç§»åŠ¨ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackPlugins</title>
    <url>/2021/05/28/webpackPlugins/</url>
    <content><![CDATA[<h4 id="webpack-DefinePlugin"><a href="#webpack-DefinePlugin" class="headerlink" title="webpack.DefinePlugin"></a>webpack.DefinePlugin</h4><ul>
<li>ç®€ä»‹<br>åœ¨ç¼–è¯‘æ—¶åˆ›å»ºä¸€ä¸ªå¯ä»¥é…ç½®çš„å…¨å±€å˜é‡ï¼Œåœ¨åŒºåˆ†å¼€å‘æ¨¡å¼ï½œç”Ÿäº§æ¨¡å¼çš„ä¸åŒæ—¶ååˆ†æœ‰ç”¨ã€‚</li>
<li>ä½¿ç”¨ï¼š<ul>
<li>åœ¨webpackçš„pluginsä¸­ï¼Œå¢åŠ <code>webpack.DefinePlugin(Object)</code>çš„å®ä¾‹</li>
<li>æ–¹æ³•ä¸­ä¼ å…¥çš„Objectçš„keyå€¼ï¼Œå¯ä»¥åœ¨é¡¹ç›®æ‰€æœ‰importçš„æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</li>
<li>ä½¿ç”¨æ—¶å¾—åˆ°çš„æ˜¯keyå¯¹åº”é¢valueï¼Œè¿™é‡Œåœ¨ç¼–è¯‘æ—¶ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å¼•ç”¨ï¼Œè€Œæ˜¯<strong>ç¼–è¯‘æ—¶ç›´æ¥æ›¿æ¢</strong><blockquote>
<p>å› ä¸ºè¿™ä¸ªæ’ä»¶ç›´æ¥æ‰§è¡Œæ–‡æœ¬æ›¿æ¢ï¼Œç»™å®šçš„å€¼å¿…é¡»åŒ…å«å­—ç¬¦ä¸²æœ¬èº«å†…çš„å®é™…å¼•å·ã€‚é€šå¸¸ï¼Œæœ‰ä¸¤ç§æ–¹å¼æ¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Œä½¿ç”¨ â€˜â€œproductionâ€â€˜, æˆ–è€…ä½¿ç”¨ JSON.stringify(â€˜productionâ€™)ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li>æ–‡æ¡£åœ°å€<ul>
<li><a class="link"   href="https://v4.webpack.docschina.org/plugins/define-plugin/"  target="_blank" rel="noopener">webpack.DefinePlugin<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>vue3çš„æ•°æ®å“åº”å¼ç³»ç»Ÿ</title>
    <url>/2021/03/19/vue3%E7%9A%84%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<h3 id="Vue2-0çš„æ•°æ®ç›‘å¬"><a href="#Vue2-0çš„æ•°æ®ç›‘å¬" class="headerlink" title="Vue2.0çš„æ•°æ®ç›‘å¬"></a>Vue2.0çš„æ•°æ®ç›‘å¬</h3><p><strong>Object.defineProperty</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> object1 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(object1, <span class="string">'property1'</span>, &#123;</span><br><span class="line">    value: <span class="number">42</span>,</span><br><span class="line">    writable: <span class="literal">false</span>,</span><br><span class="line">    <span class="keyword">get</span>()&#123;&#125;,</span><br><span class="line">    <span class="keyword">set</span>(newValue) &#123; bValue = newValue; &#125;,</span><br><span class="line">    enumerable : <span class="literal">true</span>,</span><br><span class="line">    configurable : <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">object1.property1 = <span class="number">77</span>;</span><br><span class="line"><span class="comment">// throws an error in strict mode</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(object1.property1);</span><br><span class="line"><span class="comment">// expected output: 42</span></span><br></pre></td></tr></table></figure>
<h3 id="Vue3-0çš„æ•°æ®å“åº”å¼ç³»ç»Ÿ"><a href="#Vue3-0çš„æ•°æ®å“åº”å¼ç³»ç»Ÿ" class="headerlink" title="Vue3.0çš„æ•°æ®å“åº”å¼ç³»ç»Ÿ"></a>Vue3.0çš„æ•°æ®å“åº”å¼ç³»ç»Ÿ</h3><p><strong>proxy</strong> get\set</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¼•ç”¨vue-next(3)æºç ä¸­'packages/reactivity/dist/reactivity.global.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;reactive, effect&#125; = VueObserver;</span><br><span class="line"><span class="comment">//  reactive: æŠŠæ•°æ®å¤„ç†æˆä¸ºå“åº”å¼æ•°æ®</span></span><br><span class="line"><span class="comment">//  effect: </span></span><br><span class="line"><span class="comment">//      1.é¦–å…ˆä¼šæ‰§è¡Œä¸€æ¬¡å¯¹åº”çš„ç›‘å¬å‡½æ•°</span></span><br><span class="line"><span class="comment">//      2.ä¿®æ”¹å¯¹åº”ç›‘å¬å‡½æ•°å†…ä½¿ç”¨çš„å“åº”å¼æ•°æ®ï¼Œå¯¹åº”çš„ç›‘å¬å‡½æ•°å°±ä¼šç«‹å³æ‰§è¡Œï¼Œé‡æ–°æ‰§è¡Œçš„è¿‡ç¨‹å°±ä¼šè·å–æ–°çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> yideng = &#123;<span class="attr">count</span>: <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> state = reactive(yideng);</span><br><span class="line"><span class="keyword">const</span> fn = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> count = state.count;</span><br><span class="line">    <span class="keyword">const</span>.log(<span class="string">'å½“å‰çš„count'</span>, count)</span><br><span class="line">    <span class="comment">//render(count)  å¦‚æœåœ¨è¿™è§¦å‘renderæ¸²æŸ“</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">effect(fn)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vueæºç è§£è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹é˜Ÿåˆ—</title>
    <url>/2021/03/17/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E4%B9%8B%E9%98%9F%E5%88%97/</url>
    <content><![CDATA[<h3 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h3><ul>
<li>ç‰¹æ€§ï¼šå…ˆè¿›å…ˆå‡º</li>
<li>è§£é¢˜æ³•åˆ™ï¼š<ul>
<li>é¢˜ç›®å…·å¤‡<strong>å¹¿åº¦éå†ï¼ˆåˆ†å±‚éå†ï¼‰</strong>å’Œ<strong>é¡ºåºè¾“å‡º</strong>çš„ç‰¹ç‚¹ï¼Œå°±åº”è¯¥æƒ³åˆ°ç”¨FIFO é˜Ÿåˆ—æ¥è¯•ä¸€è¯•ã€‚</li>
<li><strong>æ»‘åŠ¨çª—å£</strong>ç±»å‹é¢˜</li>
</ul>
</li>
<li>æ¨¡æ¿ï¼š<ul>
<li>åˆ†å±‚éå†</li>
<li>å¾ªç¯é˜Ÿåˆ—</li>
<li>å•è°ƒé˜Ÿåˆ—</li>
</ul>
</li>
</ul>
<hr>
<h5 id="æ™®é€šé˜Ÿåˆ—"><a href="#æ™®é€šé˜Ÿåˆ—" class="headerlink" title="æ™®é€šé˜Ÿåˆ—"></a>æ™®é€šé˜Ÿåˆ—</h5><ul>
<li>ä¾‹é¢˜1ï¼šä»ä¸Šåˆ°ä¸‹æŒ‰å±‚æ‰“å°äºŒå‰æ ‘ï¼ŒåŒä¸€å±‚ç»“ç‚¹æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œæ¯ä¸€å±‚æ‰“å°åˆ°ä¸€è¡Œã€‚<br>  è¾“å…¥ï¼š <pre><code>   3
9     8
    6   7</code></pre>  è¾“å‡ºï¼š<code>[[3], [9, 8], [6, 7]]</code></li>
</ul>
<p><strong>äºŒå‰æ ‘çš„å±‚æ¬¡éå†</strong>çš„è§£é¢˜æŠ€å·§</p>
<ul>
<li>éå†æ–¹å¼çš„å˜åŒ–ï¼š<ul>
<li>äºŒå‰æ ‘çš„é”¯é½¿å½¢éå†</li>
<li>äºŒå‰æ ‘å±‚æ¬¡å€’åºéå†</li>
</ul>
</li>
<li>å±‚çš„ä¿¡æ¯å˜åŒ–<ul>
<li>äºŒå‰æ ‘çš„å±‚å¹³å‡å€¼</li>
<li>äºŒå‰æ ‘æœ€æ·±å±‚çš„å¶èŠ‚ç‚¹çš„å’Œ</li>
<li>äºŒå‰æ ‘çš„æœ€å¤§å®½åº¦</li>
</ul>
</li>
<li>æ ‘çš„å˜åŒ–<ul>
<li>Nå‰æ ‘çš„å±‚æ¬¡éå†</li>
<li>Nå‰æ ‘çš„æœ€å¤§æ·±åº¦</li>
</ul>
</li>
</ul>
<hr>
<h5 id="å¾ªç¯é˜Ÿåˆ—"><a href="#å¾ªç¯é˜Ÿåˆ—" class="headerlink" title="å¾ªç¯é˜Ÿåˆ—"></a>å¾ªç¯é˜Ÿåˆ—</h5><ul>
<li>é‡ç‚¹ï¼š å¾ªç¯ä½¿ç”¨å›ºå®šç©ºé—´</li>
<li>éš¾ç‚¹ï¼š æ§åˆ¶å¥½ front/rear ä¸¤ä¸ªé¦–å°¾æŒ‡ç¤ºå™¨</li>
<li>ç©ºé˜Ÿåˆ—å’Œæ»¡é˜Ÿåˆ—çš„åˆ¤æ–­ï¼Œåœ¨äº<code>used</code>å˜é‡</li>
<li>ä¾‹é¢˜2ï¼šè®¾è®¡ä¸€ä¸ªå¯ä»¥å®¹çº³ k ä¸ªå…ƒç´ çš„å¾ªç¯é˜Ÿåˆ—ã€‚éœ€è¦å®ç°ä»¥ä¸‹æ¥å£ï¼š  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">MyCircularQueue</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="comment">//Â å‚æ•°kè¡¨ç¤ºè¿™ä¸ªå¾ªç¯é˜Ÿåˆ—æœ€å¤šåªèƒ½å®¹çº³kä¸ªå…ƒç´ </span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="title">MyCircularQueue</span><span class="params">(<span class="keyword">int</span>Â k)</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â å°†valueæ”¾åˆ°é˜Ÿåˆ—ä¸­,Â æˆåŠŸè¿”å›true</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">boolean</span>Â <span class="title">enQueue</span><span class="params">(<span class="keyword">int</span>Â value)</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼ŒæˆåŠŸè¿”å›true</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">boolean</span>Â <span class="title">deQueue</span><span class="params">()</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â å¾—åˆ°é˜Ÿé¦–å…ƒç´ ï¼Œå¦‚æœä¸ºç©ºï¼Œè¿”å›-1</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">int</span>Â <span class="title">Front</span><span class="params">()</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â å¾—åˆ°é˜Ÿå°¾å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›-1</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">int</span>Â <span class="title">Rear</span><span class="params">()</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â çœ‹ä¸€ä¸‹å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">boolean</span>Â <span class="title">isEmpty</span><span class="params">()</span></span>;</span><br><span class="line">Â Â Â Â <span class="comment">//Â çœ‹ä¸€ä¸‹å¾ªç¯é˜Ÿåˆ—æ˜¯å¦å·²æ”¾æ»¡kä¸ªå…ƒç´ </span></span><br><span class="line">Â Â Â Â <span class="function"><span class="keyword">public</span>Â <span class="keyword">boolean</span>Â <span class="title">isFull</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h5 id="å•è°ƒé˜Ÿåˆ—"><a href="#å•è°ƒé˜Ÿåˆ—" class="headerlink" title="å•è°ƒé˜Ÿåˆ—"></a>å•è°ƒé˜Ÿåˆ—</h5><ul>
<li>æ¦‚å¿µï¼š è¦æ±‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»æ»¡è¶³å•è°ƒæ€§ï¼Œæ¯”å¦‚<strong>å•è°ƒé€’å¢</strong>ï¼Œæˆ–è€…<strong>å•è°ƒé€’å‡</strong>ã€‚å•è°ƒé˜Ÿåˆ—å±äºåŒç«¯é˜Ÿåˆ—çš„ä¸€ç§ã€‚åŒç«¯é˜Ÿåˆ—ä¸ FIFO é˜Ÿåˆ—çš„åŒºåˆ«åœ¨äºï¼š<ul>
<li>FIFO é˜Ÿåˆ—åªèƒ½ä»å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œé¦–éƒ¨å¼¹å‡ºå…ƒç´ ï¼›</li>
<li>åŒç«¯é˜Ÿåˆ—å¯ä»¥ä»é¦–å°¾ä¸¤ç«¯ push/pop å…ƒç´ ã€‚</li>
</ul>
</li>
<li>æ³¨æ„ï¼š å•è°ƒé˜Ÿåˆ—åœ¨å…¥é˜Ÿçš„æ—¶å€™ï¼Œéœ€è¦æ»¡è¶³ 2 ç‚¹ï¼š<ul>
<li>å…¥é˜Ÿå‰é˜Ÿåˆ—å·²ç»æ»¡è¶³å•è°ƒæ€§ï¼›</li>
<li>å…¥é˜Ÿåé˜Ÿåˆ—ä»ç„¶æ»¡è¶³å•è°ƒæ€§ã€‚</li>
</ul>
</li>
<li>ä¾‹é¢˜3ï¼šæ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼<br>  è¾“å…¥ï¼šnums = [1,3,-1,-3,5,3], k = 3<br>  è¾“å‡ºï¼š[3,3,5,5]<blockquote>
<p>ç¬¦åˆ<font color=red>å•è°ƒé€’å‡é˜Ÿåˆ—ï¼</font></p>
</blockquote>
</li>
<li>ä¾‹é¢˜4ï¼š ç»™å®šä¸€ä¸ªæ•°ç»„ A[]ï¼Œæ¯ä¸ªä½ç½® i æ”¾ç½®äº†é‡‘å¸ A[i]ï¼Œå°æ˜ä» A[0] å‡ºå‘ã€‚å½“å°æ˜èµ°åˆ° A[i] çš„æ—¶å€™ï¼Œä¸‹ä¸€æ­¥ä»–å¯ä»¥é€‰æ‹© A[i+1, i+k]ï¼ˆå½“ç„¶ï¼Œä¸èƒ½è¶…å‡ºæ•°ç»„è¾¹ç•Œï¼‰ã€‚æ¯ä¸ªä½ç½®ä¸€æ—¦è¢«é€‰æ‹©ï¼Œå°†ä¼šæŠŠé‚£ä¸ªä½ç½®çš„é‡‘å¸æ”¶èµ°ï¼ˆå¦‚æœä¸ºè´Ÿæ•°ï¼Œå°±è¦äº¤å‡ºé‡‘å¸ï¼‰ã€‚è¯·é—®ï¼Œæœ€å¤šèƒ½æ”¶é›†å¤šå°‘é‡‘å¸ï¼Ÿ<br>  è¾“å…¥ï¼š[1,-1,-100,-1000,100,3], k = 2<br>  è¾“å‡ºï¼š4<br>  è§£é‡Šï¼šä» A[0] = 1 å‡ºå‘ï¼Œæ”¶è·é‡‘å¸ 1ã€‚ä¸‹ä¸€æ­¥èµ°å¾€ A[2] = -100, æ”¶è·é‡‘å¸ -100ã€‚å†ä¸‹ä¸€æ­¥èµ°åˆ° A[4] = 100ï¼Œæ”¶è·é‡‘å¸ 100ï¼Œæœ€åèµ°åˆ° A[5] = 3ï¼Œæ”¶è·é‡‘å¸ 3ã€‚æœ€å¤šæ”¶è· 1 - 100 + 100 + 3 = 4ã€‚æ²¡æœ‰æ¯”è¿™ä¸ªæ›´å¥½çš„èµ°æ³•äº†ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>ç®—æ³•</tag>
        <tag>é˜Ÿåˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‰‹å†™ä»£ç ç³»åˆ—ä¹‹New(fn)</title>
    <url>/2021/03/17/%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81%E7%B3%BB%E5%88%97%E4%B9%8BNew-fn/</url>
    <content><![CDATA[<h3 id="Newæ“ä½œç¬¦åšäº†å“ªäº›äº‹"><a href="#Newæ“ä½œç¬¦åšäº†å“ªäº›äº‹" class="headerlink" title="Newæ“ä½œç¬¦åšäº†å“ªäº›äº‹"></a>Newæ“ä½œç¬¦åšäº†å“ªäº›äº‹</h3><ul>
<li>åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</li>
<li>ä¼šè¢«æ‰§è¡Œ[[Prototype]]ï¼ˆä¹Ÿå°±æ˜¯<strong>proto</strong>ï¼‰é“¾æ¥ã€‚</li>
<li>ä½¿thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</li>
<li>é€šè¿‡newåˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«[[Prototype]]é“¾æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„prototypeå¯¹è±¡ä¸Šã€‚</li>
<li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹Object(åŒ…å«Functoin, Array, Date, RegExg, Error)ï¼Œé‚£ä¹ˆnewè¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨å°†è¿”å›è¯¥å¯¹è±¡å¼•ç”¨ã€‚</li>
</ul>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><ul>
<li><p>ç‰ˆæœ¬ä¸€ï¼š</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNew</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸”å°†å…¶éšå¼åŸå‹æŒ‡å‘æ„é€ å‡½æ•°åŸå‹</span></span><br><span class="line">        <span class="keyword">let</span> obj = &#123;</span><br><span class="line">            __proto__: fn.prototype</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œæ„é€ å‡½æ•°</span></span><br><span class="line">        fn.call(obj, ...arguments)</span><br><span class="line">        <span class="comment">// è¿”å›è¯¥å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = myNew(Person)(<span class="string">'chen'</span>, <span class="number">18</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç‰ˆæœ¬äºŒï¼š</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myNew</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span>(fn.prototype !==<span class="literal">null</span>)&#123;</span><br><span class="line">        res.__proto__ = fn.prototype;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> ret = fn.apply(res, <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> ret === <span class="string">"object"</span> || <span class="keyword">typeof</span> ret === <span class="string">"function"</span>) &amp;&amp; ret !== <span class="literal">null</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> obj = New(A, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// equals to</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> A(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>æ‰‹å†™ä»£ç ç³»åˆ—</category>
      </categories>
  </entry>
  <entry>
    <title>æ‰‹å†™ä»£ç ç³»åˆ—ä¹‹é˜²æŠ–ä¸èŠ‚æµ</title>
    <url>/2021/03/16/%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81%E7%B3%BB%E5%88%97%E4%B9%8B%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/</url>
    <content><![CDATA[<h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h3><p><strong>æ€è·¯</strong>ï¼šåœ¨è§„å®šæ—¶é—´å†…æœªè§¦å‘ç¬¬äºŒæ¬¡ï¼Œåˆ™æ‰§è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// åˆ©ç”¨é—­åŒ…ä¿å­˜å®šæ—¶å™¨</span></span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="comment">// åœ¨è§„å®šæ—¶é—´å†…å†æ¬¡è§¦å‘</span></span><br><span class="line">        <span class="comment">// ä¼šå…ˆæ¸…é™¤å®šæ—¶å™¨å†é‡è®¾å®šæ—¶å™¨</span></span><br><span class="line">        clearTimeout(timer);</span><br><span class="line">        timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            fn.apply(context, args)</span><br><span class="line">        &#125;,delay);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸¾ä¾‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"é˜²æŠ–"</span>)</span><br><span class="line">&#125;</span><br><span class="line">addEventListener(<span class="string">"scroll"</span>, debounce(fn1, <span class="number">1000</span>))</span><br></pre></td></tr></table></figure>

<h3 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h3><p><strong>æ€è·¯</strong>ï¼šåœ¨è§„å®šæ—¶é—´å†…åªè§¦å‘ä¸€æ¬¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// åˆ©ç”¨é—­åŒ…ä¿å­˜æ—¶é—´</span></span><br><span class="line">    <span class="keyword">let</span> prev = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">if</span>(now - prev &gt;= delay)&#123;</span><br><span class="line">            fn.apply(context, args);</span><br><span class="line">            prev = <span class="built_in">Date</span>.now();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸¾ä¾‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"èŠ‚æµ"</span>)</span><br><span class="line">&#125;</span><br><span class="line">addEventListener(<span class="string">"scroll"</span>, throttle(fn2, <span class="number">1000</span>))</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æ‰‹å†™ä»£ç ç³»åˆ—</category>
      </categories>
  </entry>
  <entry>
    <title>æ‰‹å†™ä»£ç å’”å’”å’”</title>
    <url>/2021/03/16/%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81%E5%92%94%E5%92%94%E5%92%94/</url>
    <content><![CDATA[<h3 id="å’”å’”å’”"><a href="#å’”å’”å’”" class="headerlink" title="å’”å’”å’”"></a>å’”å’”å’”</h3><ul>
<li><a href="/2021/03/16/æ‰‹å†™ä»£ç ç³»åˆ—ä¹‹é˜²æŠ–ä¸èŠ‚æµ/">æ‰‹å†™ä»£ç ç³»åˆ—ä¹‹é˜²æŠ–ä¸èŠ‚æµ</a></li>
<li><a href="/2021/03/17/æ‰‹å†™ä»£ç ç³»åˆ—ä¹‹New-fn/">æ‰‹å†™New</a></li>
<li><a href="">æ‰‹å†™Promise</a></li>
<li><a href="">æ‰‹å†™Promise.all</a></li>
<li><a href="">äºŒå‰æ ‘çš„æ·±åŠéå†</a></li>
<li><a href="">versionç‰ˆæœ¬å¯¹æ¯”</a></li>
<li><a href="">ä¸€ä¸ªå­—ç¬¦ä¸²æœ€å¤§çš„å›æ–‡å­—ç¬¦ä¸²</a></li>
<li><a href="">ä¸‰æ•°ä¹‹å’Œ</a></li>
<li><a href="">æ‰‹å†™indexof</a></li>
<li><a href="">æ‰‹å†™EventEmitter</a></li>
<li><a href="">æ‰‹å†™Redux.createStore</a></li>
<li><a href="">æ‰‹å†™æ·±æ‹·è´ã€æ·±æ‹·è´å‡½æ•°</a></li>
</ul>
]]></content>
      <categories>
        <category>æ‰‹å†™ä»£ç ç³»åˆ—</category>
      </categories>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹æ ˆç»“æ„</title>
    <url>/2021/03/16/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E4%B9%8B%E6%A0%88%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<h3 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h3><ul>
<li>ç‰¹æ€§ï¼šå…ˆè¿›åå‡º</li>
<li>è§£é¢˜æ³•åˆ™ï¼š<ul>
<li>é¢˜ç›®ä¸­æœ‰<strong>é…å¯¹ã€æ¶ˆé™¤</strong>çš„é¢˜æ„ï¼Œä¼˜å…ˆè€ƒè™‘<strong>æ ˆ</strong>ç»“æ„</li>
<li>æ ˆä¸­å­˜æ”¾çš„å¯ä»¥æ˜¯<strong>å†…å®¹æœ¬èº«</strong>å’Œ<strong>å†…å®¹çš„ç´¢å¼•</strong></li>
<li>æ•°ç»„ä¸­å³è¾¹<strong>ç¬¬ä¸€ä¸ªæ¯”æˆ‘å°</strong>çš„å…ƒç´ çš„ä½ç½®ï¼Œæ±‚è§£ç”¨<strong>é€’å¢æ ˆ</strong></li>
<li>è¾ƒå°çš„æ•°<strong>æ¶ˆé™¤</strong>æ‰è¾ƒå¤§çš„æ•°çš„æ—¶å€™ï¼Œä½¿ç”¨<strong>é€’å¢æ ˆ</strong>ã€‚</li>
<li>æ ¹æ®é¢˜æ„æ€»ç»“<strong>å…¥æ ˆä¸å‡ºæ ˆçš„æ—¶æœº</strong></li>
</ul>
</li>
</ul>
<h5 id="æ™®é€šæ ˆ"><a href="#æ™®é€šæ ˆ" class="headerlink" title="æ™®é€šæ ˆ"></a>æ™®é€šæ ˆ</h5><ul>
<li>è§„å¾‹æ€§ï¼š<font color=red>é…å¯¹ã€æ¶ˆé™¤</font></li>
</ul>
<hr>
<ul>
<li>ä¾‹é¢˜1ï¼šå­—ç¬¦ä¸²ä¸­åªæœ‰å­—ç¬¦â€™(â€˜å’Œâ€™)â€™ã€‚åˆæ³•å­—ç¬¦ä¸²éœ€è¦æ‹¬å·å¯ä»¥é…å¯¹ã€‚æ¯”å¦‚ï¼š<br>  è¾“å…¥ï¼šâ€()â€<br>  è¾“å‡ºï¼štrue<br>  è§£é‡Šï¼š()ï¼Œ()()ï¼Œ(())æ˜¯åˆæ³•çš„ã€‚)(ï¼Œ()(ï¼Œ(()æ˜¯éæ³•çš„ã€‚<br>  è¯·ä½ å®ç°ä¸€ä¸ªå‡½æ•°<code>isValid(s)</code>ï¼Œæ¥åˆ¤æ–­ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ã€‚<blockquote>
<p>é’ˆå¯¹ä¾‹1è¿™ç§<font color=green>å†…å®¹ä¸€æ ·</font>æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<font color=green>è®¡æ•°å™¨ä¼˜åŒ–</font></p>
</blockquote>
</li>
<li>ä¾‹é¢˜æ‹“å±•ï¼š ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ â€˜(â€˜ï¼Œâ€™)â€™ï¼Œâ€™{â€˜ï¼Œâ€™}â€™ï¼Œâ€™[â€˜ï¼Œâ€™]â€™ çš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š<br>  å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆ<br>  å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆ<br>  æ³¨æ„ç©ºå­—ç¬¦ä¸²å¯è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²<br>  è¯·å®ç°<code>isValid(s)</code></li>
</ul>
<hr>
<ul>
<li>ä¾‹é¢˜2ï¼šåœ¨æ°´ä¸­æœ‰è®¸å¤šé±¼ï¼Œå¯ä»¥è®¤ä¸ºè¿™äº›é±¼åœæ”¾åœ¨ x è½´ä¸Šã€‚å†ç»™å®šä¸¤ä¸ªæ•°ç»„ Sizeï¼ŒDirï¼ŒSize[i] è¡¨ç¤ºç¬¬ i æ¡é±¼çš„å¤§å°ï¼ŒDir[i] è¡¨ç¤ºé±¼çš„æ–¹å‘ ï¼ˆ0 è¡¨ç¤ºå‘å·¦æ¸¸ï¼Œ1 è¡¨ç¤ºå‘å³æ¸¸ï¼‰ã€‚è¿™ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«è¡¨ç¤ºé±¼çš„å¤§å°å’Œæ¸¸åŠ¨çš„æ–¹å‘ï¼Œå¹¶ä¸”ä¸¤ä¸ªæ•°ç»„çš„é•¿åº¦ç›¸ç­‰ã€‚é±¼çš„è¡Œä¸ºç¬¦åˆä»¥ä¸‹å‡ ä¸ªæ¡ä»¶:<br>  æ‰€æœ‰çš„é±¼éƒ½åŒæ—¶å¼€å§‹æ¸¸åŠ¨ï¼Œæ¯æ¬¡æŒ‰ç…§é±¼çš„æ–¹å‘ï¼Œéƒ½æ¸¸åŠ¨ä¸€ä¸ªå•ä½è·ç¦»ï¼›<br>  å½“æ–¹å‘ç›¸å¯¹æ—¶ï¼Œå¤§é±¼ä¼šåƒæ‰å°é±¼ï¼›<br>  é±¼çš„å¤§å°éƒ½ä¸ä¸€æ ·ã€‚<br>  è¾“å…¥ï¼šSize = [4, 2, 5, 3, 1], Dir = [1, 1, 0, 0, 0]<br>  è¾“å‡ºï¼š3<br>  å®Œæˆ<code>solution(Size, Dir)</code>æ¥è®¡ç®—è¿˜å‰©ä¸‹å‡ æ¡é±¼ï¼Ÿ</li>
</ul>
<hr>
<h5 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h5><ul>
<li>å®šä¹‰ï¼šå•è°ƒæ ˆå°±æ˜¯æŒ‡æ ˆä¸­çš„å…ƒç´ å¿…é¡»æ˜¯æŒ‰ç…§å‡åºæ’åˆ—çš„æ ˆï¼Œæˆ–è€…æ˜¯é™åºæ’åˆ—çš„æ ˆã€‚<br>  å‡åºæ’åˆ—çš„æ ˆç§°ä¸º<strong>é€’å¢æ ˆ</strong><br>  é™åºæ’åˆ—çš„æ ˆç§°ä¸º<strong>é€’å‡æ ˆ</strong><br>  ç‰¹ç‚¹ï¼šä»»ä½•æ—¶å€™éƒ½éœ€è¦ä¿è¯æ ˆçš„æœ‰åºæ€§</li>
</ul>
<hr>
<ul>
<li>ä¾‹é¢˜1ï¼šä¸€ä¸ªæ•´æ•°æ•°ç»„ Aï¼Œæ‰¾åˆ°æ¯ä¸ªå…ƒç´ ï¼šå³è¾¹ç¬¬ä¸€ä¸ªæ¯”æˆ‘å°çš„ä¸‹æ ‡ä½ç½®ï¼Œæ²¡æœ‰åˆ™ç”¨ -1 è¡¨ç¤ºã€‚ï¼ˆæ‰¾å‡ºæ•°ç»„ä¸­å³è¾¹æ¯”æˆ‘å°çš„å…ƒç´ ï¼‰<br>  è¾“å…¥ï¼š[5, 2]<br>  è¾“å‡ºï¼š[1, -1]<br>  è§£é‡Šï¼šå› ä¸ºå…ƒç´  5 çš„å³è¾¹ç¦»æˆ‘æœ€è¿‘ä¸”æ¯”æˆ‘å°çš„ä½ç½®åº”è¯¥æ˜¯ A[1]ï¼Œæœ€åä¸€ä¸ªå…ƒç´  2 å³è¾¹æ²¡æœ‰æ¯” 2 å°çš„å…ƒç´ ï¼Œæ‰€ä»¥åº”è¯¥è¾“å‡º -1ã€‚</li>
</ul>
<blockquote>
<p>ç±»ä¼¼é¢˜ï¼š<br>æ•°ç»„ä¸­å³è¾¹ç¬¬ä¸€ä¸ªæ¯”æˆ‘å¤§çš„å…ƒç´ çš„ä½ç½®<br>æ•°ç»„ä¸­å…ƒç´ å·¦è¾¹ç¦»æˆ‘æœ€è¿‘ä¸”æ¯”æˆ‘å°çš„å…ƒç´ çš„ä½ç½®<br>æ•°ç»„ä¸­å…ƒç´ å·¦è¾¹ç¦»æˆ‘æœ€è¿‘ä¸”æ¯”æˆ‘å¤§çš„å…ƒç´ çš„ä½ç½®</p>
</blockquote>
<ul>
<li>ä¾‹é¢˜2ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„å’Œ kï¼Œè¦æ±‚ä¾æ¬¡å–å‡º k ä¸ªæ•°ï¼Œè¾“å‡ºå…¶ä¸­æ•°ç»„çš„ä¸€ä¸ªå­åºåˆ—ï¼Œéœ€è¦æ»¡è¶³ï¼š1. é•¿åº¦ä¸º kï¼›2.å­—å…¸åºæœ€å°ã€‚<br>  è¾“å…¥ï¼šnums = [3,5,2,6], k = 2<br>  è¾“å‡ºï¼š[2,6]<br>  è§£é‡Šï¼šåœ¨æ‰€æœ‰å¯èƒ½çš„è§£ï¼š{[3,5], [3,2], [3,6], [5,2], [5,6], [2,6]} ä¸­ï¼Œ[2,6] å­—å…¸åºæœ€å°ã€‚</li>
</ul>
<h5 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h5><p><img src="https://s0.lgstatic.com/i/image6/M01/0B/7F/CioPOWA4q6qASB-UAADhj7uzOwg933.png" alt="å›¾"></p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>ç®—æ³•</tag>
        <tag>æ ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„ä¸ç®—æ³•</title>
    <url>/2021/03/03/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<h3 id="ç®—æ³•å››æ­¥åˆ†ææ³•ï¼š"><a href="#ç®—æ³•å››æ­¥åˆ†ææ³•ï¼š" class="headerlink" title="ç®—æ³•å››æ­¥åˆ†ææ³•ï¼š"></a>ç®—æ³•å››æ­¥åˆ†ææ³•ï¼š</h3><ol>
<li>æ¨¡æ‹Ÿï¼šæ¨¡æ‹Ÿé¢˜ç›®çš„è¿è¡Œã€‚</li>
<li>è§„å¾‹ï¼šå°è¯•æ€»ç»“å‡ºé¢˜ç›®çš„ä¸€èˆ¬è§„å¾‹å’Œç‰¹ç‚¹ã€‚</li>
<li>åŒ¹é…ï¼šæ‰¾åˆ°ç¬¦åˆè¿™äº›ç‰¹ç‚¹çš„æ•°æ®ç»“æ„ä¸ç®—æ³•ã€‚</li>
<li>è¾¹ç•Œï¼šè€ƒè™‘ç‰¹æ®Šæƒ…å†µã€‚</li>
</ol>
<h3 id="æ•°æ®ç»“æ„ä¸ç®—æ³•"><a href="#æ•°æ®ç»“æ„ä¸ç®—æ³•" class="headerlink" title="æ•°æ®ç»“æ„ä¸ç®—æ³•"></a>æ•°æ®ç»“æ„ä¸ç®—æ³•</h3><ul>
<li><a href="/2021/03/16/æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹æ ˆç»“æ„/">æ ˆç»“æ„ä¸ç®—æ³•</a></li>
</ul>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>Virtual DOMçš„å·¥ä½œåŸç†</title>
    <url>/2021/01/02/%E8%99%9A%E6%8B%9Fdom/</url>
    <content><![CDATA[<h4 id="Virtual-DOM-ä¹Ÿè¢«ç§°ä¸ºè™šæ‹ŸDOM"><a href="#Virtual-DOM-ä¹Ÿè¢«ç§°ä¸ºè™šæ‹ŸDOM" class="headerlink" title="Virtual DOM ä¹Ÿè¢«ç§°ä¸ºè™šæ‹ŸDOM"></a>Virtual DOM ä¹Ÿè¢«ç§°ä¸ºè™šæ‹ŸDOM</h4><ul>
<li>åœ¨reactä¸­ï¼Œ<code>jsxè¯­æ³•</code>ç»è¿‡<code>babelè§£æ</code>è½¬åŒ–ä¸º<code>React.createElement()</code>å‡½æ•°è°ƒç”¨åç”Ÿæˆ<code>astæŠ½è±¡è¯­æ³•æ ‘</code>ï¼Œå†é€šè¿‡<code>render</code>å‡½æ•°å°†<code>astæ ‘</code>è½¬æ¢ä¸º<code>fiber ç»“æ„</code>ï¼Œå¡«å…¥è®¸å¤šè°ƒåº¦ã€æ›´æ–°ã€diffç›¸å…³æ•°æ®ï¼Œå¹¶è½¬æ¢<code>astæ ‘</code>ä¸º<code>è™šæ‹ŸDOMæ ‘</code>ï¼Œå†å®ŒæˆæŒ‚è½½ã€‚</li>
<li>åœ¨vueä¸­ï¼Œæ¨¡ç‰ˆè¯­æ³• ç»è¿‡ <code>generate</code>å¤„ç†(æ­£åˆ™åŒ¹é… ç”Ÿæˆ <code>astæŠ½è±¡è¯­æ³•æ ‘</code>)ï¼Œ<code>render</code>ä¸­è°ƒç”¨<code>_c()/createElement()</code>å‡½æ•°å°†<code>astæ ‘</code>ç”Ÿæˆ<code>VNode(è™šæ‹ŸDOM)</code>,å†å®ŒæˆæŒ‚è½½ã€‚</li>
</ul>
<h4 id="è™šæ‹ŸDOMçš„æ¥æº"><a href="#è™šæ‹ŸDOMçš„æ¥æº" class="headerlink" title="è™šæ‹ŸDOMçš„æ¥æº"></a>è™šæ‹ŸDOMçš„æ¥æº</h4><p>reactçš„å‰èº«æ˜¯facebookçš„<code>XHP</code>ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œé¡µé¢éƒ½æ˜¯é€šè¿‡è½¬ä¹‰çš„æ–¹å¼ç”Ÿæˆçš„ï¼Œå¹¶æ²¡æœ‰ç›´æ¥çš„HTMLï¼Œç¡®ä¿åœ¨<code>XHP</code>ä¸­å†™å‡ºå®‰å…¨çš„é™æ€é¡µé¢ã€‚</p>
<p>åˆè¡·æ˜¯ï¼š</p>
<ul>
<li>ç®€åŒ–å‰ç«¯å¼€å‘ï¼ˆåç«¯èµ‹èƒ½ï¼‰</li>
<li>é˜²æ­¢xssæ”»å‡»</li>
</ul>
<p>å‘å±•æ˜¯ï¼š</p>
<ul>
<li>é€šè¿‡è™šæ‹ŸDOMè§„é¿é£é™©ï¼Œä¸è®©ç”¨æˆ·ç›´æ¥çš„æ“ä½œDOMäº†ï¼Œè€Œæ˜¯æŠŠå®ƒå°èµ·æ¥è‡ªå·±ç®¡ç†</li>
</ul>
<h4 id="è™šæ‹ŸDOMçš„è¡¨ç°å½¢å¼"><a href="#è™šæ‹ŸDOMçš„è¡¨ç°å½¢å¼" class="headerlink" title="è™šæ‹ŸDOMçš„è¡¨ç°å½¢å¼"></a>è™šæ‹ŸDOMçš„è¡¨ç°å½¢å¼</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    tag: <span class="string">'input'</span>,</span><br><span class="line">    props: &#123;</span><br><span class="line">        type: <span class="string">'button'</span>,</span><br><span class="line">        value: <span class="string">''</span></span><br><span class="line">    &#125;,</span><br><span class="line">    childrean: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>React æœ‰ä¸¤ä¸ªå‡½æ•°<br>    * diff å‡½æ•°ï¼Œå»è®¡ç®—çŠ¶æ€å˜æ›´å‰åçš„è™šæ‹Ÿ DOM æ ‘å·®å¼‚<br>    * æ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“æ•´ä¸ªè™šæ‹Ÿ DOM æ ‘æˆ–è€…å¤„ç†å·®å¼‚ç‚¹ã€‚<br>    ç°åœ¨æ˜¯ä¸æ˜¯æœ‰äº›ç†è§£ä¸ºä»€ä¹ˆ React ä¸ ReactDOM æ˜¯ä¸¤ä¸ªåº“äº†ï¼Ÿæ­£æ˜¯ç”±äºè®¡ç®—ä¸æ¸²æŸ“çš„åˆ†å·¥ã€‚<br>    å…¶ä¸­ React çš„ä¸»è¦å·¥ä½œæ˜¯ç»„ä»¶å®ç°ã€æ›´æ–°è°ƒåº¦ï¼›ReactDOM æä¾›äº†åœ¨ ç½‘é¡µä¸Šæ¸²æŸ“ çš„åŸºç¡€</p>
</blockquote>
<h4 id="è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹"><a href="#è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹"></a>è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹</h4><p>ä¼˜ç‚¹</p>
<ul>
<li>æ€§èƒ½ä¼˜è¶Š</li>
<li>è§„é¿XSS</li>
<li>å¯è·¨å¹³å°</li>
</ul>
<p>ä½†æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯è™šæ‹ŸDOMæ›´é«˜æ•ˆ<br>&emsp;&emsp;å¤§é‡çš„ç›´æ¥æ“ä½œDOMå®¹æ˜“å¼•èµ·é¡µé¢æ€§èƒ½ä¸‹é™ã€‚è¿™æ—¶ReactåŸºäºè™šæ‹ŸDOMçš„diffå¤„ç†ä¸æ‰¹å¤„ç†æ“ä½œï¼Œå¯é™ä½DOMçš„æ“ä½œé¢‘æ¬¡å’ŒèŒƒå›´ï¼Œæå‡é¡µé¢æ€§èƒ½<br>&emsp;&emsp;ä½†æ˜¯åœ¨é¦–æ¬¡æ¸²æŸ“æˆ–è€…å¾®é‡domæ“ä½œçš„æ—¶å€™ï¼Œè™šæ‹ŸDOMçš„æ€§èƒ½å°±æ›´æ…¢ä¸€äº›ã€‚</p>
<p>é‚£è™šæ‹Ÿ DOM ä¸€å®šå¯ä»¥è§„é¿ XSSå—ï¼Ÿ<br>&emsp;&emsp;è™šæ‹Ÿ DOM å†…éƒ¨ç¡®ä¿äº†å­—ç¬¦è½¬ä¹‰ï¼Œæ‰€ä»¥ç¡®å®å¯ä»¥åšåˆ°è¿™ç‚¹ï¼Œä½† React å­˜åœ¨é£é™©ï¼Œå› ä¸º React ç•™æœ‰ dangerouslySetInnerHTML API ç»•è¿‡è½¬ä¹‰ã€‚</p>
<p>æ²¡æœ‰è™šæ‹Ÿ DOM ä¸èƒ½å®ç°è·¨å¹³å°å—ï¼Ÿ<br>&emsp;&emsp;æ¯”å¦‚ NativeScript æ²¡æœ‰è™šæ‹Ÿ DOM å±‚ ï¼Œå®ƒæ˜¯é€šè¿‡æä¾›å…¼å®¹åŸç”Ÿ API çš„ JS API å®ç°è·¨å¹³å°å¼€å‘ã€‚<br>é‚£è™šæ‹Ÿ DOM çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿ<br>&emsp;&emsp;å®é™…ä¸Šå®ƒçš„ä¼˜åŠ¿åœ¨äºè·¨å¹³å°çš„æˆæœ¬æ›´ä½ã€‚åœ¨ React Native ä¹‹åï¼Œå‰ç«¯ç¤¾åŒºä»è™šæ‹Ÿ DOM ä¸­ä½“ä¼šåˆ°äº†è·¨å¹³å°çš„æ— é™å‰æ™¯ï¼Œ<br>æ‰€ä»¥åœ¨åç»­çš„å‘å±•ä¸­ï¼Œéƒ½å€Ÿé‰´äº†è™šæ‹Ÿ DOMã€‚æ¯”å¦‚ï¼šç¤¾åŒºæµè¡Œçš„å°ç¨‹åºåŒæ„æ–¹æ¡ˆï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¼šæä¾›ç±»ä¼¼è™šæ‹Ÿ DOM çš„ç»“æ„æè¿°å¯¹è±¡ï¼Œæ¥æ”¯æ’‘å¤šç«¯è½¬æ¢ã€‚</p>
<p>ç¼ºç‚¹</p>
<ul>
<li>å†…å­˜å ç”¨è¾ƒé«˜</li>
<li>éš¾ä»¥è¿›è¡Œä¼˜åŒ–</li>
</ul>
]]></content>
      <categories>
        <category>react</category>
        <category>vue</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Serverlessæ˜¯ä»€ä¹ˆ</title>
    <url>/2021/01/01/Serverless%E6%98%AF%E4%BB%80%E4%B9%88/</url>
    <content><![CDATA[<h3 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h3><ul>
<li><p>å¹¿ä¹‰ä¸Šæ¥è¯´<br>æ˜¯æ„å»ºå’Œè¿è¡Œè½¯ä»¶æ—¶ä¸éœ€è¦å…³å¿ƒæœåŠ¡å™¨çš„ä¸€ç§æ¶æ„æ€æƒ³ã€‚è™½ç„¶ Serverless ç¿»è¯‘è¿‡æ¥æ˜¯ â€œæ— æœåŠ¡å™¨â€ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ç€åº”ç”¨è¿è¡Œä¸éœ€è¦æœåŠ¡å™¨ï¼Œè€Œæ˜¯å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒæœåŠ¡å™¨ã€‚è€ŒåŸºäº Serverless æ€æƒ³å®ç°çš„è½¯ä»¶æ¶æ„å°±æ˜¯ Serverless æ¶æ„ã€‚</p>
</li>
<li><p>ç‹­ä¹‰ä¸Šè¯´<br>  ç‹­ä¹‰çš„ Serverless æ˜¯ <code>FaaS</code> å’Œ <code>BaaS</code> çš„ç»„åˆã€‚</p>
<ul>
<li>FaaSï¼ˆFunction as a Serviceï¼‰ï¼š<ol>
<li>FaaSæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°è¿è¡Œå¹³å°ï¼Œå‡½æ•°è¿è¡Œæ—¶ï¼Œä½ å¯¹åº•å±‚çš„æœåŠ¡å™¨æ˜¯æ— æ„ŸçŸ¥çš„ï¼ŒFaaS äº§å“ä¼šè´Ÿè´£èµ„æºçš„è°ƒåº¦å’Œè¿ç»´ï¼Œè¿™æ˜¯å®ƒçš„ç‰¹ç‚¹ä¹‹ä¸€ï¼Œ<strong>ä¸ç”¨è¿ç»´</strong>ã€‚</li>
<li>FaaS ä¸­çš„å‡½æ•°ä¹Ÿä¸æ˜¯æŒç»­è¿è¡Œçš„ï¼Œè€Œæ˜¯é€šè¿‡äº‹ä»¶è¿›è¡Œè§¦å‘ï¼Œæ¯”å¦‚ HTTP äº‹ä»¶ã€æ¶ˆæ¯äº‹ä»¶ç­‰ï¼Œäº§ç”Ÿäº‹ä»¶çš„æºå¤´å«è§¦å‘å™¨ï¼ŒFaaS å¹³å°ä¼šé›†æˆè¿™äº›è§¦å‘å™¨ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨å°±è¡Œï¼Œè¿™æ˜¯ FaaS çš„ç¬¬äºŒä¸ªç‰¹ç‚¹ï¼Œ<strong>äº‹ä»¶é©±åŠ¨</strong>ã€‚</li>
<li>FaaS çš„ç¬¬ä¸‰ä¸ªç‰¹ç‚¹æ˜¯<strong>æŒ‰é‡ä»˜è´¹</strong>ã€‚ FaaS äº§å“çš„æ”¶è´¹æ–¹å¼ï¼Œéƒ½æ˜¯æŒ‰ç…§å‡½æ•°æ‰§è¡Œæ¬¡æ•°å’Œæ‰§è¡Œæ—¶æ¶ˆè€—çš„ CPUã€å†…å­˜ç­‰èµ„æºè¿›è¡Œè®¡è´¹çš„ã€‚</li>
<li>FaaS åœ¨è¿è¡Œå‡½æ•°çš„æ—¶å€™ï¼Œä¼šæ ¹æ®å¹¶å‘é‡è‡ªåŠ¨ç”Ÿæˆå¤šä¸ªå‡½æ•°å®ä¾‹ï¼Œå¹¶ä¸”å¹¶å‘ç†è®ºæ˜¯æ²¡æœ‰ä¸Šé™çš„ï¼Œè¿™æ˜¯å®ƒçš„ç¬¬å››ä¸ªç‰¹ç‚¹ï¼Œ<strong>å¼¹æ€§ä¼¸ç¼©</strong>ã€‚</li>
</ol>
<ul>
<li>FaaS æ¯æ¬¡æ‰§è¡Œå‡½æ•°æ—¶ï¼Œéƒ½ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„è¿è¡Œç¯å¢ƒï¼Œç„¶åä»å¤´å¼€å§‹æ‰§è¡Œæ•´ä¸ªä»£ç ï¼Œè€Œä¸æ˜¯åªæ‰§è¡Œå…¶ä¸­çš„ handler æ–¹æ³•ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œè¿è¡Œç¯å¢ƒå°±ä¼šè¢«é‡Šæ”¾ã€‚è¿™æ ·æ¯æ¬¡å‡½æ•°æ‰§è¡Œï¼Œéƒ½æ˜¯æ–°çš„è¿è¡Œç¯å¢ƒï¼Œè‡ªç„¶ä¸åŒå‡½æ•°ä¹‹é—´å°±æ— æ³•å…±ç”¨ pv è¿™ä¸ªå˜é‡äº†ã€‚FaaS çš„å¦ä¸€ä¸ªç‰¹ç‚¹ï¼Œ<strong>æ— çŠ¶æ€</strong>ã€‚</li>
</ul>
</li>
<li>BaaSï¼ˆBackend as a Serviceï¼‰<br> ä¸ºäº†è§£å†³åˆ†å¸ƒå¼ä¸­çš„çŠ¶æ€å…±äº«é—®é¢˜<br> BaaS æœ¬è´¨ä¸Šå°±æ˜¯æŠŠåç«¯åŠŸèƒ½å°è£…èµ·æ¥ï¼Œä»¥æ¥å£çš„å½¢å¼æä¾›æœåŠ¡ã€‚</li>
</ul>
</li>
<li><p>æ€»<br>åŸºäº FaaS å’Œ BaaS çš„æ¶æ„ï¼Œæ˜¯ä¸€ç§è®¡ç®—å’Œå­˜å‚¨åˆ†ç¦»çš„æ¶æ„ã€‚ è®¡ç®—ç”± FaaS è´Ÿè´£ï¼Œå­˜å‚¨ç”± BaaS è´Ÿè´£ï¼Œè®¡ç®—å’Œå­˜å‚¨ä¹Ÿè¢«åˆ†å¼€éƒ¨ç½²å’Œæ”¶è´¹ã€‚è¿™ä½¿åº”ç”¨çš„å­˜å‚¨ä¸å†æ˜¯åº”ç”¨æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯æ¼”å˜æˆäº†ç‹¬ç«‹çš„äº‘æœåŠ¡ï¼Œé™ä½äº†æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚è€Œåº”ç”¨æœ¬èº«ä¹Ÿå˜æˆäº†æ— çŠ¶æ€çš„åº”ç”¨ï¼Œæ›´å®¹æ˜“è¿›è¡Œè°ƒåº¦å’Œæ‰©ç¼©å®¹ã€‚</p>
</li>
</ul>
<p>åŸºäº FaaS å’Œ BaaS ï¼Œä½ çš„åº”ç”¨å°±å®ç°äº†è‡ªåŠ¨å¼¹æ€§ä¼¸ç¼©ã€æŒ‰é‡ä»˜è´¹ã€ä¸ç”¨å…³å¿ƒæœåŠ¡å™¨ï¼Œè¿™æ­£æ˜¯ Serverless æ¶æ„çš„å¿…è¦å› ç´ ã€‚æ‰€ä»¥è¯´ç‹­ä¹‰çš„ Serverless æ˜¯ FaaS å’Œ BaaS çš„ç»„åˆã€‚</p>
<h3 id="ä¸å…¶ä»–æ¶æ„çš„åŒºåˆ«"><a href="#ä¸å…¶ä»–æ¶æ„çš„åŒºåˆ«" class="headerlink" title="ä¸å…¶ä»–æ¶æ„çš„åŒºåˆ«"></a>ä¸å…¶ä»–æ¶æ„çš„åŒºåˆ«</h3><ul>
<li>PaaS<br>  PaaS ï¼ˆå¹³å°å³æœåŠ¡ï¼‰æ˜¯äº‘è®¡ç®—è™šæ‹Ÿæœºæ—¶ä»£çš„ä¸»è¦å½¢æ€ä¹‹ä¸€ã€‚ å®ƒæ˜¯æŒ‡äº‘å‚å•†æä¾›å¼€å‘å·¥å…·ã€ä¾èµ–åº“ã€æœåŠ¡å’Œè¿è¡Œå¹³å°ç­‰èƒ½åŠ›ï¼Œå¼€å‘è€…å¯ä»¥ä¾èµ–è¿™äº›èƒ½åŠ›å°†è‡ªå·±çš„åº”ç”¨ç›´æ¥éƒ¨ç½²åœ¨äº‘å¹³å°ä¸Šï¼Œä¸ç”¨å…³å¿ƒåº•å±‚çš„è®¡ç®—èµ„æºã€ç½‘ç»œã€å­˜å‚¨ç­‰ã€‚è™½ç„¶ä¸Serverless å¾ˆç±»ä¼¼ï¼Œä½†ä¾æ—§å­˜åœ¨ä¸€äº›åŒºåˆ«ã€‚</li>
<li>Kubernetes<br>  Kubernetes æ˜¯ä¸€ç§å®¹å™¨ç¼–æ’æŠ€æœ¯ã€‚åœ¨ Kubernetes ä¸­åº”ç”¨è¿è¡Œçš„åŸºæœ¬å•ä½æ˜¯ Podï¼ˆå®¹å™¨ç»„ï¼‰ï¼ŒPod æ˜¯åº”ç”¨åŠè¿è¡Œç¯å¢ƒçš„é›†åˆï¼Œæ‰€ä»¥ä½ ä¹Ÿä¸ç”¨å…³å¿ƒæœåŠ¡å™¨äº†ã€‚åŸºäº Kubernetesï¼Œä½ èƒ½å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œ Pod çš„ç®¡ç†ï¼Œå¹¶ä¸”å®ç°åº”ç”¨çš„å¼¹æ€§ä¼¸ç¼©ã€‚<br>  æ‰€ä»¥ï¼ŒKubernetes æ˜¯ä»‹äº Serverful å’Œ Serverless ä¸­é—´çš„äº§ç‰©ã€‚</li>
</ul>
<p><strong>Serverless æ˜¯äº‘åŸç”Ÿçš„ä¸€ç§å®ç°ï¼Œäº‘åŸç”Ÿçš„å¦ä¸€ç§å®ç°æ˜¯ Kubernetesã€‚</strong></p>
<table>
<thead>
<tr>
<th align="left">Serverless</th>
<th align="left">PaaS ï¼ˆå¹³å°å³æœåŠ¡ï¼‰</th>
<th align="left">Kubernetes</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æŒ‰å®é™…ä½¿ç”¨é‡ä»˜è´¹</td>
<td align="left">æŒ‰èµ„æºä»˜è´¹</td>
<td align="left">æŒ‰ç…§èµ„æºæ•°é‡è®¡è´¹</td>
</tr>
</tbody></table>
<h3 id="Serverless-çš„ä¼˜ç¼ºç‚¹"><a href="#Serverless-çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="Serverless çš„ä¼˜ç¼ºç‚¹"></a>Serverless çš„ä¼˜ç¼ºç‚¹</h3><ul>
<li>ä¼˜ç‚¹ï¼šä¸ç”¨è¿ç»´ã€å¼¹æ€§ä¼¸ç¼©ã€èŠ‚çœæˆæœ¬ã€å¼€å‘ç®€å•ã€é™ä½é£é™©ã€æ˜“äºæ‰©å±•ã€‚</li>
<li>ç¼ºç‚¹ï¼š<ol>
<li>ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼šä¸€æ—¦ä½ é€‰æ‹©äº†ä¸€ä¸ªäº‘å‚å•†ï¼Œè¦æƒ³ä»ä¸€ä¸ªäº‘ç§»åˆ°å¦ä¸€ä¸ªå°ï¼Œæˆæœ¬å¾ˆé«˜</li>
<li>åº•å±‚ç¡¬ä»¶çš„å¤šæ ·æ€§ï¼šä»£ç ä¾èµ–çš„åœ°å±‚ç¡¬ä»¶å¤šæ ·æ€§</li>
<li>åº”ç”¨æ€§èƒ½ç“¶é¢ˆï¼šå‡½æ•°è¿è¡Œå‰éœ€è¦ç°åˆå§‹åŒ–å‡½æ•°è¿è¡Œç¯å¢ƒï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦æ¶ˆè€—ä¸€å®šæ—¶é—´ã€‚å› ä¸ºå‡½æ•°ä¸æ˜¯æŒç»­â€œåœ¨çº¿â€çš„ï¼Œè€Œæ˜¯éœ€è¦è¿è¡Œçš„æ—¶å€™æ‰å¯åŠ¨ï¼ˆä¸åƒä¼ ç»Ÿåº”ç”¨ï¼ŒæœåŠ¡æ˜¯ä¸€ç›´å¯åŠ¨çš„ï¼‰ã€‚</li>
<li>å‡½æ•°é€šä¿¡æ•ˆç‡ä½ï¼šåœ¨ Serverless åº”ç”¨ä¸­ï¼Œå‡½æ•°ä¸å‡½æ•°ä¹‹é—´å°±å®Œå…¨ç‹¬ç«‹äº†ã€‚å¦‚æœä¸¤ä¸ªå‡½æ•°çš„æ•°æ®æœ‰ä¾èµ–ï¼Œéœ€è¦è¿›è¡Œé€šä¿¡ã€äº¤æ¢æ•°æ®ï¼Œå°±è¦è¿›è¡Œå‡½æ•°ä¸å‡½æ•°ä¹‹é—´çš„è°ƒç”¨ï¼ˆè°ƒç”¨æ–¹å¼æ˜¯ HTTP è°ƒç”¨ï¼‰ã€‚ç›¸æ¯”ä¹‹å‰çš„å†…å­˜è°ƒç”¨ï¼Œæ•°æ®äº¤äº’æ•ˆç‡æ˜¾ç„¶ä½äº†å¾ˆå¤šã€‚è€Œè¿™ä¸ªé—®é¢˜çš„æœ¬è´¨ï¼Œæ˜¯ FaaS è¿˜æ²¡æœ‰æ¯”è¾ƒå¥½çš„æ•°æ®é€šä¿¡åè®®æˆ–æ–¹æ¡ˆã€‚</li>
<li>å¼€å‘è°ƒè¯•å¤æ‚ï¼šServerless æ¶æ„æ­£å¤„äºé£é€Ÿå‘å±•çš„é˜¶æ®µï¼Œå…¶å¼€å‘ã€è°ƒè¯•ã€éƒ¨ç½²å·¥å…·é“¾å¹¶ä¸å®Œå–„ï¼ˆåŸºæœ¬æ˜¯æ¯ä¸ªäº‘å‚å•†å„ç©å„çš„ï¼‰</li>
</ol>
</li>
</ul>
]]></content>
      <tags>
        <tag>serverless</tag>
      </tags>
  </entry>
  <entry>
    <title>Reacté¢å‘ç»„ä»¶è·¨å±‚çº§é€šä¿¡</title>
    <url>/2020/12/31/React%E9%9D%A2%E5%90%91%E7%BB%84%E4%BB%B6%E8%B7%A8%E5%B1%82%E7%BA%A7%E9%80%9A%E4%BF%A1/</url>
    <content><![CDATA[<h4 id="çˆ¶ä¸å­"><a href="#çˆ¶ä¸å­" class="headerlink" title="çˆ¶ä¸å­"></a>çˆ¶ä¸å­</h4><pre><code>çˆ¶ç»„ä»¶åŒ…è£¹å­ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ã€‚</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­ </span></span><br><span class="line"><span class="keyword">const</span> Button = <span class="function">(<span class="params">&#123; text &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    &lt;button type=<span class="string">"button"</span>&gt;&#123;text&#125;&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ çˆ¶</span></span><br><span class="line"><span class="regexp">class HomePage extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">state = &#123;</span></span><br><span class="line"><span class="regexp">    text: "é»˜è®¤æ–‡æ¡ˆ"</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">asyc componentDidMount() &#123;</span></span><br><span class="line"><span class="regexp">    const response = await fetch('/</span>api/buttonText<span class="string">')</span></span><br><span class="line"><span class="string">    this.setState(&#123;</span></span><br><span class="line"><span class="string">    text: response.buttoText</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">    render() &#123;</span></span><br><span class="line"><span class="string">        const &#123;</span></span><br><span class="line"><span class="string">        text</span></span><br><span class="line"><span class="string">        &#125; = this.state</span></span><br><span class="line"><span class="string">        return (</span></span><br><span class="line"><span class="string">            &lt;Button text=&#123;text&#125; /&gt;</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·çš„é€šä¿¡æ–¹å¼éå¸¸é€‚ç”¨äºå±•ç¤ºç»„ä»¶ã€‚</p>
<h4 id="å­ä¸çˆ¶"><a href="#å­ä¸çˆ¶" class="headerlink" title="å­ä¸çˆ¶"></a>å­ä¸çˆ¶</h4><pre><code>å­ç»„ä»¶å­˜åœ¨äºçˆ¶ç»„ä»¶ä¹‹ä¸­ï¼Œå­ç»„ä»¶éœ€è¦å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ã€‚</code></pre><ul>
<li>å›è°ƒå‡½æ•°ï¼ˆä¸»è¦æ–¹å¼ï¼‰</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FetchPosts</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        loading: <span class="literal">true</span>,</span><br><span class="line">        data: []</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">async</span> componentDidMount() &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">'/api/posts'</span>)</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            data: response.data,</span><br><span class="line">            loading: <span class="literal">false</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.state.loading) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Loading</span> /&gt;</span></span>  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.props.renderPosts(<span class="keyword">this</span>.state.data)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// çˆ¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        &lt;FetchPosts</span><br><span class="line">            renderPosts=&#123;posts =&gt; (</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">                &#123;posts.map(<span class="function"><span class="params">post</span> =&gt;</span> (</span><br><span class="line">                &lt;li key=&#123;post.id&#125;&gt;</span><br><span class="line">                    &lt;h2&gt;&#123;post.title&#125;&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;p&gt;&#123;post.description&#125;&lt;/</span>p&gt;</span><br><span class="line">                &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">                    ))&#125;</span></span><br><span class="line"><span class="regexp">                &lt;/u</span>l&gt;</span><br><span class="line">            )&#125;</span><br><span class="line">        /&gt;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å®ä¾‹å‡½æ•°ï¼ˆä¸ç¬¦åˆ React çš„è®¾è®¡ç†å¿µï¼Œä¸è¢«æ¨èï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">   modalRef = React.createRef()  <span class="comment">//å®ä¾‹</span></span><br><span class="line">   showModal = () =&#123;</span><br><span class="line">     <span class="keyword">this</span>.modalRef.show()</span><br><span class="line">   &#125;</span><br><span class="line">   hideModal = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">this</span>.modalRef.hide()</span><br><span class="line">   &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">          text</span><br><span class="line">        &#125; = <span class="keyword">this</span>.state</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;&gt;</span><br><span class="line">              &lt;Button onClick=&#123;<span class="keyword">this</span>.showModal&#125;&gt;å±•ç¤º Modal &lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">              &lt;Button onClick=&#123;this.hideModal&#125;&gt;éšè— Modal &lt;/</span>Button&gt;</span><br><span class="line">              &lt;Modal ref=&#123;modalRef&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">          /</span>&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å…„å¼Ÿ"><a href="#å…„å¼Ÿ" class="headerlink" title="å…„å¼Ÿ"></a>å…„å¼Ÿ</h4><p>  ä¸¤ä¸ªç»„ä»¶å¹¶åˆ—å­˜åœ¨äºçˆ¶ç»„ä»¶ä¸­ï¼Œæ•°æ®éœ€è¦è¿›è¡Œç›¸äº’ä¼ é€’ï¼Œå¾€å¾€ä¾èµ–å…±åŒçš„çˆ¶ç»„ä»¶è¿›è¡Œä¸­è½¬ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    handleChanged = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.onChangeText(e.target.text)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onChange</span>=<span class="string">&#123;handleTextChanged&#125;</span> /&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å­</span></span><br><span class="line"><span class="keyword">const</span> StaticText = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;P&gt;&#123;children&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ çˆ¶</span></span><br><span class="line"><span class="regexp">class HomePage extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">    state = &#123;</span></span><br><span class="line"><span class="regexp">        text: 'é»˜è®¤æ–‡æ¡ˆ'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    handleTextChanged = (text) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        this.setState(&#123;</span></span><br><span class="line"><span class="regexp">        text,</span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    render() &#123;</span></span><br><span class="line"><span class="regexp">        return (</span></span><br><span class="line"><span class="regexp">            &lt;&gt;</span></span><br><span class="line"><span class="regexp">              &lt;Input onChangeText=&#123;this.handleTextChanged&#125; /</span>&gt;</span><br><span class="line">              &lt;StaticText&gt;<span class="keyword">this</span>.state.text&lt;<span class="regexp">/StaticText&gt; </span></span><br><span class="line"><span class="regexp">            &lt;/</span>&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ— ç›´æ¥å…³ç³»"><a href="#æ— ç›´æ¥å…³ç³»" class="headerlink" title="æ— ç›´æ¥å…³ç³»"></a>æ— ç›´æ¥å…³ç³»</h4><p>  ä¸¤ä¸ªç»„ä»¶å¹¶æ²¡æœ‰ç›´æ¥çš„å…³è”å…³ç³»ï¼Œå¤„åœ¨ä¸€æ£µæ ‘ä¸­ç›¸è·ç”šè¿œçš„ä½ç½®ï¼Œä½†éœ€è¦å…±äº«ã€ä¼ é€’æ•°æ®ã€‚</p>
</li>
<li><p>Context<br>  Context ç¬¬ä¸€ä¸ªæœ€å¸¸è§çš„ç”¨é€”å°±æ˜¯åš i18n</p>
<ol>
<li>i18nä½¿ç”¨Context <code>I18nContext</code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  &#123; createContext &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">const</span> I18nContext = createContext(&#123;</span><br><span class="line">    translate: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">''</span>,</span><br><span class="line">    getLocale: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;,</span><br><span class="line">    setLocale: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> I18nContext;</span><br></pre></td></tr></table></figure></li>
<li>ç”¨<code>I18nContext</code>å°è£…ä¸ªç»„ä»¶<code>I18nProvider</code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> I18nContext <span class="keyword">from</span> <span class="string">'./I18nContext'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">I18nProvider</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        locale: <span class="string">''</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> i18n =  &#123;</span><br><span class="line">            translate: <span class="function"><span class="params">key</span> =&gt;</span> <span class="keyword">this</span>.props.languages[locale][key],</span><br><span class="line">            getLocale: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.state.locale,</span><br><span class="line">            setLocale: <span class="function"><span class="params">locale</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                loacal,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;I18nContext.Provider value=&#123;i18n&#125;&gt;</span><br><span class="line">                &#123;<span class="keyword">this</span>.props.children&#125;</span><br><span class="line">            &lt;<span class="regexp">/I18nContext.Provider&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default I18nProvider;</span></span><br></pre></td></tr></table></figure></li>
<li>ç”¨<code>I18nContext</code>å®ç°é«˜é˜¶ç»„ä»¶<code>withI18n</code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> I18nContext <span class="keyword">from</span> <span class="string">'./I18nContext'</span>;</span><br><span class="line"><span class="keyword">const</span> withI18n = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">WrappedComponent</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">        &lt;I18nContext.Consumer&gt;</span><br><span class="line">            &#123;i18n =&gt; <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...i18n</span>&#125; &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>&#125;</span><br><span class="line">        &lt;<span class="regexp">/I18nContext.Consumer&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">export default withI18n;</span></span><br></pre></td></tr></table></figure></li>
<li>åœ¨æœ€é¡¶å±‚æ³¨å…¥ Provider<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; I18nProvider &#125; <span class="keyword">from</span> <span class="string">'./i18n'</span>;</span><br><span class="line"><span class="keyword">const</span> locales = [ <span class="string">'en-US'</span>, <span class="string">'zh-CN'</span> ];</span><br><span class="line"><span class="keyword">const</span> languages = &#123;</span><br><span class="line">    <span class="string">'en-US'</span>: <span class="built_in">require</span>(<span class="string">'./locales/en-US'</span>),</span><br><span class="line">    <span class="string">'zh-CN'</span>: <span class="built_in">require</span>(<span class="string">'./locales/zh-CN'</span>),</span><br><span class="line">&#125;</span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;I18nProvider locales=&#123;locales&#125; languages=&#123;languages&#125;&gt;</span><br><span class="line">        &lt;App /&gt;</span><br><span class="line">    &lt;<span class="regexp">/I18nProvider&gt;,</span></span><br><span class="line"><span class="regexp">    document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure></li>
<li>åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Title = withI18n(</span><br><span class="line">    (&#123; translate &#125;) =&gt; &#123; </span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;translate('title')&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> )</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> Footer = withI18n(</span><br><span class="line">    (&#123; setLocale &#125;) =&gt; &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params"> &lt;Button onClick=((</span>) =&gt;</span> &#123;</span><br><span class="line">            setLocale(<span class="string">'zh-CN'</span>)</span><br><span class="line">        &#125;) /&gt; )</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>å…¨å±€å˜é‡<br>  å…¨å±€å˜é‡ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ”¾åœ¨ Window ä¸Šçš„å˜é‡ã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ä¿®æ”¹ Window ä¸Šçš„å˜é‡å¹¶ä¸ä¼šå¼•èµ· React ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>
</li>
<li><p>çŠ¶æ€ç®¡ç†æ¡†æ¶</p>
<ul>
<li>Flux</li>
<li>Redux</li>
<li>Mobx</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•è®¾è®¡reactç»„ä»¶</title>
    <url>/2020/12/29/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1react%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<h4 id="ç—›å®šæ€ç—›"><a href="#ç—›å®šæ€ç—›" class="headerlink" title="ç—›å®šæ€ç—›"></a>ç—›å®šæ€ç—›</h4><p>æ²¡æœ‰å¾ˆå¥½çš„è®¾è®¡æ¨¡å¼ï¼Œå†™ä»£ç å°†ä¼šå‡Œä¹±æ— åºã€‚æ²¡æœ‰æ¨¡å—åˆ’åˆ†ï¼Œä¹Ÿæ²¡æœ‰ç»„åˆçš„æ€æƒ³ã€‚</p>
<ul>
<li>æŠŠä¸€ä¸ªé¡µé¢å†™æˆä¸€ä¸ªç»„ä»¶</li>
<li>ä¸€ä¸ªç»„ä»¶æœ‰3000è¡Œä»£ç </li>
</ul>
<h4 id="åŸºäºåœºæ™¯çš„è®¾è®¡åˆ†ç±»"><a href="#åŸºäºåœºæ™¯çš„è®¾è®¡åˆ†ç±»" class="headerlink" title="åŸºäºåœºæ™¯çš„è®¾è®¡åˆ†ç±»"></a>åŸºäºåœºæ™¯çš„è®¾è®¡åˆ†ç±»</h4><p>å›´ç»•â€œå¦‚ä½•ç»„åˆâ€æ ¹æ®ä¸åŒçš„åœºæ™¯è®¾è®¡ä¸åŒæ¨¡å¼</p>
<ul>
<li><p>ç»„ä»¶çš„ç±»åˆ«</p>
<ul>
<li><p>æ— çŠ¶æ€ç»„ä»¶/å“‘ç»„ä»¶/å±•ç¤ºç»„ä»¶ï¼š åªåšå±•ç¤ºã€ç‹¬ç«‹è¿è¡Œã€ä¸é¢å¤–å¢åŠ åŠŸèƒ½çš„ç»„ä»¶</p>
<ul>
<li>ä¼˜ç‚¹ï¼š <ul>
<li>å±•ç¤ºç»„ä»¶çš„å¤ç”¨æ€§æ›´å¼ºï¼Œå¤ç”¨ç‡æ›´é«˜</li>
<li>å†…éƒ¨æ²¡æœ‰ä»»ä½•çš„stateï¼Œåªå—åˆ¶äºå¤–éƒ¨çš„propsä¼ å‚</li>
</ul>
</li>
<li>è¡ç”Ÿå‡ºçš„å…¶ä»–ç»„ä»¶è®¾è®¡<ul>
<li>ä»£ç†ç»„ä»¶ï¼šåŸºäºuiæ¡†æ¶çš„å…¶ä»–ç»„ä»¶ï¼Œå¤–é¢å°è£…ä¸€å±‚ï¼Œå®ç°ä»£ç†ç»„ä»¶ã€‚<ol>
<li>æ›´æ¢uiæ¡†æ¶æ—¶æ›´æ–¹ä¾¿ã€‚è§£å†³äº†ç»„ä»¶åº“çš„å¼ºä¾èµ–ç‰¹æ€§ï¼Œå®ç°æ— ç—›åˆ‡æ¢</li>
<li>éƒ½å†…èšåœ¨ä»£ç†ç»„ä»¶ä¸­ï¼Œä¿®æ”¹åŸºç¡€ç»„ä»¶çš„å±æ€§æ›´æ–¹ä¾¿ï¼Œä¸ä¼šæ•£è½åœ¨å„å¤„</li>
</ol>
</li>
<li>æ ·å¼ç»„ä»¶ï¼šæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ä»£ç†ç»„ä»¶ï¼Œä½†æ˜¯åˆç»†åˆ†äº†å¤„ç†æ ·å¼çš„é¢†åŸŸï¼Œå°†å½“å‰çš„å…³æ³¨ç‚¹åˆ†ç¦»åœ¨ç»„ä»¶å†…<ol>
<li>è‡ªèº«æ‰¿æ¥ä¸šåŠ¡åˆ¤æ–­é€»è¾‘ï¼Œå°è£…äº†uiåº“ä¸­çš„ç»„ä»¶æ¥æ§åˆ¶æ ·å¼ï¼Œæ”¹åŠ¨ä¼šæ›´æ–¹ä¾¿æ›´å‹å¥½</li>
</ol>
</li>
<li>å¸ƒå±€ç»„ä»¶ï¼š åŸºæœ¬è®¾è®¡ä¸æ ·å¼ç»„ä»¶å®Œå…¨ä¸€æ ·ï¼Œå¢åŠ äº†ä¸€ä¸ªå°ä¼˜åŒ–<ol>
<li>å¸ƒå±€ç»„ä»¶ä¸€èˆ¬ä¸æ ¹æ®çŠ¶æ€æ”¹å˜ï¼Œæ‰€ä»¥å¯ä»¥å°è£…å¸ƒå±€ç»„ä»¶åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>shouldComponentUpdate</code>å‡½æ•°é˜»æ–­æ¸²æŸ“ï¼Œæå‡æ€§èƒ½</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p>æœ‰çŠ¶æ€ç»„ä»¶/çµå·§ç»„ä»¶ï¼š å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®çŠ¶æ€çš„ç»„ä»¶<br>  çµå·§ç»„ä»¶æ›´ä¸“æ³¨äºä¸šåŠ¡æœ¬èº«ï¼›çµå·§ç»„ä»¶ä¸€å®šè¦è‡³å°‘åŒ…å«ä¸€ä¸ªçµå·§ç»„ä»¶æˆ–å±•ç¤ºç»„ä»¶ã€‚åŠŸèƒ½æ›´ä¸°å¯Œï¼Œä½†å¤ç”¨ç‡ä½</p>
<ul>
<li>è¡ç”Ÿå‡ºçš„å…¶ä»–ç»„ä»¶è®¾è®¡<ul>
<li>å®¹å™¨ç»„ä»¶ï¼šå‡ ä¹æ²¡æœ‰å¤ç”¨æ€§ï¼Œä¸»è¦åŠŸèƒ½åœ¨<strong>æ‹‰å–æ•°æ®</strong>å’Œ<strong>ç»„åˆç»„ä»¶</strong> </li>
<li>é«˜é˜¶ç»„ä»¶ï¼š Reactä¸­å¤ç”¨ç»„ä»¶çš„é«˜çº§æŠ€æœ¯ï¼ŒåŸºäºReactç»„åˆç‰¹æ€§å½¢æˆçš„è®¾è®¡æ¨¡å¼<ol>
<li>é“ç†ç±»ä¼¼å‡½æ•°å¼ç¼–ç¨‹çš„é«˜çº§å‡½æ•°ï¼ˆæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œé«˜é˜¶ç»„ä»¶æ¥æ”¶å‚æ•°ä¸ºç»„ä»¶ï¼Œè¿”å›å€¼ä¹Ÿæ˜¯æ–°ä¸€ä¸ªç»„ä»¶ã€‚</li>
<li>å¯æŠ½å–å…¬å…±é€»è¾‘<ul>
<li>ç™»é™†æ€çš„åˆ¤æ–­<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è£…é¥°å™¨</span></span><br><span class="line"><span class="keyword">const</span> checkLogin = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> !!localStorage.getItem(<span class="string">'token'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è£…é¥°å™¨å†™æ³•</span></span><br><span class="line">@checkLogin</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">@checkLogin</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">Â    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// é«˜é˜¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> checkLogin = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> checkLogin() ? <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span> : <span class="xml"><span class="tag">&lt;<span class="name">LoginPage</span> /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡½æ•°å†™æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RawUserPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> UserPage = checkLogin(RawUserPage)</span><br></pre></td></tr></table></figure></li>
<li>é¡µé¢åŸ‹ç‚¹ç»Ÿè®¡<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> trackPageView = (pageName) = &#123; </span><br><span class="line">    <span class="comment">// å‘é€åŸ‹ç‚¹ä¿¡æ¯è¯·æ±‚</span></span><br><span class="line">    ... </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> PV = <span class="function">(<span class="params">pageName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">Wrap</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        componentDidMount() &#123;</span><br><span class="line">            trackPageView(pageName)</span><br><span class="line">        &#125;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">            &lt;WrappedComponent &#123;...this.props&#125; /&gt;</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">@PV(<span class="string">'ç”¨æˆ·é¡µé¢'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">@PV(<span class="string">'è´­ç‰©è½¦é¡µé¢'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CartPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">@PV(<span class="string">'è®¢å•é¡µé¢'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æ—¢è¦åˆ¤æ–­ç™»é™†æ€ï¼Œåˆè¦åŸ‹ç‚¹ï¼š<strong>é“¾å¼è°ƒç”¨</strong><br>  é“¾å¼è°ƒç”¨æ˜¯å‡½æ•°å¼ç¼–ç¨‹é«˜çº§å‡½æ•°çš„ä¸€ç§ä½¿ç”¨åœºæ™¯ã€‚åœ¨é“¾å¼è°ƒç”¨åï¼Œè£…é¥°å™¨ä¼šæŒ‰ç…§ä»å¤–å‘å†…ã€ä»ä¸Šå¾€ä¸‹çš„é¡ºåºè¿›è¡Œæ‰§è¡Œã€‚  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°è°ƒç”¨æ–¹å¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RawUserPage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> UserPage = checkLogin(PV(<span class="string">'ç”¨æˆ·é¡µé¢'</span>)(RawUserPage))</span><br><span class="line"></span><br><span class="line"><span class="comment">// è£…é¥°å™¨è°ƒç”¨æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">@checkLogin</span><br><span class="line">@PV(<span class="string">'ç”¨æˆ·é¡µé¢'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>æ¸²æŸ“åŠ«æŒ<br> æ¸²æŸ“åŠ«æŒå¯ä»¥é€šè¿‡æ§åˆ¶ render å‡½æ•°ä¿®æ”¹è¾“å‡ºå†…å®¹ï¼Œå¸¸è§çš„åœºæ™¯æ˜¯æ˜¾ç¤ºåŠ è½½å…ƒç´  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withLoading</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">Â  Â  Â  Â  render() &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span>(<span class="keyword">this</span>.props.isLoading) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Loading</span> /&gt;</span></span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">super</span>.render();</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 é€šè¿‡é«˜é˜¶å‡½æ•°ä¸­ç»§æ‰¿åŸç»„ä»¶çš„æ–¹å¼ï¼ŒåŠ«æŒä¿®æ”¹ render å‡½æ•°ï¼Œç¯¡æ”¹è¿”å›ä¿®æ”¹ï¼Œè¾¾åˆ°æ˜¾ç¤º Loading çš„æ•ˆæœã€‚</li>
</ol>
</li>
<li>é«˜é˜¶ç»„ä»¶çš„ç¼ºç‚¹<ul>
<li>ä¸¢å¤±é™æ€å‡½æ•°ï¼šç”±äºè¢«åŒ…è£¹äº†ä¸€å±‚ï¼Œæ‰€ä»¥é™æ€å‡½æ•°åœ¨å¤–å±‚æ˜¯æ— æ³•è·å–çš„ã€‚  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// UserPage.jsx</span></span><br><span class="line">@PV(<span class="string">'ç”¨æˆ·é¡µé¢'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">UserPage</span> <span class="keyword">extends</span>  <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> getUser() &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// page.js</span></span><br><span class="line"><span class="keyword">import</span> UserPage <span class="keyword">from</span> <span class="string">'./UserPage'</span></span><br><span class="line">UserPage.checkLogin() <span class="comment">// è°ƒç”¨å¤±è´¥ï¼Œå¹¶ä¸å­˜åœ¨ã€‚</span></span><br></pre></td></tr></table></figure>
  <em>è§£å†³æ–¹æ¡ˆ</em>ï¼šåœ¨å¤–éƒ¨å‡½æ•°ä¸­æŠŠå†…éƒ¨å‡½æ•°çš„æ–¹æ³•å¤åˆ¶å‡ºæ¥ï¼š<code>hoist-non-react-statics</code>(ç°æˆçš„åº“)  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hoistNonReactStatics <span class="keyword">from</span> <span class="string">'hoist-non-react-statics'</span>;</span><br><span class="line"><span class="keyword">const</span> PV = <span class="function">(<span class="params">pageName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Wrap</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">            componentDidMount() &#123;</span><br><span class="line">                trackPageView(pageName)</span><br><span class="line">            &#125;</span><br><span class="line">            render() &#123;</span><br><span class="line">                <span class="keyword">return</span> (</span><br><span class="line">                &lt;WrappedComponent &#123;...this.props&#125; /&gt;</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        hoistNonReactStatics(Wrap, WrappedComponent);</span><br><span class="line">        <span class="keyword">return</span> Wrap;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>refs å±æ€§ä¸èƒ½é€ä¼ : ref å±æ€§ç”±äºè¢«é«˜é˜¶ç»„ä»¶åŒ…è£¹äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œç‰¹æ®Šå¤„ç†æ‰èƒ½è·å–ã€‚React ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåä¸º React.forwardRef çš„ API æ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Œä»¥ä¸‹æ˜¯å®˜æ–¹æ–‡æ¡£ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼š  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withLog</span>(<span class="params">Component</span>) </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">LogProps</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">            componentDidUpdate(prevProps) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'old props:'</span>, prevProps);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'new props:'</span>, <span class="keyword">this</span>.props);</span><br><span class="line">        &#125;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;forwardedRef, ...rest&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">            <span class="comment">// å°†è‡ªå®šä¹‰çš„ prop å±æ€§ â€œforwardedRefâ€ å®šä¹‰ä¸º ref</span></span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> <span class="attr">ref</span>=<span class="string">&#123;forwardedRef&#125;</span> &#123;<span class="attr">...rest</span>&#125; /&gt;</span></span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ³¨æ„ React.forwardRef å›è°ƒçš„ç¬¬äºŒä¸ªå‚æ•° â€œrefâ€ã€‚</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºå¸¸è§„ prop å±æ€§ä¼ é€’ç»™ LogPropsï¼Œä¾‹å¦‚ â€œforwardedRefâ€</span></span><br><span class="line">    <span class="comment">// ç„¶åå®ƒå°±å¯ä»¥è¢«æŒ‚è½½åˆ°è¢« LogProps åŒ…è£¹çš„å­ç»„ä»¶ä¸Šã€‚</span></span><br><span class="line">    <span class="keyword">return</span> React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">LogProps</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">forwardedRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™æ®µä»£ç è¯»èµ·æ¥ä¼šæœ‰ç‚¹å„¿å¤´çš®å‘éº»ï¼Œå®ƒæ­£ç¡®çš„é˜…è¯»é¡ºåºåº”è¯¥æ˜¯ä»æœ€åº•ä¸‹çš„ React.forwardRef éƒ¨åˆ†å¼€å§‹ï¼Œé€šè¿‡ forwardedRef è½¬å‘ ref åˆ° LogProps å†…éƒ¨ã€‚</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="æ‰€ä»¥ï¼šç»„ä»¶çš„ç›®å½•ç»“æ„"><a href="#æ‰€ä»¥ï¼šç»„ä»¶çš„ç›®å½•ç»“æ„" class="headerlink" title="æ‰€ä»¥ï¼šç»„ä»¶çš„ç›®å½•ç»“æ„"></a>æ‰€ä»¥ï¼šç»„ä»¶çš„ç›®å½•ç»“æ„</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡ç›®å½•çº§åˆ«å®Œæˆåˆ‡åˆ†</span></span><br><span class="line">    src</span><br><span class="line">    â”œâ”€â”€ components</span><br><span class="line">    â”‚   â”œâ”€â”€ basic   <span class="comment">// æœ€åŸºæœ¬çš„å±•ç¤ºç»„ä»¶æ”¾å…¥ basic ç›®å½•ä¸­ å»ºè®®ä½¿ç”¨ç±»ä¼¼ Storybook çš„å·¥å…·è¿›è¡Œç»„ä»¶ç®¡ç†ã€‚</span></span><br><span class="line">    â”‚   â”œâ”€â”€ container  <span class="comment">//å°†å®¹å™¨ç»„ä»¶æ”¾å…¥ container</span></span><br><span class="line">    â”‚   â””â”€â”€ hoc  <span class="comment">//é«˜é˜¶ç»„ä»¶æ”¾å…¥ hoc ä¸­</span></span><br><span class="line">    â””â”€â”€ pages  <span class="comment">//å°†é¡µé¢å¤–å±‚ç»„ä»¶æ”¾åœ¨é¡µé¢ç›®å½•ä¸­</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><a class="link"   href="https://storybook.js.org/"  target="_blank" rel="noopener">Storybookå®˜ç½‘<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>reactçš„ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶</title>
    <url>/2020/12/29/react%E7%9A%84%E7%B1%BB%E7%BB%84%E4%BB%B6%E5%92%8C%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p>reactçš„æœ€å°å•ä½æ˜¯ç»„ä»¶</p>
<h4 id="ç›¸åŒç‚¹"><a href="#ç›¸åŒç‚¹" class="headerlink" title="ç›¸åŒç‚¹"></a>ç›¸åŒç‚¹</h4><ul>
<li>å®é™…ç”¨é€”æ˜¯ä¸€æ ·çš„ï¼Œéƒ½å¯ä½œä¸ºåŸºç¡€ç»„ä»¶å±•ç¤ºUI</li>
<li>åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œé™¤æç«¯åœºæ™¯ä¸‹ï¼Œç±»ï¼ˆç±»ç»„ä»¶ï¼‰å’Œé—­åŒ…ï¼ˆå‡½æ•°ç»„ä»¶ï¼‰çš„æ€§èƒ½å·®å¼‚ä¸å¤§</li>
</ul>
<h4 id="åŒºåˆ«ç‚¹"><a href="#åŒºåˆ«ç‚¹" class="headerlink" title="åŒºåˆ«ç‚¹"></a>åŒºåˆ«ç‚¹</h4><ul>
<li>ä»£ç å®ç°æ€æƒ³<ul>
<li>ç±»ç»„ä»¶çš„æ ¹åŸºæ˜¯OOPï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹</li>
<li>å‡½æ•°ç»„ä»¶çš„æ ¹æ®æ˜¯FPï¼Œå‡½æ•°å¼ç¼–ç¨‹</li>
</ul>
</li>
<li>ä½¿ç”¨åœºæ™¯<ul>
<li>ç±»ç»„ä»¶ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸ</li>
<li>å‡½æ•°ç»„ä»¶ä½¿ç”¨react hookså®ç°ç±»ä¼¼ç”Ÿå‘½å‘¨æœŸçš„èƒ½åŠ›</li>
</ul>
</li>
<li>è®¾è®¡æ¨¡å¼<ul>
<li>ç±»ç»„ä»¶å¯ä»¥å®ç°ç»§æ‰¿</li>
<li>å‡½æ•°ç»„ä»¶ç¼ºå°‘ç»§æ‰¿èƒ½åŠ›<blockquote>
<p>reactå‰ç«¯æ€æƒ³ï¼šç»„åˆä¼˜äºç»§æ‰¿ï¼ˆç»§æ‰¿çš„çµæ´»æ€§å·®ï¼Œç»†èŠ‚å±è”½è¿‡å¤šï¼‰</p>
</blockquote>
</li>
</ul>
</li>
<li>æ€§èƒ½ä¼˜åŒ–<ul>
<li>ç±»ç»„ä»¶ä¾é <code>shouldComponentUpdate</code>å‡½æ•°é˜»æ–­æ¸²æŸ“</li>
<li>å‡½æ•°ç»„ä»¶ä¾é <code>React.memo()</code>æ¥ä¼˜åŒ–<blockquote>
<p>React.memo å¹¶ä¸æ˜¯é˜»æ–­æ¸²æŸ“ï¼Œè€Œæ˜¯è·³è¿‡æ¸²æŸ“ç»„ä»¶çš„æ“ä½œå¹¶ç›´æ¥å¤ç”¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“çš„ç»“æœï¼Œè¿™ä¸ shouldComponentUpdate æ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p>
</blockquote>
</li>
</ul>
</li>
<li>æœªæ¥è¶‹åŠ¿<ul>
<li>åŸºäºhooksçš„åŠ æŒï¼Œreactç¤¾åŒºä¸»æ¨<strong>å‡½æ•°ç»„ä»¶</strong></li>
</ul>
</li>
</ul>
<h4 id="ä¼˜åŠ£æ€§"><a href="#ä¼˜åŠ£æ€§" class="headerlink" title="ä¼˜åŠ£æ€§"></a>ä¼˜åŠ£æ€§</h4><ul>
<li>ç±»ç»„ä»¶<ul>
<li>thisçš„æ¨¡ç³Šæ€§</li>
<li>ä¸šåŠ¡é€»è¾‘æ•£è½åœ¨ç”Ÿå‘½å‘¨æœŸä¸­</li>
<li>ç±»ç»„ä»¶ç¼ºä¹æ ‡å‡†çš„æ‹†åˆ†æ–¹å¼</li>
</ul>
</li>
<li>å‡½æ•°ç»„ä»¶<ul>
<li>åŸºäºå‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜ç‚¹ï¼ˆè¾“å…¥è¾“å‡ºæ’å®šï¼Œæ— å‰¯ä½œç”¨ç­‰ï¼‰ï¼Œå‡½æ•°ç»„ä»¶æ›´çº¯ç²¹ã€ç®€å•ã€æ˜“æµ‹è¯•ã€‚</li>
<li>é—­åŒ…æ•è·çš„å€¼ä¼˜äºthisçš„æ¨¡ç³Šæ€§ï¼Œæ•è·çš„å€¼æ°¸è¿œæ˜¯ç¡®å®šä¸”å®‰å…¨çš„</li>
<li>æ›´ç»†è…»çš„é€»è¾‘ç»„ç»‡å’Œå¤ç”¨ï¼Œæ›´å¥½çš„ä½œç”¨äºæ—¶é—´åˆ‡ç‰‡ä¸å¹¶å‘æ¨¡å¼</li>
<li>ç”±äºå‡½æ•°ç»„ä»¶çš„æ‰§è¡Œä»æ¥éƒ½æ˜¯è‡ªé¡¶å‘ä¸‹ï¼Œä¾èµ–äº<code>dom diff</code>ç®—æ³•ä¸è‡³äºé¢‘ç¹æ¸²æŸ“</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>reactç”Ÿå‘½å‘¨æœŸçˆ¬å‘</title>
    <url>/2020/12/28/react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%88%AC%E5%9D%91/</url>
    <content><![CDATA[<p>ç”±äºå‡½æ•°å¼ç»„ä»¶ä¼šä»å¤´æ‰§è¡Œåˆ°å°¾ï¼Œæ‰€ä»¥ç”Ÿå‘½å‘¨æœŸä¸€å®šæ˜¯åœ¨è°ˆè®ºç±»ç»„ä»¶</p>
<h3 id="æ¢³ç†ç”Ÿå‘½å‘¨æœŸçš„æ—¶æœºå’ŒèŒè´£ï¼Œå»ºç«‹æ—¶æœºä¸æ“ä½œçš„å¯¹åº”å…³ç³»"><a href="#æ¢³ç†ç”Ÿå‘½å‘¨æœŸçš„æ—¶æœºå’ŒèŒè´£ï¼Œå»ºç«‹æ—¶æœºä¸æ“ä½œçš„å¯¹åº”å…³ç³»" class="headerlink" title="æ¢³ç†ç”Ÿå‘½å‘¨æœŸçš„æ—¶æœºå’ŒèŒè´£ï¼Œå»ºç«‹æ—¶æœºä¸æ“ä½œçš„å¯¹åº”å…³ç³»"></a>æ¢³ç†ç”Ÿå‘½å‘¨æœŸçš„<strong>æ—¶æœº</strong>å’Œ<strong>èŒè´£</strong>ï¼Œå»ºç«‹æ—¶æœºä¸æ“ä½œçš„å¯¹åº”å…³ç³»</h3><ul>
<li>ä½¿ç”¨æ–¹å¼ï¼ˆæ—¶æœºæ¢³ç†ï¼‰ï¼š æŒ‚è½½ï¼Œæ›´æ–°ï¼Œå¸è½½</li>
<li>é€‚ç”¨èŒƒå›´ï¼ˆèŒè´£æ¢³ç†ï¼‰ï¼šçŠ¶æ€å˜æ›´ã€é”™è¯¯å¤„ç†</li>
</ul>
<h4 id="æ—¶æœºæ¢³ç†"><a href="#æ—¶æœºæ¢³ç†" class="headerlink" title="æ—¶æœºæ¢³ç†"></a>æ—¶æœºæ¢³ç†</h4><h5 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h5><pre><code>æŒ‚è½½é˜¶æ®µæ˜¯æŒ‡ç»„ä»¶ä»åˆå§‹åŒ–åˆ°å®ŒæˆåŠ è½½çš„è¿‡ç¨‹ã€‚</code></pre><ul>
<li><p>constructor<br>  æ˜¯ç±»é€šç”¨çš„æ„é€ å‡½æ•°ï¼Œå¸¸ç”¨äºåˆå§‹åŒ–ã€‚æ‰€ä»¥åœ¨è¿‡å»ï¼Œconstructor é€šå¸¸ç”¨äºåˆå§‹åŒ– state ä¸ç»‘å®šå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Com</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">   <span class="comment">// constructor react å®˜æ–¹å¼ƒç”¨</span></span><br><span class="line">   <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">      <span class="keyword">super</span>(props)   </span><br><span class="line">      <span class="keyword">this</span>.state = &#123;<span class="attr">count</span>: <span class="number">0</span>&#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>getDerivedStateFromProps</p>
<ul>
<li>å½“propsè¢«ä¼ å…¥</li>
<li>stateå‘ç”Ÿå˜åŒ–æ—¶</li>
<li>fouceUpdateè¢«è°ƒç”¨<blockquote>
<p>æœ€å¸¸è§çš„ä¸€ä¸ªé”™è¯¯æ˜¯è®¤ä¸ºåªæœ‰ props å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒgetDerivedStateFromProps æ‰ä¼šè¢«è°ƒç”¨ï¼Œè€Œå®é™…ä¸Šåªè¦çˆ¶çº§ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼ŒgetDerivedStateFromProps å°±ä¼šè¢«è°ƒç”¨ã€‚æ‰€ä»¥æ˜¯å¤–éƒ¨å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ props ä¼ å…¥æ—¶å°±ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä½ å¯èƒ½ä¸éœ€è¦ä½¿ç”¨æ´¾ç”Ÿ state</p>
</blockquote>
</li>
</ul>
</li>
<li><p>UNSAFE_componentWillMount(componentWillMount)<br>  ç”¨äºç»„ä»¶åŠ è½½å‰åšæŸäº›æ“ä½œ<br>  å› åœ¨Reactçš„å¼‚æ­¥æ¸²æŸ“æœºåˆ¶ä¸‹ï¼Œä¼šè¢«å¤šæ¬¡è°ƒç”¨ã€‚reactå¼ƒç”¨<br>  egï¼šåŒæ„æ—¶ï¼Œåœ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯åŒæ—¶å‘èµ·è¯·æ±‚æ‹‰å–æ•°æ®ï¼Œä¼šåˆ†åˆ«è¢«æ‰§è¡Œä¸€æ¬¡</p>
</li>
<li><p>render çº¯å‡½æ•°  è¿”å›jsxè§£æ„ï¼Œæè¿°æ¸²æŸ“å†…å®¹</p>
</li>
<li><p>componentDidMount<br>  ç»„ä»¶åŠ è½½å®Œæˆæ—¶åšæŸäº›æ“ä½œï¼Œç”¨äºå‘èµ·è¯·æ±‚</p>
</li>
</ul>
<h5 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h5><pre><code>æ›´æ–°é˜¶æ®µæ˜¯æŒ‡å¤–éƒ¨ props ä¼ å…¥ï¼Œæˆ–è€… state å‘ç”Ÿå˜åŒ–æ—¶çš„é˜¶æ®µã€‚</code></pre><ul>
<li><p>UNSAFE_componentWillReceiveProps<br>  è¢«æ ‡è®°å¼ƒç”¨ï¼Œå› ä¸ºå…¶åŠŸèƒ½å¯è¢«å‡½æ•° getDerivedStateFromProps æ‰€æ›¿ä»£ã€‚</p>
</li>
<li><p>getDerivedStateFromProps<br>  åŒæŒ‚è½½é˜¶æ®µçš„è¡¨ç°ä¸€è‡´ã€‚</p>
</li>
<li><p>shouldComponentUpdate<br>  è¯¥æ–¹æ³•é€šè¿‡è¿”å› true æˆ–è€… false æ¥ç¡®å®šæ˜¯å¦éœ€è¦è§¦å‘æ–°çš„æ¸²æŸ“ã€‚å› ä¸ºæ¸²æŸ“è§¦å‘æœ€åä¸€é“å…³å¡ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯æ€§èƒ½ä¼˜åŒ–çš„å¿…äº‰ä¹‹åœ°ã€‚é€šè¿‡æ·»åŠ åˆ¤æ–­æ¡ä»¶æ¥é˜»æ­¢ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</p>
<p>  React å®˜æ–¹æä¾›äº†ä¸€ä¸ªé€šç”¨çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ PureComponentã€‚PureComponent çš„æ ¸å¿ƒåŸç†å°±æ˜¯é»˜è®¤å®ç°äº†shouldComponentUpdateå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­å¯¹ props å’Œ state è¿›è¡Œæµ…æ¯”è¾ƒï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦è§¦å‘æ›´æ–°ã€‚ </p>
</li>
<li><p>UNSAFE_componentWillUpdate<br>  åŒæ ·å·²åºŸå¼ƒï¼Œå› ä¸ºåç»­çš„ React å¼‚æ­¥æ¸²æŸ“è®¾è®¡ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ç»„ä»¶æš‚åœæ›´æ–°æ¸²æŸ“çš„æƒ…å†µã€‚</p>
</li>
<li><p>render<br>  åŒæŒ‚è½½é˜¶æ®µçš„è¡¨ç°ä¸€è‡´ã€‚</p>
</li>
<li><p>getSnapshotBeforeUpdate<br>  getSnapshotBeforeUpdate æ–¹æ³•æ˜¯é…åˆ React æ–°çš„å¼‚æ­¥æ¸²æŸ“çš„æœºåˆ¶ï¼Œåœ¨ DOM æ›´æ–°å‘ç”Ÿå‰è¢«è°ƒç”¨ï¼Œè¿”å›å€¼å°†ä½œä¸º componentDidUpdate çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScrollingList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">Â    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    Â  Â  <span class="keyword">super</span>(props);</span><br><span class="line">    Â  Â  <span class="keyword">this</span>.listRef = React.createRef();</span><br><span class="line">Â    &#125;</span><br><span class="line">Â </span><br><span class="line">Â    getSnapshotBeforeUpdate(prevProps, prevState) &#123;</span><br><span class="line">Â  Â      <span class="comment">// Are we adding new items to the list?</span></span><br><span class="line">Â  Â      <span class="comment">// Capture the scroll position so we can adjust scroll later.</span></span><br><span class="line">    Â  Â  <span class="keyword">if</span> (prevProps.list.length &lt; <span class="keyword">this</span>.props.list.length) &#123;</span><br><span class="line">    Â  Â  Â    <span class="keyword">const</span> list = <span class="keyword">this</span>.listRef.current;</span><br><span class="line">    Â  Â  Â    <span class="keyword">return</span> list.scrollHeight - list.scrollTop;</span><br><span class="line">    Â  Â  &#125;</span><br><span class="line">    Â  Â  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">Â    &#125;</span><br><span class="line">Â </span><br><span class="line">Â    componentDidUpdate(prevProps, prevState, snapshot) &#123;</span><br><span class="line">Â  Â      <span class="comment">// If we have a snapshot value, we've just added new items.</span></span><br><span class="line">Â  Â      <span class="comment">// Adjust scroll so these new items don't push the old ones out of view.</span></span><br><span class="line">Â  Â      <span class="comment">// (snapshot here is the value returned from getSnapshotBeforeUpdate)</span></span><br><span class="line">Â  Â      <span class="keyword">if</span> (snapshot !== <span class="literal">null</span>) &#123;</span><br><span class="line">Â  Â  Â        <span class="keyword">const</span> list = <span class="keyword">this</span>.listRef.current;</span><br><span class="line">Â  Â  Â        list.scrollTop = list.scrollHeight - snapshot;</span><br><span class="line">Â  Â      &#125;</span><br><span class="line">Â    &#125;</span><br><span class="line">Â </span><br><span class="line">Â    render() &#123;</span><br><span class="line">Â  Â      <span class="keyword">return</span> (</span><br><span class="line">Â  Â  Â        &lt;div ref=&#123;<span class="keyword">this</span>.listRef&#125;&gt;&#123;<span class="comment">/* ...contents... */</span>&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">Â  Â      );</span></span><br><span class="line"><span class="regexp">Â    &#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p>componentDidUpdate<br>  æ­£å¦‚ä¸Šé¢çš„æ¡ˆä¾‹ï¼ŒgetSnapshotBeforeUpdate çš„è¿”å›å€¼ä¼šä½œä¸ºcomponentDidUpdateçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h5 id="å¸è½½é˜¶æ®µ"><a href="#å¸è½½é˜¶æ®µ" class="headerlink" title="å¸è½½é˜¶æ®µ"></a>å¸è½½é˜¶æ®µ</h5><ul>
<li>componentWillUnmount<br>  å¸è½½é˜¶æ®µå”¯ä¸€çš„å›è°ƒå‡½æ•°ã€‚<br>  è¯¥å‡½æ•°ä¸»è¦ç”¨äºæ‰§è¡Œæ¸…ç†å·¥ä½œã€‚ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ Bug å°±æ˜¯å¿˜è®°åœ¨ componentWillUnmount ä¸­å–æ¶ˆå®šæ—¶å™¨ï¼Œå¯¼è‡´å®šæ—¶æ“ä½œä¾ç„¶åœ¨ç»„ä»¶é”€æ¯åä¸åœåœ°æ‰§è¡Œã€‚æ‰€ä»¥ä¸€å®šè¦åœ¨è¯¥é˜¶æ®µè§£é™¤äº‹ä»¶ç»‘å®šï¼Œå–æ¶ˆå®šæ—¶å™¨ã€‚</li>
</ul>
<h4 id="èŒè´£æ¢³ç†"><a href="#èŒè´£æ¢³ç†" class="headerlink" title="èŒè´£æ¢³ç†"></a>èŒè´£æ¢³ç†</h4><p>å¦‚æœæˆ‘ä»¬çš„ React åº”ç”¨è¶³å¤Ÿå¤æ‚ã€æ¸²æŸ“å±‚çº§è¶³å¤Ÿæ·±æ—¶ï¼Œä¸€æ¬¡é‡æ–°æ¸²æŸ“ï¼Œå°†ä¼šæ¶ˆè€—éå¸¸é«˜çš„æ€§èƒ½ï¼Œå¯¼è‡´å¡é¡¿ç­‰é—®é¢˜ã€‚<br>å…³é”®ç‚¹ï¼š</p>
<ol>
<li>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚</li>
<li>æ¸²æŸ“ä¸­å‘ç”ŸæŠ¥é”™åä¼šæ€æ ·ï¼Ÿåˆè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</li>
</ol>
<hr>
<ul>
<li>å‡½æ•°ç»„ä»¶</li>
</ul>
<p>å‡½æ•°ç»„ä»¶ä»»ä½•æƒ…å†µä¸‹éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚<br>å®˜æ–¹æä¾›äº†ä¸€ç§æ–¹å¼ä¼˜åŒ–æ‰‹æ®µï¼Œé‚£å°±æ˜¯ React.memoã€‚<br>React.memo å¹¶ä¸æ˜¯é˜»æ–­æ¸²æŸ“ï¼Œè€Œæ˜¯è·³è¿‡æ¸²æŸ“ç»„ä»¶çš„æ“ä½œå¹¶ç›´æ¥å¤ç”¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“çš„ç»“æœï¼Œè¿™ä¸ shouldComponentUpdate æ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MyComponent = React.memo(<span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">Â  <span class="comment">/* ä½¿ç”¨ props æ¸²æŸ“ */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>React.Component<br>  å¦‚æœä¸å®ç° shouldComponentUpdate å‡½æ•°ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§æƒ…å†µè§¦å‘é‡æ–°æ¸²æŸ“ã€‚</p>
<ol>
<li>å½“ state å‘ç”Ÿå˜åŒ–æ—¶ã€‚è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œæ˜¯å¸¸è§çš„æƒ…å†µã€‚</li>
<li>å½“çˆ¶çº§ç»„ä»¶çš„ Props ä¼ å…¥æ—¶ã€‚æ— è®º Props æœ‰æ²¡æœ‰å˜åŒ–ï¼Œåªè¦ä¼ å…¥å°±ä¼šå¼•å‘é‡æ–°æ¸²æŸ“ã€‚</li>
</ol>
</li>
<li><p>React.PureComponent<br>  PureComponent é»˜è®¤å®ç°äº† shouldComponentUpdate å‡½æ•°ã€‚æ‰€ä»¥ä»…åœ¨ props ä¸ state è¿›è¡Œæµ…æ¯”è¾ƒåï¼Œç¡®è®¤æœ‰å˜æ›´æ—¶æ‰ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚</p>
</li>
<li><p>é”™è¯¯è¾¹ç•Œ<br>é”™è¯¯è¾¹ç•Œæ˜¯ä¸€ç§ React ç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶å¯ä»¥æ•è·å¹¶æ‰“å°å‘ç”Ÿåœ¨å…¶å­ç»„ä»¶æ ‘ä»»ä½•ä½ç½®çš„ JavaScript é”™è¯¯ï¼Œå¹¶ä¸”ï¼Œå®ƒä¼šæ¸²æŸ“å‡ºå¤‡ç”¨ UIï¼Œå¦‚ä¸‹ React å®˜æ–¹æ‰€ç»™çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">Â  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">Â  Â  <span class="keyword">super</span>(props);</span><br><span class="line">Â  Â  <span class="keyword">this</span>.state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">Â  &#125;</span><br><span class="line">Â  <span class="keyword">static</span> getDerivedStateFromError(error) &#123;</span><br><span class="line">Â  Â  <span class="comment">// æ›´æ–° state ä½¿ä¸‹ä¸€æ¬¡æ¸²æŸ“èƒ½å¤Ÿæ˜¾ç¤ºé™çº§åçš„ UI</span></span><br><span class="line">Â  Â  <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">Â  &#125;</span><br><span class="line">Â  componentDidCatch(error, errorInfo) &#123;</span><br><span class="line">Â  Â  <span class="comment">// ä½ åŒæ ·å¯ä»¥å°†é”™è¯¯æ—¥å¿—ä¸ŠæŠ¥ç»™æœåŠ¡å™¨</span></span><br><span class="line">Â  Â  logErrorToMyService(error, errorInfo);</span><br><span class="line">Â  &#125;</span><br><span class="line">Â  render() &#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">Â  Â  Â  <span class="comment">// ä½ å¯ä»¥è‡ªå®šä¹‰é™çº§åçš„ UI å¹¶æ¸²æŸ“</span></span><br><span class="line">Â  Â  Â  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Something went wrong.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">return</span> <span class="keyword">this</span>.props.children;Â </span><br><span class="line">Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ— è®ºæ˜¯ Reactï¼Œè¿˜æ˜¯ React Nativeï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯è¾¹ç•Œï¼Œåœ¨ç”¨æˆ·ä¾§çœ‹åˆ°çš„ç°è±¡ä¼šæ˜¯è¿™æ ·çš„ï¼šåœ¨æ‰§è¡ŒæŸä¸ªæ“ä½œæ—¶ï¼Œè§¦å‘äº† Bugï¼Œå¼•å‘äº†å´©æºƒï¼Œé¡µé¢çªç„¶ç™½å±ã€‚<br>ä½†æ¸²æŸ“æ—¶çš„æŠ¥é”™ï¼Œåªèƒ½é€šè¿‡ componentDidCatch æ•è·ã€‚è¿™æ˜¯åœ¨åšçº¿ä¸Šé¡µé¢æŠ¥é”™ç›‘æ§æ—¶ï¼Œæå…¶å®¹æ˜“å¿½ç•¥çš„ç‚¹å„¿ã€‚</p>
</li>
</ul>
<h4 id="å‘"><a href="#å‘" class="headerlink" title="å‘"></a>å‘</h4><ul>
<li>åœ¨ä¸æ°å½“çš„æ—¶æœºè°ƒç”¨ä¸åˆé€‚çš„ä»£ç </li>
<li>åœ¨éœ€è¦è°ƒç”¨æ—¶ï¼Œå¿˜è®°äº†è°ƒç”¨</li>
</ul>
<p>ä»¥ä¸‹æƒ…å†µå®¹æ˜“é€ æˆç”Ÿå‘½å‘¨æœŸçš„å‘</p>
<ol>
<li><p>getDerivedStateFromProps å®¹æ˜“ç¼–å†™åæ¨¡å¼ä»£ç ï¼Œä½¿å—æ§ç»„ä»¶ä¸éå—æ§ç»„ä»¶åŒºåˆ†æ¨¡ç³Šã€‚</p>
</li>
<li><p>componentWillMount åœ¨ React ä¸­å·²è¢«æ ‡è®°å¼ƒç”¨ï¼Œä¸æ¨èä½¿ç”¨ï¼Œä¸»è¦åŸå› æ˜¯æ–°çš„å¼‚æ­¥æ¸²æŸ“æ¶æ„ä¼šå¯¼è‡´å®ƒè¢«å¤šæ¬¡è°ƒç”¨ã€‚æ‰€ä»¥ç½‘ç»œè¯·æ±‚åŠäº‹ä»¶ç»‘å®šä»£ç åº”ç§»è‡³ componentDidMount ä¸­ã€‚</p>
</li>
<li><p>componentWillReceiveProps åŒæ ·è¢«æ ‡è®°å¼ƒç”¨ï¼Œè¢« getDerivedStateFromProps æ‰€å–ä»£ï¼Œä¸»è¦åŸå› æ˜¯æ€§èƒ½é—®é¢˜ã€‚</p>
</li>
<li><p>shouldComponentUpdate é€šè¿‡è¿”å› true æˆ–è€… false æ¥ç¡®å®šæ˜¯å¦éœ€è¦è§¦å‘æ–°çš„æ¸²æŸ“ã€‚ä¸»è¦ç”¨äºæ€§èƒ½ä¼˜åŒ–ã€‚</p>
</li>
<li><p>componentWillUpdate åŒæ ·æ˜¯ç”±äºæ–°çš„å¼‚æ­¥æ¸²æŸ“æœºåˆ¶ï¼Œè€Œè¢«æ ‡è®°åºŸå¼ƒï¼Œä¸æ¨èä½¿ç”¨ï¼ŒåŸå…ˆçš„é€»è¾‘å¯ç»“åˆ getSnapshotBeforeUpdate ä¸ componentDidUpdate æ”¹é€ ä½¿ç”¨ã€‚</p>
</li>
<li><p>å¦‚æœåœ¨ componentWillUnmount å‡½æ•°ä¸­å¿˜è®°è§£é™¤äº‹ä»¶ç»‘å®šï¼Œå–æ¶ˆå®šæ—¶å™¨ç­‰æ¸…ç†æ“ä½œï¼Œå®¹æ˜“å¼•å‘ bugã€‚</p>
</li>
<li><p>å¦‚æœæ²¡æœ‰æ·»åŠ é”™è¯¯è¾¹ç•Œå¤„ç†ï¼Œå½“æ¸²æŸ“å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œç”¨æˆ·å°†ä¼šçœ‹åˆ°ä¸€ä¸ªæ— æ³•æ“ä½œçš„ç™½å±ï¼Œæ‰€ä»¥ä¸€å®šè¦æ·»åŠ ã€‚</p>
</li>
</ol>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ å¯èƒ½ä¸éœ€è¦ä½¿ç”¨æ´¾ç”Ÿstate</title>
    <url>/2020/12/28/%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E6%B4%BE%E7%94%9Fstate/</url>
    <content><![CDATA[<p><a class="link"   href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html"  target="_blank" rel="noopener">ä½ å¯èƒ½ä¸éœ€è¦ä½¿ç”¨æ´¾ç”Ÿstate<i class="fas fa-external-link-alt"></i></a></p>
<p>æ–‡ä¸­åˆ—ä¸¾äº†ä¸¤ç§åæ¨¡å¼çš„ä½¿ç”¨æ–¹å¼</p>
<ul>
<li>ç›´æ¥å¤åˆ¶propåˆ°state</li>
<li>åœ¨propså˜åŒ–åä¿®æ”¹state</li>
</ul>
<p>è¿™ä¸¤ç§ä½¿ç”¨æ–¹å¼é™¤äº†å¢åŠ ä»£ç çš„ç»´æŠ¤æˆæœ¬å¤–ï¼Œæ²¡æœ‰ä»»ä½•çš„å¥½å¤„</p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackä¼˜åŒ–ä¹‹ä»£ç åˆ†å‰²splitChunck</title>
    <url>/2020/12/21/webpack%E4%BC%98%E5%8C%96%E4%B9%8B%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2/</url>
    <content><![CDATA[<h4 id="ä»£ç åˆ†å‰²"><a href="#ä»£ç åˆ†å‰²" class="headerlink" title="ä»£ç åˆ†å‰²"></a>ä»£ç åˆ†å‰²</h4><ul>
<li>splitChunck</li>
<li>åŠ¨æ€å¼•ç”¨<ul>
<li>é€‚ç”¨åœºæ™¯ï¼šæŠ½ç¦»ç›¸åŒä»£ç åˆ°ä¸€ä¸ªå…±äº«å—</li>
<li>è„šæœ¬æ‡’åŠ è½½ï¼Œä½¿å¾—åˆå§‹ä¸‹è½½ä»£ç æ›´å°</li>
</ul>
</li>
<li>æ‡’åŠ è½½JSè„šæœ¬æ–¹å¼<ul>
<li>CommonJS: require.ensure</li>
<li>ES6: åŠ¨æ€importï¼ˆéœ€è¦babelæ”¯æŒï¼Œ@babel/plugin-syntax-dynamic-import)</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é…ç½®.babelrc</span></span><br><span class="line"><span class="string">"plugins"</span>: [</span><br><span class="line">    [<span class="string">"@babel/plugin-syntax-dynamic-import"</span>],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>distä»£ç é€šè¿‡window[â€˜webpackJsonpâ€™]æ¥è·å–å¯¹åº”è„šæœ¬</p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackä¼˜åŒ–ä¹‹Scope Hoisting</title>
    <url>/2020/12/21/webpack%E4%BC%98%E5%8C%96%E4%B9%8BScopeHoisting/</url>
    <content><![CDATA[<h4 id="webpackæ‰“åŒ…ç°è±¡"><a href="#webpackæ‰“åŒ…ç°è±¡" class="headerlink" title="webpackæ‰“åŒ…ç°è±¡"></a>webpackæ‰“åŒ…ç°è±¡</h4><p>webpackæ„å»ºåçš„ä»£ç å­˜åœ¨å¤§é‡çš„é—­åŒ…ä»£ç </p>
<ul>
<li>å¤§é‡å‡½æ•°é—­åŒ…åŒ…è£¹ä»£ç ï¼Œå¯¼è‡´ä½“ç§¯å¢å¤§(æ¨¡å—è¶Šå¤šè¶Šæ˜æ˜¾)</li>
<li>è¿è¡Œä»£ç æ—¶åˆ›å»ºçš„å‡½æ•°ä½œç”¨åŸŸå˜å¤šï¼Œå†…å­˜å¼€é”€å˜å¤§</li>
<li>è¢«webpackè½¬æ¢åçš„æ¨¡å—ä¼šå¸¦ä¸Šä¸€å±‚åŒ…è£¹ï¼Œimportä¼šè¢«è½¬æ¢æˆ<strong>webpack_require</strong></li>
</ul>
<h4 id="Scope-HoistingåŸç†"><a href="#Scope-HoistingåŸç†" class="headerlink" title="Scope HoistingåŸç†"></a>Scope HoistingåŸç†</h4><ul>
<li>å°†æ‰€æœ‰æ¨¡å—çš„ä»£ç æŒ‰ç…§å¼•ç”¨é¡ºåºæ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œç„¶åé€‚å½“çš„é‡å‘½åä¸€äº›å˜é‡ä»¥é˜²æ­¢å˜é‡åå†²çª</li>
<li>å¯¹æ¯”ï¼Œé€šè¿‡scope hoisting å¯ä»¥å‡å°‘å‡½æ•°å£°æ˜ä»£ç å’Œå†…å­˜å¼€é”€</li>
</ul>
<h4 id="å¼€å¯scope-hoisting"><a href="#å¼€å¯scope-hoisting" class="headerlink" title="å¼€å¯scope hoisting"></a>å¼€å¯scope hoisting</h4><ul>
<li>webpack4 mode ä¸º productioné»˜è®¤å¼€å¯ï¼Œå¿…é¡»æ˜¯ES6è¯­æ³•ï¼ŒcommonJSä¸æ”¯æŒ</li>
<li>webpack3 å¢åŠ æ’ä»¶ new webpack.optimize.ModuleConcatenationPlugin()</li>
</ul>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackä¼˜åŒ–ä¹‹tree-shaking</title>
    <url>/2020/12/21/webpack%E4%BC%98%E5%8C%96%E4%B9%8BTreeShaking/</url>
    <content><![CDATA[<h4 id="tree-shaking"><a href="#tree-shaking" class="headerlink" title="tree-shaking"></a>tree-shaking</h4><ul>
<li>é™æ€åˆ†æï¼Œä¸æ˜¯åŠ¨æ€åˆ†æ</li>
<li>ä»£ç ä¸ä¼šè¢«æ‰§è¡Œåˆ°ï¼Œå°±ä¸ä¼šæ‰“åŒ…åˆ°bound.js</li>
<li>å¿…é¡»ä½¿ç”¨ES6çš„è¯­æ³•(importã€export)æ‰æ”¯æŒtree-shakingï¼Œcommonjsæ–¹å¼ä¸æ”¯æŒ</li>
<li>webpcké»˜è®¤æ”¯æŒï¼Œåœ¨.babelrcé‡Œé¢è®¾ç½® modules: falseå³å¯ï¼ŒåŒæ—¶mode=productioné»˜è®¤å¼€å¯</li>
</ul>
<h4 id="tree-shakingåŸç†"><a href="#tree-shakingåŸç†" class="headerlink" title="tree-shakingåŸç†"></a>tree-shakingåŸç†</h4><ul>
<li>åªèƒ½ä½œä¸ºæ¨¡å—é¡¶å±‚çš„è¯­å¥å‡ºç°</li>
<li>importçš„æ¨¡å—åªèƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡   export function() {}</li>
<li>import binding æ˜¯ immutable çš„</li>
</ul>
<p>ä»£ç æ“¦é™¤: uglifyé˜¶æ®µåˆ é™¤æ— ç”¨ä»£ç </p>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4&amp;&amp;ESlint</title>
    <url>/2020/12/15/webpack4&amp;&amp;ESlint/</url>
    <content><![CDATA[<h4 id="ESlint"><a href="#ESlint" class="headerlink" title="ESlint"></a>ESlint</h4><p>ESLintæ˜¯ä¸€ä¸ªç”¨æ¥è¯†åˆ«ECMAScript å¹¶ä¸”æŒ‰ç…§è§„åˆ™ç»™å‡ºæŠ¥å‘Šçš„ä»£ç æ£€æµ‹å·¥å…·ï¼Œä½¿ç”¨å®ƒå¯ä»¥é¿å…ä½çº§é”™è¯¯å’Œç»Ÿä¸€ä»£ç çš„é£æ ¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//.eslint.js</span></span><br><span class="line"><span class="comment">// åŒºåˆ†ç”Ÿäº§ç¯å¢ƒã€å¼€å‘ç¯å¢ƒ</span></span><br><span class="line"><span class="keyword">const</span> _mode = process.env.NODE_ENV || <span class="string">'production'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">"env"</span>: &#123;</span><br><span class="line">        <span class="string">"browser"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"es6"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"node"</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"globals"</span>: &#123;</span><br><span class="line">        <span class="string">"$"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"process"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"dirname"</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</span><br><span class="line">    <span class="string">"extends"</span>: <span class="string">"eslint:recommended"</span>,</span><br><span class="line">    <span class="string">"parserOptions"</span>: &#123;</span><br><span class="line">        <span class="string">"ecmaFeatures"</span>: &#123;</span><br><span class="line">            <span class="string">"jsx"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">"legacyDecorators"</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"ecmaVersion"</span>: <span class="number">2018</span>,</span><br><span class="line">        <span class="string">"sourceType"</span>: <span class="string">"module"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"plugins"</span>: [</span><br><span class="line">        <span class="string">"react"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"rules"</span>: &#123;</span><br><span class="line">        <span class="string">"no-console"</span>: <span class="string">"off"</span>,</span><br><span class="line">        <span class="string">"no-debugger"</span>: _mode===<span class="string">'development'</span> ? <span class="number">0</span> : <span class="number">2</span>,</span><br><span class="line">        <span class="string">"no-alert"</span>: _mode===<span class="string">'development'</span> ? <span class="number">0</span> : <span class="number">2</span>,</span><br><span class="line">        <span class="comment">// "no-multi-spaces": "error",</span></span><br><span class="line">        <span class="string">"no-unused-vars"</span>: <span class="string">"off"</span>, <span class="comment">// reactä¸­ä¸é€‚ç”¨</span></span><br><span class="line">        <span class="string">"no-constant-condition"</span>: <span class="string">"off"</span>,</span><br><span class="line">        <span class="string">"no-fallthrough"</span>: <span class="string">"off"</span>,</span><br><span class="line">        <span class="comment">// "keyword-spacing": ["error", &#123; "before": true&#125; ], // ä¸ç”Ÿæ•ˆï¼Œå…ˆæ³¨é‡Š</span></span><br><span class="line">        <span class="comment">// "indent": [</span></span><br><span class="line">        <span class="comment">//  "error",</span></span><br><span class="line">        <span class="comment">//  2</span></span><br><span class="line">        <span class="comment">// ],</span></span><br><span class="line">        <span class="string">"linebreak-style"</span>: [</span><br><span class="line">        <span class="string">"error"</span>,</span><br><span class="line">        <span class="string">"unix"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">// "quotes": [</span></span><br><span class="line">        <span class="comment">//  "error",</span></span><br><span class="line">        <span class="comment">//  "single"</span></span><br><span class="line">        <span class="comment">// ],</span></span><br><span class="line">        <span class="string">"semi"</span>: [<span class="number">0</span>],</span><br><span class="line">        <span class="string">"no-unexpected-multiline"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"no-class-assign"</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="æ£€æŸ¥eslint"><a href="#æ£€æŸ¥eslint" class="headerlink" title="æ£€æŸ¥eslint"></a>æ£€æŸ¥eslint</h4><ul>
<li>æ–¹å¼ä¸€: å®‰è£…huskyï¼Œå¢åŠ npm scriptï¼Œé€‚åˆè€é¡¹ç›®</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="comment">//"precommit": "eslint --ext .js --ext .jsx src/",</span></span><br><span class="line">    <span class="string">"precommit"</span>: <span class="string">"eslint lint-staged"</span>, <span class="comment">// å¢é‡æ£€æŸ¥ä¿®æ”¹çš„æ–‡ä»¶  </span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">"lint-staged"</span>: &#123;</span><br><span class="line">    <span class="comment">//"src/**/*.js": [</span></span><br><span class="line">    <span class="comment">//  "eslint --ext .js --ext .jsx",</span></span><br><span class="line">    <span class="comment">//  "git add"</span></span><br><span class="line">    <span class="comment">//]</span></span><br><span class="line">    <span class="string">"linters"</span>: &#123;</span><br><span class="line">        <span class="string">"*.[js,scss]"</span>: [<span class="string">"eslint --fix"</span>, <span class="string">"git add"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹å¼äºŒï¼šwebpackä¸eslintç»“åˆï¼Œæ–°é¡¹ç›®</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: [<span class="string">'babel-loader'</span>, <span class="string">'eslint-loader'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶å®æ–°é¡¹ç›®ä¸­ï¼Œå¯ä»¥å°†ä¸¤ç§æ–¹å¼åŒæ—¶ä½¿ç”¨</p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4å®šä½æºä»£ç source-map</title>
    <url>/2020/12/15/webpack4%E5%AE%9A%E4%BD%8D%E6%BA%90%E4%BB%A3%E7%A0%81source-map/</url>
    <content><![CDATA[<h4 id="å®šä½æºä»£ç "><a href="#å®šä½æºä»£ç " class="headerlink" title="å®šä½æºä»£ç "></a>å®šä½æºä»£ç </h4><ul>
<li><p>é€šè¿‡ source-map å®šä½åˆ°æºä»£ç </p>
</li>
<li><p>å¼€å‘ç¯å¢ƒï¼šå»ºè®®ä½¿ç”¨</p>
<ul>
<li>é¦–å…ˆåœ¨æºä»£ç çš„åˆ—ä¿¡æ¯æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œåªè¦æœ‰è¡Œä¿¡æ¯å°±èƒ½å®Œæ•´çš„å»ºç«‹æ‰“åŒ…å‰åä»£ç ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚å› æ­¤ä¸ç®¡æ˜¯å¼€å‘ç¯å¢ƒè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©å¢åŠ cheapåŸºæœ¬ç±»å‹æ¥å¿½ç•¥æ¨¡å—æ‰“åŒ…å‰åçš„åˆ—ä¿¡æ¯å…³è”ã€‚</li>
<li>å…¶æ¬¡ï¼Œä¸ç®¡åœ¨ç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯å¼€å‘ç¯å¢ƒï¼Œæˆ‘ä»¬éƒ½éœ€è¦å®šä½debugåˆ°æœ€æœ€åŸå§‹çš„èµ„æºï¼Œæ¯”å¦‚å®šä½é”™è¯¯åˆ°jsxï¼ŒcoffeeScriptçš„åŸå§‹ä»£ç å¤„ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æˆjsçš„ä»£ç å¤„ï¼Œå› æ­¤ï¼Œä¸èƒ½å¿½ç•¥moduleå±æ€§</li>
<li>å†æ¬¡æˆ‘ä»¬å¸Œæœ›é€šè¿‡ç”Ÿæˆ.mapæ–‡ä»¶çš„å½¢å¼ï¼Œå› æ­¤è¦å¢åŠ source-mapå±æ€§</li>
</ul>
</li>
<li><p>çº¿ä¸Šç¯å¢ƒå…³é—­</p>
</li>
<li><p>evalï¼šä½¿ç”¨<code>eval</code>åŒ…è£¹æ¨¡å—ä»£ç </p>
</li>
<li><p>cheapï¼šä¸åŒ…å«åˆ—ä¿¡æ¯</p>
</li>
<li><p>inlineï¼šå°†.mapä½œä¸ºDataURIåµŒå…¥ï¼Œä¸å•ç‹¬ç”Ÿæˆ.mapæ–‡ä»¶</p>
</li>
<li><p>moduleï¼šåŒ…å«loaderçš„source</p>
</li>
<li><p>source-map ç±»å‹</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">devtool</th>
<th align="left">é¦–æ¬¡æ„å»º</th>
<th align="left">äºŒæ¬¡æ„å»º</th>
<th align="left">æ˜¯å¦é€‚åˆç”Ÿäº§ç¯å¢ƒ</th>
<th align="left">å¯ä»¥å®šä½çš„ä»£ç </th>
</tr>
</thead>
<tbody><tr>
<td align="left">(none)</td>
<td align="left">+++</td>
<td align="left">+++</td>
<td align="left">yes</td>
<td align="left">æœ€ç»ˆè¾“å‡ºçš„ä»£ç </td>
</tr>
<tr>
<td align="left">eval</td>
<td align="left">+++</td>
<td align="left">+++</td>
<td align="left">no</td>
<td align="left">webpackç”Ÿæˆçš„ä»£ç å—ï¼ˆä¸€ä¸ªä¸ªçš„æ¨¡å—ï¼‰</td>
</tr>
<tr>
<td align="left">cheap-eval-source-map</td>
<td align="left">+</td>
<td align="left">++</td>
<td align="left">no</td>
<td align="left">ç»è¿‡loaderè½¬æ¢åçš„ä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">cheap-module-eval-source-map</td>
<td align="left">o</td>
<td align="left">++</td>
<td align="left">no</td>
<td align="left">æºä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">eval-source-map</td>
<td align="left">â€“</td>
<td align="left">+</td>
<td align="left">no</td>
<td align="left">æºä»£ç </td>
</tr>
<tr>
<td align="left">cheap-source-map</td>
<td align="left">+</td>
<td align="left">o</td>
<td align="left">yes</td>
<td align="left">ç»è¿‡loaderè½¬æ¢åçš„ä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">cheap-module-source-map</td>
<td align="left">o</td>
<td align="left">-</td>
<td align="left">yes</td>
<td align="left">æºä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">inline-cheap-source-map</td>
<td align="left">+</td>
<td align="left">o</td>
<td align="left">no</td>
<td align="left">ç»è¿‡loaderè½¬æ¢åçš„ä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">inline-cheap-module-source-map</td>
<td align="left">o</td>
<td align="left">-</td>
<td align="left">no</td>
<td align="left">æºä»£ç ï¼ˆåªèƒ½çœ‹åˆ°è¡Œï¼‰</td>
</tr>
<tr>
<td align="left">source-map</td>
<td align="left">â€“</td>
<td align="left">â€“</td>
<td align="left">yes</td>
<td align="left">æºä»£ç </td>
</tr>
<tr>
<td align="left">inline-source-map</td>
<td align="left">â€“</td>
<td align="left">â€“</td>
<td align="left">no</td>
<td align="left">æºä»£ç </td>
</tr>
<tr>
<td align="left">hidden-source-map</td>
<td align="left">â€“</td>
<td align="left">â€“</td>
<td align="left">yes</td>
<td align="left">æºä»£ç </td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.expors = &#123;</span><br><span class="line">  <span class="comment">// å¼€å‘,å› ä¸ºevalçš„rebuildé€Ÿåº¦å¿«ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¢åŠ evalå±æ€§</span></span><br><span class="line">  devtool: <span class="string">'cheap-module-eval-source-map'</span></span><br><span class="line">  <span class="comment">// ç”Ÿäº§</span></span><br><span class="line">  devtool: <span class="string">'cheap-module-source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4ä»£ç æ‹†åˆ†</title>
    <url>/2020/12/15/webpack4%E4%BB%A3%E7%A0%81%E6%8B%86%E5%88%86/</url>
    <content><![CDATA[<h4 id="åŸºç¡€åº“åˆ†ç¦»"><a href="#åŸºç¡€åº“åˆ†ç¦»" class="headerlink" title="åŸºç¡€åº“åˆ†ç¦»"></a>åŸºç¡€åº“åˆ†ç¦»</h4><p><strong>å°†reactã€react-domåŸºç¡€åŒ…é€šè¿‡cdnå¼•å…¥ï¼Œä¸æ‰“å…¥åˆ°bundleä¸­</strong></p>
<ul>
<li><p><code>externals</code></p>
<ul>
<li>é…ç½®<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    externals: &#123;</span><br><span class="line">        react: <span class="string">'React'</span>,</span><br><span class="line">        <span class="string">'react-dom'</span>: <span class="string">'ReactDOM'</span>,</span><br><span class="line">        <span class="string">'react-router-dom'</span>: <span class="string">'ReactRouterDOM'</span>,</span><br><span class="line">        mobx: <span class="string">'mobx'</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>åœ¨htmlæ¨¡ç‰ˆä¸­ scriptæ ‡ç­¾å¼•å…¥å¯¹åº”çš„cdnåœ°å€</li>
</ul>
</li>
<li><p><code>html-webpack-externals-plugin</code><strong>ï¼ˆæ¨èä½¿ç”¨ï¼‰</strong></p>
<ul>
<li>åœ¨htmlæ¨¡ç‰ˆä¸­ scriptæ ‡ç­¾å¼•å…¥å¯¹åº”çš„cdnåœ°å€</li>
<li>åœ¨<code>plugins</code>ä¸­é…ç½®<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> htmlWebpackExternalsPlugin(&#123;</span><br><span class="line">        externals: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">module</span>: <span class="string">'react'</span>,</span><br><span class="line">            entry: reactçš„cdnåœ°å€,</span><br><span class="line">            global: <span class="string">'React'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">module</span>: <span class="string">'react-dom'</span>,</span><br><span class="line">            entry: react-domçš„cdnåœ°å€,</span><br><span class="line">            global: <span class="string">'ReactDOM'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">module</span>: <span class="string">'react-router-dom'</span>,</span><br><span class="line">            entry: react-router-domçš„cdnåœ°å€,</span><br><span class="line">            global: <span class="string">'ReactRouterDOM'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>webpack4 æ›¿ä»£ CommonsChunckPluginæ’ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        minimize: <span class="literal">true</span>,</span><br><span class="line">        runtimeChunk: &#123;</span><br><span class="line">            name: <span class="string">'manifest'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            chunks: <span class="string">'async'</span>, <span class="comment">// asyncå¼‚æ­¥å¼•å…¥åº“è¿›è¡Œåˆ†ç¦»(é»˜è®¤),initialåŒæ­¥å¼•å…¥åº“åˆ†ç¦»ï¼Œallæ‰€æœ‰å¼•å…¥åº“åˆ†ç¦»</span></span><br><span class="line">            minSize: <span class="number">30000</span>, <span class="comment">// æŠ½ç¦»å…¬å…±åŒ…æœ€å°çš„å¤§å°</span></span><br><span class="line">            maxSize: <span class="number">0</span>,</span><br><span class="line">            minChunks: <span class="number">1</span>, <span class="comment">// æœ€å°ä½¿ç”¨çš„æ¬¡æ•° </span></span><br><span class="line">            maxAsyncRequests: <span class="number">5</span>,</span><br><span class="line">            maxInitialRequests: <span class="number">3</span>,</span><br><span class="line">            name: <span class="literal">true</span>,</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                <span class="comment">// æå–åŸºç¡€åº“ï¼Œä¸ä½¿ç”¨CDNçš„æ–¹å¼</span></span><br><span class="line">                <span class="comment">//commons: &#123;</span></span><br><span class="line">                <span class="comment">//  test: /(react|react-dom|react-router-dom)/,</span></span><br><span class="line">                <span class="comment">//  name: "vendors",</span></span><br><span class="line">                <span class="comment">//  chunks: 'all'</span></span><br><span class="line">                <span class="comment">//&#125;,</span></span><br><span class="line">                <span class="comment">// æå–å…¬å…±js</span></span><br><span class="line">                commons: &#123;</span><br><span class="line">                chunks: <span class="string">"all"</span>, <span class="comment">// initial</span></span><br><span class="line">                minChunks: <span class="number">2</span>,</span><br><span class="line">                maxInitialRequests: <span class="number">5</span>,</span><br><span class="line">                minSize: <span class="number">0</span>,</span><br><span class="line">                name: <span class="string">"commons"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">// vendors: &#123;</span></span><br><span class="line">                <span class="comment">//   test: /[\\/]node_modules[\\/]/,</span></span><br><span class="line">                <span class="comment">//   priority: -10</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">                <span class="comment">// åˆå¹¶æ‰€æœ‰css</span></span><br><span class="line">                <span class="comment">// styles: &#123;</span></span><br><span class="line">                <span class="comment">//   name: 'style',</span></span><br><span class="line">                <span class="comment">//   test: /\.(css|scss)$/,</span></span><br><span class="line">                <span class="comment">//   chunks: 'all',</span></span><br><span class="line">                <span class="comment">//   minChunks: 1,</span></span><br><span class="line">                <span class="comment">//   enforce: true</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4å¤šé¡µé¢åº”ç”¨MPA</title>
    <url>/2020/12/15/webpack4%E5%A4%9A%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8MPA/</url>
    <content><![CDATA[<h4 id="å¤šé¡µé¢åº”ç”¨MPA"><a href="#å¤šé¡µé¢åº”ç”¨MPA" class="headerlink" title="å¤šé¡µé¢åº”ç”¨MPA"></a>å¤šé¡µé¢åº”ç”¨MPA</h4><ul>
<li>æ¯ä¸€æ¬¡é¡µé¢è·³è½¬ï¼Œåå°éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„htmlï¼Œå¤šé¡µåº”ç”¨</li>
<li>å±äºåç«¯æ¸²æŸ“ï¼Œæœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ï¼šSEOå‹å¥½ã€æ¯ä¸ªé¡µé¢æ˜¯è§£è€¦çš„</li>
<li>ç¼ºç‚¹ï¼šæ¯ä¸ªé¡µé¢å¯¹åº”ä¸€ä¸ªentryï¼Œä¸€ä¸ªhtml-webpack-pluginï¼Œï¼ˆè¿™ç§å¤ªéº»çƒ¦äº†ï¼Œæ¯æ¬¡æ–°å¢éƒ½éœ€è¦å†é…ç½®ä¸€æ¬¡ï¼‰</li>
</ul>
<h4 id="é’ˆå¯¹ä¸Šè¿°ç¼ºç‚¹çš„è§£å†³æ–¹æ¡ˆ"><a href="#é’ˆå¯¹ä¸Šè¿°ç¼ºç‚¹çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é’ˆå¯¹ä¸Šè¿°ç¼ºç‚¹çš„è§£å†³æ–¹æ¡ˆ"></a>é’ˆå¯¹ä¸Šè¿°ç¼ºç‚¹çš„è§£å†³æ–¹æ¡ˆ</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹å¦‚ ./src/index/index.js ä¸ ./src/search/index.js</span></span><br><span class="line"><span class="comment">// path: './src/*/index.js'</span></span><br><span class="line"><span class="keyword">const</span> setMPA = <span class="function"><span class="params">filenames</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> entry = &#123;&#125;, htmlWebpackPlugins = [];</span><br><span class="line">  <span class="keyword">const</span> entryFiles = glob.sync(path.join(__dirname, filenames))</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> entryFiles)&#123;</span><br><span class="line">    <span class="comment">// (/\/([a-z\_\$]+)\/index.js$/)</span></span><br><span class="line">    <span class="keyword">const</span> match = item.match(<span class="regexp">/src\(.*)/i</span>ndex\.js$/)</span><br><span class="line">    <span class="keyword">const</span> pageName = match &amp;&amp; match[<span class="number">1</span>];</span><br><span class="line">    entry[pageName] = item</span><br><span class="line"></span><br><span class="line">    htmlWebpackPlugins.push(</span><br><span class="line">      <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        template: <span class="string">`src/<span class="subst">$&#123;pageName&#125;</span>/index.html`</span>,</span><br><span class="line">        filename: <span class="string">`<span class="subst">$&#123;pageName&#125;</span>.html`</span>,</span><br><span class="line">        chunks: [<span class="string">"runtime"</span>, <span class="string">"common"</span>, pageName],</span><br><span class="line">        minify: &#123;</span><br><span class="line">          <span class="comment">// ..</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    entry,</span><br><span class="line">    htmlWebpackPlugins</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">entry: entry</span><br><span class="line">plugin: [<span class="comment">//.....].concat(htmlWebpackPlugins)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4èµ„æºå†…è”</title>
    <url>/2020/12/15/webpack4%E8%B5%84%E6%BA%90%E5%86%85%E8%81%94/</url>
    <content><![CDATA[<h4 id="èµ„æºå†…è”æ˜¯å¹²ä»€ä¹ˆ"><a href="#èµ„æºå†…è”æ˜¯å¹²ä»€ä¹ˆ" class="headerlink" title="èµ„æºå†…è”æ˜¯å¹²ä»€ä¹ˆ"></a>èµ„æºå†…è”æ˜¯å¹²ä»€ä¹ˆ</h4><p>èµ„æºå†…è”ï¼šå°±æ˜¯æŠŠæ‰“åŒ…å¥½çš„cssç­‰æ–‡ä»¶ï¼Œåœ¨htmlä¸­æ³¨å…¥è¿™äº›æ–‡ä»¶è·¯å¾„ï¼Œå®ç°å†…è”</p>
<ul>
<li>é¡µé¢æ¡†æ¶çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚flexible</li>
<li>ä¸ŠæŠ¥ç›¸å…³æ‰“ç‚¹</li>
<li>csså†…è”é¿å…é¡µé¢é—ªåŠ¨ï¼ˆç›´æ¥å°†csså†…è”åˆ°htmlæ–‡ä»¶ï¼‰</li>
</ul>
<h4 id="å†…è”html"><a href="#å†…è”html" class="headerlink" title="å†…è”html"></a>å†…è”html</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// raw-loader@0.5.1 å†…è”htmlç‰‡æ®µï¼Œåœ¨templateä¸­å¼„</span></span><br><span class="line"><span class="comment">// å†…è”html</span></span><br><span class="line">&lt;%= <span class="built_in">require</span>(<span class="string">'raw-loader!./meta.html'</span>) %&gt;</span><br></pre></td></tr></table></figure>

<h4 id="å†…è”javascript"><a href="#å†…è”javascript" class="headerlink" title="å†…è”javascript"></a>å†…è”javascript</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// raw-loaderå†…è”js</span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è„šæœ¬ï¼Œä¾‹å¦‚flexible</span></span><br><span class="line">&lt;script&gt;&lt;%= <span class="built_in">require</span>(<span class="string">'raw-loader!babel-loader!../node_modules/lib-flexible/flexible.js'</span>) %&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å†…è”css"><a href="#å†…è”css" class="headerlink" title="å†…è”css"></a>å†…è”css</h4><ul>
<li>æ–¹å¼ä¸€ï¼šstyle-loader</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/.s?css$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'style-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    injectType: <span class="string">'singletonStyleTag'</span>, <span class="comment">// å°†æ‰€æœ‰styleæ ‡ç­¾åˆå¹¶æˆä¸€ä¸ª</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="string">'css-loader'</span></span><br><span class="line">            <span class="string">'postcss-loader'</span>,</span><br><span class="line">            <span class="string">'sass-loader'</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹å¼äºŒï¼š html-inline-css-webpack-plugin<br>é¦–å…ˆä½¿ç”¨ mini-css-extract-pluginï¼ˆè€Œé style-loaderï¼‰å°† css æå–æ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹çš„ css chunk æ–‡ä»¶ ç„¶åä½¿ç”¨html-webpack-plugin ç”Ÿæˆ html é¡µé¢ æœ€åä½¿ç”¨ html-inline-css-webpack-plugin è¯»å–æ‰“åŒ…å¥½çš„ css chunk å†…å®¹æ³¨å…¥åˆ°é¡µé¢ï¼ŒåŸæœ¬ html-webpack-plugin åªä¼šå¼•å…¥ css èµ„æºåœ°å€ï¼Œç°åœ¨å®ç°äº† css å†…è”</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> HTMLInlineCSSWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-inline-css-webpack-plugin"</span>).default;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">                MiniCssExtractPlugin.loader,</span><br><span class="line">                <span class="string">"css-loader"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">"[name].css"</span>,</span><br><span class="line">            chunkFilename: <span class="string">"[id].css"</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(),</span><br><span class="line">        <span class="keyword">new</span> HTMLInlineCSSWebpackPlugin(),</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ–¹å¼ä¸€<code>style-loader</code> <strong>VS</strong> æ–¹å¼äºŒ<code>html-inline-css-webpack-plugin</code> <ul>
<li><code>style-loader</code>æ˜¯css-in-jsï¼Œéœ€è¦åŠ è½½jsåæ‰èƒ½å†™å…¥åˆ°styleä¸­ï¼Œæœ‰ä¸€å®šçš„å»¶è¿Ÿæ€§</li>
<li><code>html-inline-css-webpack-plugin</code>æ˜¯å°†cssæå–å‡ºæ¥ï¼Œå†å†™å…¥åˆ°htmlä¸­ï¼Œhtmlç½‘é¡µæºä»£ç ä¸­å·²ç»å†…è”å¥½cssäº†ï¼Œæ²¡æœ‰å»¶è¿Ÿæ€§äº†</li>
<li>è¯·æ±‚å±‚é¢ï¼šå‡å°‘HTTPç½‘ç»œè¯·æ±‚æ•°</li>
</ul>
</li>
</ul>
<h4 id="å°å›¾ç‰‡æˆ–è€…å­—ä½“å†…è”"><a href="#å°å›¾ç‰‡æˆ–è€…å­—ä½“å†…è”" class="headerlink" title="å°å›¾ç‰‡æˆ–è€…å­—ä½“å†…è”"></a>å°å›¾ç‰‡æˆ–è€…å­—ä½“å†…è”</h4><pre><code>url-loader</code></pre><blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackçƒ­æ›´æ–°åŸç†</title>
    <url>/2020/12/15/webpack%E7%83%AD%E6%9B%B4%E6%96%B0%E5%8E%9F%E7%90%86/</url>
    <content><![CDATA[<h4 id="webpackçƒ­æ›´æ–°pluginsé…ç½®"><a href="#webpackçƒ­æ›´æ–°pluginsé…ç½®" class="headerlink" title="webpackçƒ­æ›´æ–°pluginsé…ç½®"></a>webpackçƒ­æ›´æ–°pluginsé…ç½®</h4><ul>
<li><strong>webpack-dev-server</strong></li>
</ul>
<blockquote>
<p>å¼€å¯æœ¬åœ°æœåŠ¡å™¨ï¼Œç›‘å¬æ–‡ä»¶å˜åŒ–åï¼Œçƒ­æ›´æ–°é¡µé¢;ä¸åˆ·æ–°æµè§ˆå™¨è€Œæ˜¯çƒ­æ›´æ–°ï¼Œä¸è¾“å‡ºæ–‡ä»¶ï¼Œè€Œæ˜¯æ”¾åœ¨å†…å­˜ä¸­;é…åˆ new.webpack.HotModuleReplacementPlugin() æˆ– react-hot-loader æ’ä»¶ä½¿ç”¨</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">webpack-dev-server mode=development -open</span><br><span class="line"><span class="comment">// config</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">        compress: <span class="literal">true</span>,</span><br><span class="line">        port: <span class="string">'3000'</span>,</span><br><span class="line">        contentBase: join(__dirname, <span class="string">'../dist'</span>),<span class="comment">//ç›‘å¬çš„ç›®å½•ï¼Œç”¨äºåˆ·æ–°æµè§ˆå™¨</span></span><br><span class="line">        hot: <span class="literal">true</span>,</span><br><span class="line">        overlay: &#123;</span><br><span class="line">            errors: <span class="literal">true</span>,</span><br><span class="line">            warnings: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        disableHostCheck: <span class="literal">true</span>,</span><br><span class="line">        publicPath: <span class="string">'/'</span>, <span class="comment">// è®¾ç½®æ—¶ï¼Œè¦ä¸output.publicPathä¿æŒä¸€è‡´</span></span><br><span class="line">        historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// historyApiFallback: &#123;</span></span><br><span class="line">        <span class="comment">//   rewrites: [from: /.*/, to: path.posix.join('/',     // 'index.html')],</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        proxy: &#123;</span><br><span class="line">            <span class="string">'/api'</span>: <span class="string">'http://localhost:8081'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//proxy: &#123;</span></span><br><span class="line">        <span class="comment">//  '/api/*': &#123;</span></span><br><span class="line">        <span class="comment">//     target: 'https://xxx.com',</span></span><br><span class="line">        <span class="comment">//     changeOrigin: true,</span></span><br><span class="line">        <span class="comment">//     secure: false,</span></span><br><span class="line">        <span class="comment">//     headers: &#123;&#125;,</span></span><br><span class="line">        <span class="comment">//     onProxyReq: function(proxyReq, req, res) &#123;</span></span><br><span class="line">        <span class="comment">//       proxyReq.setHeader('origin', 'xxx.com');</span></span><br><span class="line">        <span class="comment">//       proxyReq.setHeader('referer', 'xxx.com');</span></span><br><span class="line">        <span class="comment">//       proxyReq.setHeader('cookie', 'xxxxx');</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     onProxyRes: function(proxyRes, req, res) &#123;</span></span><br><span class="line">        <span class="comment">//       const cookies = proxyRes.header['set-cookie'];</span></span><br><span class="line">        <span class="comment">//       cookies &amp;&amp; buildCookie(cookies)</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">//  &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>åŸç†</strong></p>
<ul>
<li><p><code>Webpack Compile</code>: å°†JSç¼–è¯‘ä¸ºBundle</p>
</li>
<li><p><code>HMR Server</code>: å°†çƒ­æ›´æ–°çš„æ–‡ä»¶è¾“å‡ºç»™ HMR Runtime</p>
</li>
<li><p><code>Bundle server</code>: æä¾›æ–‡ä»¶åœ¨æµè§ˆå™¨çš„è®¿é—®</p>
</li>
<li><p><code>HMR Runtime</code>: ä¼šè¢«æ³¨å…¥åˆ°æµè§ˆå™¨ï¼Œæ›´æ–°æ–‡ä»¶çš„å˜åŒ–</p>
</li>
<li><p><code>bundle.js</code>: æ„å»ºè¾“å‡ºçš„æ–‡ä»¶</p>
<blockquote>
<p>HMR: Hot Module Replacement </p>
</blockquote>
<p><img src="http://i.feidom.com/hmr.jpg" alt="webpackçƒ­æ›´æ–°åŸç†å›¾"></p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>reactçŸ¥è¯†Q&amp;A</title>
    <url>/2020/12/04/react%E7%9F%A5%E8%AF%86Q&amp;A/</url>
    <content><![CDATA[<p><strong>qaçš„å…³é”®åœ¨äºå›ç­”æ—¶æ³¨æ„çŸ¥è¯†å¯æ‰©å±•çš„æ·±åº¦å’Œå¹¿åº¦ï¼ŒåŸºæœ¬ä»â€œ</strong>æ˜¯ä»€ä¹ˆ<strong>â€ï¼Œâ€œä¸ºä»€ä¹ˆâ€ï¼Œâ€œæ€ä¹ˆåšâ€ä¸‰ä¸ªæ–¹é¢æ¥å›ç­”</strong></p>
<h4 id="Q-è¯´è¯´ä»€ä¹ˆæ˜¯reactï¼Ÿ"><a href="#Q-è¯´è¯´ä»€ä¹ˆæ˜¯reactï¼Ÿ" class="headerlink" title="Q:è¯´è¯´ä»€ä¹ˆæ˜¯reactï¼Ÿ"></a>Q:è¯´è¯´ä»€ä¹ˆæ˜¯reactï¼Ÿ</h4><blockquote>
<p>é¢˜è§£ï¼šreactçš„è¯ç”ŸèƒŒæ™¯<br>  2005å¹´ jqueryè¯ç”Ÿï¼Œæµè§ˆå™¨å…¼å®¹æ˜¯å½“æ—¶æœ€å¤§çš„é—®é¢˜ã€‚ä¸ç®—æ¡†æ¶ï¼Œåªç®—æ˜¯å·¥å…·å‡½æ•°åˆé›†ã€‚ä»ä¸èƒ½è§£å†³ä»£ç å¤ç”¨é—®é¢˜å’Œå·¥ç¨‹åŒ–é—®é¢˜ã€‚<br>  2009å¹´ angularJså¸¦ç€åå°javaå¼€å‘çš„æ€æƒ³æ¨ªç©ºå‡ºä¸–ï¼Œå‰ç«¯é¡¹ç›®å·¥ç¨‹åŒ–åŒå‘ç»‘å®šç»™å½“æ—¶çš„ä¸­å°ç³»ç»Ÿå¸¦æ¥äº†å·¨å¤§çš„ä¾¿åˆ©ï¼Œä½†æ˜¯angularè‡ƒè‚¿ï¼Œéœ€è¦å­¦ä¹ å¾ˆå¤šangularæ¦‚å¿µï¼Œæˆæœ¬é«˜ã€‚<br>  2010å¹´ backbonejså‡ºç°ï¼Œæ—¢å…¼å®¹jqueryï¼Œåˆæœ‰å¾ˆå¥½çš„mvcå·¥ç¨‹åŒ–ç®¡ç†ï¼Œåœ¨å‰ç«¯é£é¡ä¸€æ—¶ã€‚<br>  2013å¹´ reactjsè¯ç”Ÿï¼Œreactçš„è™šæ‹Ÿdomï¼Œç»„ä»¶å¼å¼€å‘ï¼Œå®Œç¾çš„å®ç°äº†è§†å›¾å¼€å‘ä¸­ç»„åˆä¼˜äºç»§æ‰¿çš„æ€æƒ³ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†å¼€å‘å¤ç”¨çš„é—®é¢˜<br>  2014å¹´ vueè¯ç”Ÿ</p>
</blockquote>
<p><font color=red size=5>A: </font><br>   <strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šreactæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„javascriptåº“ï¼›<br>   <strong>ä¼˜ç‚¹</strong>: å£°æ˜å¼ã€ç»„ä»¶åŒ–ã€é€šç”¨æ€§<br>         å£°æ˜å¼ï¼šç¼–å†™ä»£ç æ›´ç›´è§‚æ›´ç®€æ´<br>         ç»„ä»¶åŒ–ï¼šæé«˜ä»£ç å¤ç”¨ç‡ï¼Œå®ç°é«˜å†…èšï¼Œä½è€¦åˆçš„è®¾è®¡åŸåˆ™<br>         é€šç”¨æ€§ï¼šä¸€æ¬¡å­¦ä¹ ï¼Œéšå¤„ç¼–å†™ã€‚reactå®ç°äº†è™šæ‹Ÿdomå±‚ï¼Œç¨‹åºä¸ä¼šç›´æ¥æ“ä½œdomï¼Œä¾æ®domdiffå¤„ç†è§†å›¾æ”¹å˜ã€‚æ”¯æŒè™šæ‹Ÿdomå±‚çš„æŠ€æœ¯æ ˆï¼Œéƒ½èƒ½ç”¨reactè¿›è¡Œå‰ç«¯å¤„ç†ã€‚<br>   <strong>ç¼ºç‚¹</strong>ï¼šreactå¹¶æ²¡æœ‰æ”¯æŒå‰ç«¯å…¨éƒ¨è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯äº¤ç»™ç¤¾åŒºæ¥å®ç°ï¼Œæ‰€ä»¥reactçš„ç¤¾åŒºå¾ˆæ´»è·ƒã€‚ä½†æ˜¯å¸¦æ¥äº†å­¦ä¹ ä¸œè¥¿å¤šçš„é«˜å­¦ä¹ æˆæœ¬ã€‚</p>
<h4 id="Q-è¯´è¯´reactä¸ºä»€ä¹ˆé€‰æ‹©äº†jsxè¯­æ³•"><a href="#Q-è¯´è¯´reactä¸ºä»€ä¹ˆé€‰æ‹©äº†jsxè¯­æ³•" class="headerlink" title="Q:è¯´è¯´reactä¸ºä»€ä¹ˆé€‰æ‹©äº†jsxè¯­æ³•"></a>Q:è¯´è¯´reactä¸ºä»€ä¹ˆé€‰æ‹©äº†jsxè¯­æ³•</h4><blockquote>
<p>é¢˜è§£ï¼šä¹Ÿå°±æ˜¯åœ¨é—®ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰é€‰æ‹©å…¶ä»–æ–¹æ¡ˆ<br>        å…¶ä»–æ–¹æ¡ˆæœ‰ï¼švueåœ¨ç”¨çš„æ¨¡æ¿è¯­æ³•ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œjxonè¯­æ³•</p>
</blockquote>
<p><font color=red size=5>A: </font><br>   <strong>æ˜¯ä»€ä¹ˆ</strong>ï¼šjsxè¯­æ³•æ˜¯javacsriptçš„æ‰©å±•ã€‚jsxä¼šè¢«babelç¼–è¯‘ä¸ºReact.createElement(),æ˜¯React.createElement()çš„è¯­æ³•ç³–ï¼Œé€šè¿‡ç±»ä¼¼XMLçš„æè¿°æ–¹å¼ï¼Œæå†™å‡½æ•°å¯¹è±¡ã€‚<br>   <strong>ä¼˜ç‚¹</strong>ï¼šæ›´ç®€æ´æ›´ç›´è§‚ï¼Œæ›´è´´è¿‘åŸç”Ÿhtmlã€‚è´´è¿‘reacâ€œå…³æ³¨ç‚¹åˆ†ç¦»â€çš„æ€æƒ³ã€‚<br>   å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆï¼š<br>      æ¨¡æ¿è¯­æ³•ï¼šåˆ†ç¦»äº†æŠ€æœ¯æ ˆï¼Œå¼•å…¥äº†ä¸è¯¥ç§°ä¸ºå…³æ³¨ç‚¹çš„æ¨¡æ¿æ¦‚å¿µï¼šæ¨¡æ¿æŒ‡ä»¤ï¼Œæ¨¡æ¿è¯­æ³•ç­‰ã€‚ä¸ç¬¦åˆreactçš„è®¾è®¡æ€æƒ³<br>      æ¨¡æ¿å­—ç¬¦ä¸²ï¼šä½¿ä»£ç å˜å¾—æ›´å¤æ‚ï¼Œå­—ç¬¦ä¸²ç¼–å†™ï¼Œä¸åˆ©äºè¯­æ³•æç¤º<br>      jxonï¼šç±»ä¼¼jsxè¯­æ³•ï¼Œä½†æ˜¯å› ä¸ºå¤§æ‹¬å·çš„è¯­æ³•æç¤ºé—®é¢˜<br>  æ‰€ä»¥reacté€‰æ‹©äº†jsxï¼Œå› ä¸ºjsxä¸å…¶è®¾è®¡ç†å¿µè´´åˆï¼Œä¸éœ€è¦å¼•å…¥è¿‡å¤šçš„æ¦‚å¿µï¼Œå¯¹ä»£ç æç¤ºä¹Ÿå¾ˆå‹å¥½ï¼Œæœ€é€‚åˆreactã€‚</p>
<h4 id="Q-React-çš„è¯·æ±‚åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆ"><a href="#Q-React-çš„è¯·æ±‚åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆ" class="headerlink" title="Q:React çš„è¯·æ±‚åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆ?"></a>Q:React çš„è¯·æ±‚åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆ?</h4><ul>
<li>å¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œåº”è¯¥æ”¾åœ¨ componentDidMount ä¸­å»æ“ä½œã€‚ä»æ—¶é—´é¡ºåºæ¥çœ‹ï¼Œé™¤äº† componentDidMount è¿˜å¯ä»¥æœ‰ä»¥ä¸‹é€‰æ‹©ï¼š</li>
<li>constructorï¼šå¯ä»¥æ”¾ï¼Œä½†ä»è®¾è®¡ä¸Šè€Œè¨€ä¸æ¨èã€‚constructor ä¸»è¦ç”¨äºåˆå§‹åŒ– state ä¸å‡½æ•°ç»‘å®šï¼Œå¹¶ä¸æ‰¿è½½ä¸šåŠ¡é€»è¾‘ã€‚è€Œä¸”éšç€ç±»å±æ€§çš„æµè¡Œï¼Œconstructor å·²ç»å¾ˆå°‘ä½¿ç”¨äº†ã€‚</li>
<li>componentWillMountï¼šå·²è¢«æ ‡è®°åºŸå¼ƒï¼Œåœ¨æ–°çš„å¼‚æ­¥æ¸²æŸ“æ¶æ„ä¸‹ä¼šè§¦å‘å¤šæ¬¡æ¸²æŸ“ï¼Œå®¹æ˜“å¼•å‘ Bugï¼Œä¸åˆ©äºæœªæ¥ React å‡çº§åçš„ä»£ç ç»´æŠ¤ã€‚</li>
</ul>
<p><font color=red size=5>A: </font>æ‰€ä»¥React çš„è¯·æ±‚æ”¾åœ¨ componentDidMount é‡Œæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</p>
<h4 id="Qï¼šç¤¾åŒºä¸­å»é™¤ç±»ç»„ä»¶constructorçš„åŸå› "><a href="#Qï¼šç¤¾åŒºä¸­å»é™¤ç±»ç»„ä»¶constructorçš„åŸå› " class="headerlink" title="Qï¼šç¤¾åŒºä¸­å»é™¤ç±»ç»„ä»¶constructorçš„åŸå› "></a>Qï¼šç¤¾åŒºä¸­å»é™¤ç±»ç»„ä»¶<code>constructor</code>çš„åŸå› </h4><blockquote>
<p>constructorä¹‹å‰ä¸»è¦ç”¨äºåˆå§‹åŒ–ç»„ä»¶çš„ä¸€äº›stateçŠ¶æ€ï¼Œç°åœ¨ç›´æ¥å°†çŠ¶æ€å†™åœ¨é¡¶éƒ¨<br><code>state = {count: 0}</code>ä¸å†å†™åœ¨constructorä¸­</p>
</blockquote>
<p><font color=red size=5>A:</font></p>
<ul>
<li>constructor ä¸­ä¸æ¨èå¤„ç†å¤„ç†åˆå§‹åŒ–ä»¥å¤–çš„é€»è¾‘</li>
<li>constructor æœ¬èº«åªæ˜¯classçš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶ä¸å±äºreactç”Ÿå‘½å‘¨æœŸ</li>
<li>ç§»é™¤ constructor åï¼Œä»£ç æ›´ç®€æ´</li>
</ul>
<h4 id="Q-setStateæ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°"><a href="#Q-setStateæ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°" class="headerlink" title="Q:setStateæ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°"></a>Q:setStateæ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°</h4><blockquote>
<p>é¢˜è§£ï¼šæ˜¯Aè¿˜æ˜¯Bè¿™ç§é—®é¢˜ï¼Œä¸è¦æƒ³å½“ç„¶çš„å›ç­”ï¼Œè¿™ç§é—®é¢˜å¯èƒ½åœ¨ä¸åŒåœºæ™¯ä¸­æœ‰ä¸åŒçš„é€‰æ‹©</p>
</blockquote>
<ul>
<li>å¯èƒ½æ˜¯A</li>
<li>å¯èƒ½æ˜¯B</li>
<li>Aå’ŒBåŒæ—¶å­˜åœ¨</li>
</ul>
<p>setStateç”¨äºæ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œæ›´æ–°è§†å›¾UI</p>
<ul>
<li><p>å…ˆäº†è§£ä¸‹<strong>åˆæˆäº‹ä»¶</strong><br> åŸºäº äº‹ä»¶å§”æ‰˜ æ€æƒ³, åœ¨React @17.0å‰</p>
<ol>
<li>Reactç»™<code>document(HTML)</code>æŒ‚ä¸Šäº‹ä»¶ç›‘å¬</li>
<li>Domäº‹ä»¶è§¦å‘åå†’æ³¡åˆ°<code>document(HTML)</code></li>
<li>Reactæ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ï¼Œé€ å‡ºä¸€ä¸ª<strong>åˆæˆäº‹ä»¶</strong></li>
<li>æŒ‰ç»„ä»¶æ ‘æ¨¡æ‹Ÿä¸€éäº‹ä»¶å†’æ³¡<br>æ‰€ä»¥ä¸€ä¸ªé¡µé¢ä¸­åªèƒ½æœ‰ä¸€ä¸ªç‰ˆæœ¬çš„Reactï¼Œå¤šä¸ªç‰ˆæœ¬çš„è¯ï¼Œäº‹ä»¶å°±ä¹±å¥—äº†<br><a class="link"   href="mailto:React@17.0" >React@17.0<i class="fas fa-external-link-alt"></i></a>åï¼Œäº‹ä»¶å§”æ‰˜å¯¹è±¡ç”±<code>document(HTML)</code>æ›´æ”¹ä¸º<code>Domå®¹å™¨(ReactDOM.render()æ‰€è°ƒç”¨çš„èŠ‚ç‚¹)</code>ä¸Š</li>
</ol>
</li>
<li><p>å¼‚æ­¥åœºæ™¯</p>
<ul>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒsetStateæ˜¯å¼‚æ­¥çš„ã€‚<br>Reactçš„<em>setStateæ‰§è¡Œæ›´åƒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ‰§è¡Œæ—¶æ ¹æ®é˜Ÿåˆ—ä¸€ä¸€æ‰§è¡Œï¼Œåˆå¹¶stateæ•°æ®ã€‚å®Œæˆåæ‰§è¡Œå›è°ƒ</em>ï¼Œæ ¹æ®ç»“æœæ›´æ–°è™šæ‹ŸDomè§¦å‘æ¸²æŸ“</li>
<li>ä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„ï¼Ÿ<br> å®˜æ–¹å›å¤çœ‹<a class="link"   href="https://github.com/facebook/react/issues/11527#issuecomment-360199710"  target="_blank" rel="noopener">è¿™é‡Œ<i class="fas fa-external-link-alt"></i></a><ol>
<li>ä¿æŒå†…éƒ¨çš„ä¸€è‡´æ€§</li>
<li>ä¸ºåç»­çš„æ¶æ„å‡çº§å¯ç”¨å¹¶å‘æ›´æ–°</li>
</ol>
</li>
</ul>
</li>
<li><p>åŒæ­¥åœºæ™¯<br> åœ¨ addEventListenerã€ setTimeoutã€ setIntervalè¿™äº›åŸç”Ÿäº‹ä»¶ä¸­ä¼šåŒæ­¥æ›´æ–°</p>
</li>
<li><p>setStateçš„å·¥ä½œåŸç†<br> <img src="https://s0.lgstatic.com/i/image2/M01/01/47/Cip5yF_YYfCAXIxiAAEJsQbj_hs785.png" alt="setState"><br> <img src="https://s0.lgstatic.com/i/image2/M01/01/3E/CgpVE1_YU2KAStLdAAFVKxh7Dyg317.png" alt="setState"><br><font color=red size=5>Aï¼š</font><br> setState å¹¶éçœŸå¼‚æ­¥ï¼Œåªæ˜¯çœ‹ä¸Šå»åƒå¼‚æ­¥ã€‚åœ¨æºç ä¸­ï¼Œé€šè¿‡ isBatchingUpdates æ¥åˆ¤æ–­<br> setState æ˜¯å…ˆå­˜è¿› state é˜Ÿåˆ—è¿˜æ˜¯ç›´æ¥æ›´æ–°ï¼Œå¦‚æœå€¼ä¸º true åˆ™æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸º false åˆ™ç›´æ¥æ›´æ–°ã€‚</p>
<p> é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹ isBatchingUpdates ä¼šä¸º true å‘¢ï¼Ÿåœ¨ React å¯ä»¥æ§åˆ¶çš„åœ°æ–¹ï¼Œå°±ä¸º trueï¼Œæ¯”å¦‚åœ¨ React ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å’Œåˆæˆäº‹ä»¶ä¸­ï¼Œéƒ½ä¼šèµ°åˆå¹¶æ“ä½œï¼Œå»¶è¿Ÿæ›´æ–°çš„ç­–ç•¥ã€‚</p>
<p> ä½†åœ¨ React æ— æ³•æ§åˆ¶çš„åœ°æ–¹ï¼Œæ¯”å¦‚åŸç”Ÿäº‹ä»¶ï¼Œå…·ä½“å°±æ˜¯åœ¨ addEventListener ã€setTimeoutã€setInterval ç­‰äº‹ä»¶ä¸­ï¼Œå°±åªèƒ½åŒæ­¥æ›´æ–°ã€‚</p>
<p> ä¸€èˆ¬è®¤ä¸ºï¼Œåšå¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ã€å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼ŒReact å›¢é˜Ÿè¿˜è¡¥å……äº†ä¸¤ç‚¹ã€‚</p>
<p> ä¿æŒå†…éƒ¨ä¸€è‡´æ€§ã€‚å¦‚æœå°† state æ”¹ä¸ºåŒæ­¥æ›´æ–°ï¼Œé‚£å°½ç®¡ state çš„æ›´æ–°æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯ propsä¸æ˜¯ã€‚</p>
<p> å¯ç”¨å¹¶å‘æ›´æ–°ï¼Œå®Œæˆå¼‚æ­¥æ¸²æŸ“ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack4åŸºç¡€</title>
    <url>/2020/11/25/webpack4%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p><code>yarn add webpack webpack-cli</code></p>
<h4 id="åŸºç¡€é…ç½®"><a href="#åŸºç¡€é…ç½®" class="headerlink" title="åŸºç¡€é…ç½®"></a>åŸºç¡€é…ç½®</h4><ul>
<li><strong>entry</strong>  ä¾èµ–å…¥å£</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">entry: <span class="string">'&#123;path&#125;/app.js'</span> <span class="comment">//å•å…¥å£ SPA</span></span><br><span class="line">entry: &#123;</span><br><span class="line">    app: <span class="string">'&#123;path&#125;/app.js'</span>,</span><br><span class="line">    otherapp: <span class="string">'&#123;path&#125;/otherapp.js'</span></span><br><span class="line">&#125; <span class="comment">//å¤šå…¥å£ MPA</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>output</strong>  æŒ‡å®šæ‰“åŒ…åçš„è¾“å‡º</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: path.resolve(__diranme,<span class="string">'dist'</span>)</span><br><span class="line">    filename: <span class="string">'[name].js'</span> <span class="comment">// å•å…¥å£å¯ä»¥å†™æ­»æ–‡ä»¶åï¼Œå¤šå…¥å£ä¸€å®šè¦ä½¿ç”¨å ä½ç¬¦[name]ï¼Œæ¥è‡ªåŠ¨ç”Ÿæˆå¤šä¸ªæ–‡ä»¶</span></span><br><span class="line">    <span class="comment">// filename: '[name].[chunkhash:5]]js'</span></span><br><span class="line">    <span class="comment">// filename: '[name].[hash]js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>Loaders</strong> è§£æå™¨</p>
<ul>
<li><p>webpackæœ¬èº«åªæ”¯æŒjså’Œjsonä¸¤ç§æ–‡ä»¶ç±»å‹ï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶éœ€è¦å„ç§<code>Loaders</code>æ”¯æŒï¼Œè½¬åŒ–ä¸ºæœ‰æ•ˆçš„æ¨¡å—ã€‚</p>
</li>
<li><p>æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—æºæ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›è½¬æ¢çš„ç»“æœ</p>
</li>
<li><p>å¸¸ç”¨loaders</p>
<table>
<thead>
<tr>
<th align="left">loader</th>
<th align="left">ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ts-loader</td>
<td align="left">åŠ è½½è§£ætsæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">babel-loader</td>
<td align="left">åœ¨webpackä¸­ä½¿ç”¨babelè§£æES6</td>
</tr>
<tr>
<td align="left">css-loader/less-loader/scss-loader</td>
<td align="left">css/less/sassè§£æå™¨</td>
</tr>
<tr>
<td align="left">cstyle-loader</td>
<td align="left">å°†æ ·å¼é€šè¿‡ style æ ‡ç­¾ï¼Œæ’å…¥åˆ° head ä¸­</td>
</tr>
<tr>
<td align="left">url-loader/file-loader</td>
<td align="left">å¤„ç†æ–‡ä»¶ï¼Œå›¾ç‰‡ã€å­—ä½“ã€å¤šåª’ä½“ url-loader å®ç°è¾ƒå°çš„å›¾ç‰‡è½¬æˆbase64ï¼Œæ’å…¥åˆ°ä»£ç ä¸­ï¼Œå½“è¶…è¿‡é™åˆ¶çš„limitåï¼Œä¼šè‡ªåŠ¨é™çº§åˆ°file-loader</td>
</tr>
<tr>
<td align="left">raw-loader</td>
<td align="left">å°†.txtæ–‡ä»¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å¯¼å…¥</td>
</tr>
<tr>
<td align="left">thread-loader</td>
<td align="left">å¤šè¿›ç¨‹æ‰“åŒ…jså’Œcss</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config</span></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        <span class="comment">// è§£æES6,appæ ¹ç›®å½•è¦é…ç½®.babelrcï¼Œå¦‚ä¸‹é¢çš„.babelrc</span></span><br><span class="line">        &#123;<span class="attr">test</span>: <span class="regexp">/.js?x$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>&#125; <span class="comment">// exclude é™¤å»node_modulesé‡Œçš„æ–‡ä»¶</span></span><br><span class="line">        <span class="comment">// å°†.txtæ–‡ä»¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å¯¼å…¥</span></span><br><span class="line">        &#123;<span class="attr">test</span>: <span class="regexp">/.txt$/</span>, <span class="attr">use</span>: <span class="string">'raw-loader'</span>&#125;,</span><br><span class="line">        <span class="comment">// åŒ¹é…sass/cssæ–‡ä»¶ï¼Œç”¨å¯¹åº”çš„loaderå¤„ç†æ–‡ä»¶</span></span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/.s?css$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">            isDev ? <span class="string">'style-loader'</span> : MiniCssExtractPlugin.loader</span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    importLoaders: <span class="number">1</span>,</span><br><span class="line">                    <span class="comment">// cssæ¨¡å—åŒ–ä½¿ç”¨</span></span><br><span class="line">                    modules: &#123;</span><br><span class="line">                        localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// é¢„å¤„ç†å™¨, autoprefixer(éœ€è¦å®‰è£…)</span></span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    plugins: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)(&#123;</span><br><span class="line">                            browsers: [<span class="string">'last 2 version'</span>, <span class="string">'&gt;1%'</span>, <span class="string">'ios7'</span>]</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'sass-loader'</span>,</span><br><span class="line">            <span class="comment">// pxè‡ªåŠ¨è½¬rem</span></span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'px2rem-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    remUnit: <span class="number">75</span>, <span class="comment">// ä¸€ä¸ªremç­‰äºå¤šå°‘px</span></span><br><span class="line">                    remPrecision: <span class="number">8</span> <span class="comment">// pxè½¬æ¢æˆremçš„å°æ•°ä½</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ],</span><br><span class="line">            include: [],</span><br><span class="line">            exclude: [</span><br><span class="line">                Root(<span class="string">'src/components'</span>)</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpg|jpeg|gif|eot|woff|woff2|ttf|svg|otf)$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">                &#123;</span><br><span class="line">                    loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        limit: <span class="number">10</span> * <span class="number">1024</span>, <span class="comment">// 10k</span></span><br><span class="line">                        name: isDev ? <span class="string">'images/[name].[ext]'</span> : <span class="string">'images/[name].[hash.[ext]'</span>,</span><br><span class="line">                        publicPath: idDev ? <span class="string">'/'</span> : <span class="string">'cdnåœ°å€'</span>,</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">// prductionï¼Œç”¨äºå›¾ç‰‡å‹ç¼©</span></span><br><span class="line">                &#123;</span><br><span class="line">                    loader: <span class="string">'image-webpack-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        bypassOnDebug: <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// .babelrc</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">        <span class="string">"@babel/preset-react"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"plugins"</span>: [</span><br><span class="line">        <span class="comment">// å„ç§æ’ä»¶</span></span><br><span class="line">        <span class="string">"@babel/propsoal-class-properties"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>plugins</strong> æ’ä»¶<br>  æ’ä»¶ç”¨äºbundleæ–‡ä»¶çš„ä¼˜åŒ–ï¼Œèµ„æºç®¡ç†å’Œç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä½œç”¨äºæ•´ä¸ªæ„å»ºè¿‡ç¨‹</p>
<ul>
<li>webpack-dev-server çƒ­æ›´æ–°<br>  è¯¦æƒ…è¯·å…³æ³¨<a href="/2020/12/15/webpackçƒ­æ›´æ–°åŸç†/">webpackçƒ­æ›´æ–°åŸç†</a></li>
<li>webpack-dev-middleware <blockquote>
<p>å°†webpackè¾“å‡ºæ–‡ä»¶ä¼ è¾“ç»™æœåŠ¡å™¨ï¼Œé€‚ç”¨äºçµæ´»çš„å®šåˆ¶åœºæ™¯</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = requrie(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> webpackDevMiddleware = requrie(<span class="string">'webpack-dev-middleware'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>)</span><br><span class="line"><span class="keyword">const</span> compiler = webpack(config)</span><br><span class="line"></span><br><span class="line">app.use(webpackDevMiddleware(compiler, &#123;</span><br><span class="line">    publicPath: config.output.publicPath</span><br><span class="line">&#125;))</span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure></li>
<li>mini-css-extract-pluginå’Œoptimize-css-assets-webpack-plugin<blockquote>
<p>æå–cssï¼Œå»ºè®®ä½¿ç”¨contenthash</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/.s?css$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">            isDev ? <span class="string">'style-loader'</span> : iniCssExtractPlugin.loader</span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                importLoaders: <span class="number">1</span>,</span><br><span class="line">                <span class="comment">// cssæ¨¡å—åŒ–ä½¿ç”¨</span></span><br><span class="line">                modules: &#123;</span><br><span class="line">                    localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'postcss-loader'</span>,</span><br><span class="line">            <span class="string">'sass-loader'</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// æå–css</span></span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'styles/[name].[contenthash:5].css'</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// å‹ç¼©css</span></span><br><span class="line">        <span class="keyword">new</span> OptimizeCSSAssetsPlugin(&#123;</span><br><span class="line">            assetNameRegExp: <span class="regexp">/\.css$/g</span>,</span><br><span class="line">            cssProcessor: <span class="built_in">require</span>(<span class="string">"cssnano"</span>),<span class="comment">//éœ€è¦å®‰è£…cssnano</span></span><br><span class="line">            cssProcessorPluginOptions: &#123;</span><br><span class="line">            preset: [</span><br><span class="line">                <span class="string">'default'</span>,</span><br><span class="line">                &#123;</span><br><span class="line">                discardComments: &#123;</span><br><span class="line">                    removeAll: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">            &#125;,</span><br><span class="line">            canPrint: <span class="literal">true</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure></li>
<li>html-webpack-plugin <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰å‚æ•°titleä¼ é€’åˆ°htmlä¸­</span></span><br><span class="line">        <span class="comment">// htmlä¸­ä½¿ç”¨&lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</span></span><br><span class="line">        <span class="comment">// &lt;script&gt;let number = &lt;%= htmlWebpackPlugin.options.number %&gt;&lt;script&gt;</span></span><br><span class="line">        number: <span class="number">1</span>,</span><br><span class="line">        title: <span class="string">'äº¬ç¨‹ä¸€ç¯'</span>,</span><br><span class="line">        filename: <span class="string">'index.html'</span>,</span><br><span class="line">        <span class="comment">// chunks: ['index'] //ç”¨äºå¤šé¡µé¢ï¼Œä½¿ç”¨å“ªäº›chunk</span></span><br><span class="line">        template: resolve(__dirname, <span class="string">'/src/index.html'</span>),</span><br><span class="line">        minify: &#123;</span><br><span class="line">        minifyJS: <span class="literal">true</span>,</span><br><span class="line">        minifyCSS: <span class="literal">true</span>,</span><br><span class="line">        removeComments: <span class="literal">true</span>,</span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">        preserveLineBreak: <span class="literal">false</span>,</span><br><span class="line">        removeAttributeQuotes: <span class="literal">true</span>,</span><br><span class="line">        removeComments: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li>clean-webpack-plugin æˆ–è€…ä½¿ç”¨ rimraf dist<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>mode</strong> </p>
<ul>
<li><p>ç”¨æ¥æŒ‡å®šå½“å‰æ„å»ºç¯å¢ƒ developmentã€production å’Œ none</p>
</li>
<li><p>è®¾ç½® mode å¯ä»¥ä½¿ç”¨ wepackå†…ç½®å‡½æ•°ï¼Œå†…éƒ¨è‡ªåŠ¨å¼€å¯ä¸€äº›é…ç½®é¡¹ï¼Œé»˜è®¤å€¼ä¸º production</p>
<p>å†…ç½®åŠŸèƒ½<br>developmentï¼šprocess.env.NODE_ENVä¸ºdevelopment,å¼€å¯NamedChunksPlugin å’Œ NameModulesPlugin<br>è¿™ä¸¤ä¸ªæ’ä»¶ç”¨äºçƒ­æ›´æ–°ï¼Œæ§åˆ¶å°æ‰“å°è·¯å¾„<br>produtionï¼šprocess.env.NODE_ENVä¸ºprodution.å¼€å¯ FlagDependencyUsagePluginã€ModuleConcatenationPluginã€NoEmitOnErrorsPluginï¼ŒOccurrentceOrderPluginã€SideEffectsFlagPluginç­‰<br>noneï¼šä¸å¼€å¯ä»»ä½•ä¼˜åŒ–é€‰é¡¹</p>
</li>
</ul>
</li>
<li><p><strong>watch</strong> </p>
<ul>
<li>æ–‡ä»¶ç›‘å¬å¯ä»¥åœ¨webpackå‘½ä»¤ååŠ ä¸Š â€“watch å‚æ•°ï¼Œæˆ–åœ¨webpack.configä¸­è®¾ç½®watch:trueã€‚ </li>
<li>åŸç†ï¼šè½®è¯¢åˆ¤æ–­æ–‡ä»¶çš„æœ€åç¼–è¾‘æ—¶é—´æ˜¯å¦å˜åŒ–<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤falseï¼Œä¸å¼€å¯</span></span><br><span class="line">    watch: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// åªæœ‰å¼€å¯æ—¶ï¼ŒwatchOptionsæ‰æœ‰æ„ä¹‰</span></span><br><span class="line">    watchOptions: &#123;</span><br><span class="line">        <span class="comment">// å¿½ç•¥ï¼Œæ”¯æŒæ­£åˆ™</span></span><br><span class="line">        ignored: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        <span class="comment">// ç›‘å¬åˆ°å˜åŒ–åç­‰300mså†æ‰§è¡Œï¼Œé»˜è®¤300ms</span></span><br><span class="line">        aggregateTimeout: <span class="number">300</span>,</span><br><span class="line">        <span class="comment">// æ€•ä¹±æ–‡ä»¶æ˜¯å¦å˜åŒ–æ˜¯é€šè¿‡ä¸åœè¯¢é—®ç³»ç»ŸæŒ‡å®šæ–‡ä»¶æœ‰æ²¡å˜åŒ–å®ç°çš„ï¼Œé»˜è®¤æ¯ç§’1000æ¬¡</span></span><br><span class="line">        poll: <span class="number">1000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>æ–‡ä»¶æŒ‡çº¹</p>
<ul>
<li>æ‰“åŒ…åè¾“å‡ºæ–‡ä»¶ååç¼€ï¼Œä¹Ÿå°±æ˜¯hashå€¼</li>
<li>hashï¼šå’Œæ•´ä¸ªé¡¹ç›®æ„å»ºç›¸å…³ï¼Œåªè¦é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶ä¿®æ”¹ï¼Œæ•´ä¸ªé¡¹ç›®ä¸­çš„æ–‡ä»¶hashéƒ½ä¼šä¿®æ”¹æˆç»Ÿä¸€çš„ä¸€ä¸ª</li>
<li>chunkhashï¼šå’Œwebpckæ‰“åŒ…çš„chunkæœ‰å…³ï¼Œä¸åŒçš„entryä¼šç”Ÿæˆä¸åŒçš„chunkhashå€¼ï¼ˆé€‚ç”¨äºjsæ–‡ä»¶ï¼‰</li>
<li>contenthashï¼šæ ¹æ®æ–‡ä»¶å†…å®¹å®šä¹‰hashï¼Œæ–‡ä»¶å†…å®¹ä¸å˜ï¼Œåˆ™contenthashä¸å˜ï¼Œç”¨äºæ‰¹é‡æ›´æ–°ï¼ˆé€‚ç”¨äºcssæ–‡ä»¶ï¼‰</li>
</ul>
</li>
<li><p>ä¼˜åŒ–å‘½ä»¤è¡Œæ—¥å¿—</p>
<ul>
<li>ç»Ÿè®¡ä¿¡æ¯ statsï¼Œwebpackå±æ€§ï¼Œè¿™ç§æ–¹å¼ä¸å¥½<br>  error-onlyï¼šå€¼å‘ç”Ÿé”™è¯¯æ—¶è¾“å‡º<br>  minimalï¼šåªåœ¨å‘ç”Ÿé”™è¯¯æˆ–æœ‰æ–°çš„ç¼–è¯‘æ—¶è¾“å‡º<br>  noneï¼šæ²¡æœ‰è¾“å‡º<br>  normalï¼šæ ‡å‡†è¾“å‡ºï¼Œé»˜è®¤<br>  verboseï¼šå…¨éƒ¨è¾“å‡º<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// development</span></span><br><span class="line">devServer: &#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">    stats: <span class="string">'errors-only'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// production</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    stats: <span class="string">'errors-only'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>statsç»“åˆfriendly-errors-webpack-pluginï¼ˆæ¨èï¼‰<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> FriendlyErrorsPlugin()</span><br><span class="line">],</span><br><span class="line">stats: <span class="string">'errors-only'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†</p>
<ul>
<li><p>wepback4ä¹‹å‰çš„ç‰ˆæœ¬æ„å»ºå¤±è´¥ä¸ä¼šè·‘å‡ºé”™è¯¯ç </p>
</li>
<li><p>nodeä¸­çš„process.exitè§„èŒƒ<br>  0 è¡¨ç¤ºæˆåŠŸå®Œæˆï¼Œå›è°ƒå‡½æ•°ä¸­ï¼Œerr ä¸º null<br>  é0 è¡¨ç¤ºæ‰§è¡Œå¤±è´¥ï¼Œå›è°ƒå‡½æ•°ä¸­ï¼Œerr ä¸ä¸ºç©ºï¼Œerr.codeå°±æ˜¯ä¼ ç»™exitçš„æ•°å­—</p>
</li>
<li><p>ä¸»åŠ¨æ•è·é”™è¯¯ï¼Œå¹¶å¤„ç†æ„å»ºé”™è¯¯</p>
<ul>
<li>å†™ä¸ªæ’ä»¶ï¼Œcompiler åœ¨æ¯æ¬¡æ„å»ºç»“æŸåä¼šå‡ºå‘doneè¿™ä¸ªhook</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// webpack3 this.plugin('done', (stats) =&gt; &#123;&#125;)</span></span><br><span class="line">        <span class="comment">// webpack4</span></span><br><span class="line">        <span class="keyword">this</span>.hooks.done.tap(<span class="string">'done'</span>, (stats) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (stats.compilation.errors &amp;&amp; stats.compilation.errors.length &amp;&amp; process.argv.indexOf(<span class="string">'--watch'</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'build error'</span>);</span><br><span class="line">            <span class="comment">// dosomething</span></span><br><span class="line">            process.exit(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;    </span><br><span class="line">]</span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<blockquote>
<p>æœ¬åšå®¢ç¬”è®°å†…å®¹ä¸»è¦æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å…¬ä¼—å· å‰ç«¯å…ˆé”‹ </p>
</blockquote>
]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>vueå®šä¹‰å…¨å±€æ–¹æ³•</title>
    <url>/2020/11/05/vue%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h3 id="ä¸€ã€å°†æ–¹æ³•æŒ‚åœ¨åˆ°vueåŸå‹-Vue-prototype-ä¸Š"><a href="#ä¸€ã€å°†æ–¹æ³•æŒ‚åœ¨åˆ°vueåŸå‹-Vue-prototype-ä¸Š" class="headerlink" title="ä¸€ã€å°†æ–¹æ³•æŒ‚åœ¨åˆ°vueåŸå‹(Vue.prototype)ä¸Š"></a>ä¸€ã€å°†æ–¹æ³•æŒ‚åœ¨åˆ°vueåŸå‹(Vue.prototype)ä¸Š</h3><ul>
<li><p>å®šä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// global.js</span></span><br><span class="line"><span class="keyword">const</span> Func = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'global'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    Func</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨main.jsä¸­é…ç½®</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> global <span class="keyword">from</span> <span class="string">'@/global'</span></span><br><span class="line">object.keys(global).forEach(<span class="function">(<span class="params">key</span>)=&gt;</span>&#123;</span><br><span class="line">    Vue.prototype[<span class="string">'$global'</span> + key] = global[key]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    mounted()&#123;</span><br><span class="line">        <span class="keyword">this</span>.$globalFunc()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç¼ºç‚¹ï¼Œè°ƒç”¨çš„æ—¶å€™ï¼Œæ²¡æœ‰æ–¹æ³•æç¤º</p>
</blockquote>
</li>
</ul>
<h3 id="äºŒã€å…¨å±€æ··å…¥mixin"><a href="#äºŒã€å…¨å±€æ··å…¥mixin" class="headerlink" title="äºŒã€å…¨å±€æ··å…¥mixin"></a>äºŒã€å…¨å±€æ··å…¥mixin</h3><ul>
<li>å®šä¹‰ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mixin.js</span></span><br><span class="line"><span class="keyword">const</span> mixin = &#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">        func()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'global'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mixin</span><br></pre></td></tr></table></figure></li>
<li>åœ¨main.jsä¸­é…ç½®<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> mixin <span class="keyword">from</span> <span class="string">'@/mixin'</span></span><br><span class="line">Vue.mixin(mixin)</span><br></pre></td></tr></table></figure></li>
<li>åœ¨vueæ–‡ä»¶ä¸­ä½¿ç”¨<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    mounted()&#123;</span><br><span class="line">        <span class="keyword">this</span>.func()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>mixiné‡Œçš„methodsä¼šå’Œåˆ›å»ºçš„æ¯ä¸ªå•æ–‡ä»¶ç»„ä»¶åˆå¹¶ï¼Œè°ƒç”¨æ–¹æ³•æ—¶æœ‰æç¤º</p>
</blockquote>
</li>
</ul>
<h3 id="ä¸‰ã€ä½¿ç”¨Plugin"><a href="#ä¸‰ã€ä½¿ç”¨Plugin" class="headerlink" title="ä¸‰ã€ä½¿ç”¨Plugin"></a>ä¸‰ã€ä½¿ç”¨Plugin</h3><blockquote>
<p>Vue.useçš„å®ç°æœ¬èº«æ²¡æœ‰æŒ‚è½½åŠŸèƒ½ï¼Œåªæ˜¯è§¦å‘äº†æ’ä»¶çš„installæ–¹æ³•ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨äº†<code>Vue.prototype</code></p>
</blockquote>
<ul>
<li><p>å®šä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// plugin.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'global'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> plugin = &#123;</span><br><span class="line">    <span class="comment">// installæ˜¯pluginä¸­é»˜è®¤çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// å½“å¤–ç•Œåœ¨useè¿™ä¸ªç»„ä»¶æˆ–å‡½æ•°çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨æœ¬èº«çš„installæ–¹æ³•ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ªVueè¿™ä¸ªç±»çš„å‚æ•°</span></span><br><span class="line">    install: <span class="function"><span class="keyword">function</span>(<span class="params">Vue</span>)</span>&#123;</span><br><span class="line">        Vue.prototype.$pluginGlobalFunc = func</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> plugin</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨main.jsä¸­é…ç½®</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> plugin <span class="keyword">from</span> <span class="string">'@/plugin'</span></span><br><span class="line">Vue.use(plugin)</span><br></pre></td></tr></table></figure></li>
<li><p>åœ¨vueæ–‡ä»¶ä¸­ä½¿ç”¨</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    mounted()&#123;</span><br><span class="line">        <span class="keyword">this</span>.$pluginGlobalFunc()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>mixiné‡Œçš„methodsä¼šå’Œåˆ›å»ºçš„æ¯ä¸ªå•æ–‡ä»¶ç»„ä»¶åˆå¹¶ï¼Œè°ƒç”¨æ–¹æ³•æ—¶æœ‰æç¤º</p>
</blockquote>
</li>
</ul>
<h3 id="å››ä»»æ„vueæ–‡ä»¶ä¸­å†™å…¨å±€å‡½æ•°"><a href="#å››ä»»æ„vueæ–‡ä»¶ä¸­å†™å…¨å±€å‡½æ•°" class="headerlink" title="å››ä»»æ„vueæ–‡ä»¶ä¸­å†™å…¨å±€å‡½æ•°"></a>å››ä»»æ„vueæ–‡ä»¶ä¸­å†™å…¨å±€å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºå…¨å±€æ–¹æ³•</span></span><br><span class="line"><span class="keyword">this</span>.$root.$on(<span class="string">'func'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'global'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é”€æ¯å…¨å±€æ–¹æ³•</span></span><br><span class="line"><span class="keyword">this</span>.$root.$off(<span class="string">'func'</span>);</span><br><span class="line"><span class="comment">// è°ƒç”¨å…¨å±€æ–¹æ³•</span></span><br><span class="line"><span class="keyword">this</span>.$root.$emit(<span class="string">'func'</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœ¬ç« å†…å®¹ä¸»è¦æ¥è‡ªäº¬åŸä¸€ç¯</p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä¸­ä½¿ç”¨svgå›¾æ ‡</title>
    <url>/2020/11/03/vue%E4%B8%AD%E4%BD%BF%E7%94%A8svg%E5%9B%BE%E6%A0%87/</url>
    <content><![CDATA[<h3 id="å¯¹svgå›¾æ ‡çš„ç®€å•å®ç”¨å’Œè®¤è¯†"><a href="#å¯¹svgå›¾æ ‡çš„ç®€å•å®ç”¨å’Œè®¤è¯†" class="headerlink" title="å¯¹svgå›¾æ ‡çš„ç®€å•å®ç”¨å’Œè®¤è¯†"></a>å¯¹svgå›¾æ ‡çš„ç®€å•å®ç”¨å’Œè®¤è¯†</h3><p><a href="/2020/07/04/svgå›¾æ ‡çš„ä½¿ç”¨/">svgå›¾æ ‡çš„ä½¿ç”¨</a></p>
<h3 id="åœ¨Vueé¡¹ç›®ä¸­å†™ä¸€ä¸ªsvgç»„ä»¶"><a href="#åœ¨Vueé¡¹ç›®ä¸­å†™ä¸€ä¸ªsvgç»„ä»¶" class="headerlink" title="åœ¨Vueé¡¹ç›®ä¸­å†™ä¸€ä¸ªsvgç»„ä»¶"></a>åœ¨Vueé¡¹ç›®ä¸­å†™ä¸€ä¸ªsvgç»„ä»¶</h3><ul>
<li>å®‰è£…<a class="link"   href="https://www.npmjs.com/package/svg-sprite-loader"  target="_blank" rel="noopener">svg-sprite-loader<i class="fas fa-external-link-alt"></i></a>æ’ä»¶å¯¹svgæ–‡ä»¶è¿›è¡Œç¼–è¯‘è§£æ<br>  <code>yarn add svg-sprite-loader</code></li>
<li>åœ¨<code>src/assets/</code>ç›®å½•ä¸‹æ–°å»º<code>icons</code>ç›®å½•ï¼Œå­˜æ”¾éœ€è¦ç”¨åˆ°çš„svgå›¾æ ‡</li>
<li>åœ¨vue-cli4ä¸­ï¼Œå¯¹<code>vue.config.js</code>è¿›è¡Œé…ç½®  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// set svg-sprite-loader</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€æ­¥ï¼šè®©å…¶ä»–svg loaderä¸è¦å¯¹svgè¿›è¡Œæ“ä½œ</span></span><br><span class="line">    config.module</span><br><span class="line">    .rule(<span class="string">'svg'</span>)</span><br><span class="line">    .exclude.add(path.join(__dirname, <span class="string">'src/assets/icons'</span>))</span><br><span class="line">    .end()</span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ­¥ï¼šä½¿ç”¨svg-sprite-loader å¯¹svgè¿›è¡Œæ“ä½œ</span></span><br><span class="line">    config.module</span><br><span class="line">    .rule(<span class="string">'icons'</span>)</span><br><span class="line">    .test(<span class="regexp">/\.svg$/</span>)</span><br><span class="line">    .include.add(path.join(__dirname, <span class="string">'src/assets/icons'</span>))</span><br><span class="line">    .end()</span><br><span class="line">    .use(<span class="string">'svg-sprite-loader'</span>)</span><br><span class="line">    .loader(<span class="string">'svg-sprite-loader'</span>)</span><br><span class="line">    <span class="comment">//å®šä¹‰è§„åˆ™ ä½¿ç”¨æ—¶ &lt;svg class="icon"&gt; &lt;use xlink:href="#icon-svgæ–‡ä»¶å"&gt;&lt;/use&gt;&lt;/svg&gt;</span></span><br><span class="line">    .options(&#123;</span><br><span class="line">        symbolId: <span class="string">'icon-[name]'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .end()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>å¦‚æœæ˜¯vue-cli2ä¸­ï¼Œé…ç½®<code>build/webpack.base.conf.js</code>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.svg$/</span>,</span><br><span class="line">                loader: <span class="string">"svg-sprite-loader"</span>,</span><br><span class="line">                include: [resolve(<span class="string">"src/assets/icons"</span>)],</span><br><span class="line">                options: &#123;</span><br><span class="line">                symbolId: <span class="string">"icon-[name]"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">                loader: <span class="string">"url-loader"</span>,</span><br><span class="line">                exclude: [resolve(<span class="string">"src/assets/icons"</span>)],</span><br><span class="line">                options: &#123;</span><br><span class="line">                limit: <span class="number">10000</span>,</span><br><span class="line">                name: utils.assetsPath(<span class="string">"img/[name].[hash:7].[ext]"</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>åœ¨iconsç›®å½•ä¸‹ï¼Œæ–°å»º<code>index.js</code>æ–‡ä»¶  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> SvgIcon <span class="keyword">from</span> <span class="string">'@/components/common/svgIcon'</span></span><br><span class="line"><span class="comment">// å…¨å±€æ³¨å†Œç»„ä»¶</span></span><br><span class="line">Vue.component(<span class="string">'svg-icon'</span>, SvgIcon)</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªåŠ è½½ç›®å½•çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> requireAll = <span class="function"><span class="params">requireContext</span> =&gt;</span> &#123;</span><br><span class="line">    requireContext.keys().map(requireContext)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> req = <span class="built_in">require</span>.context(<span class="string">'@/assets/icons'</span>, <span class="literal">false</span>, /\.svg$/)</span><br><span class="line"><span class="comment">// åŠ è½½ç›®å½•ä¸‹çš„æ‰€æœ‰ svg æ–‡ä»¶</span></span><br><span class="line">requireAll(req)</span><br></pre></td></tr></table></figure></li>
<li>ä¸Šè¿°<code>index.js</code>ä¸­ï¼Œå¼•ç”¨äº†<code>svgIcon</code>ç»„ä»¶ï¼Œåœ¨å¯¹åº”çš„å¼•ç”¨è·¯å¾„ä¸‹æ–°å»º<code>svgIcon.vue</code>æ–‡ä»¶  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;svg :class&#x3D;&quot;svgClass&quot; aria-hidden&#x3D;&quot;true&quot;&gt;</span><br><span class="line">        &lt;use :xlink:href&#x3D;&quot;iconName&quot;&gt;&lt;&#x2F;use&gt;</span><br><span class="line">    &lt;&#x2F;svg&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &#39;svg-icon&#39;,</span><br><span class="line">        props: &#123;</span><br><span class="line">            &#x2F;&#x2F; ç»„ä»¶æ ·å¼ï¼Œå¯ä»¥æ§åˆ¶svgå›¾æ ‡</span><br><span class="line">            iconClass: &#123;</span><br><span class="line">                type: String,</span><br><span class="line">                required: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#x2F;&#x2F; ä½¿ç”¨svgæ–‡ä»¶åçš„æ–¹å¼ä½¿ç”¨å¯¹åº”svgå›¾æ ‡</span><br><span class="line">            className: &#123;</span><br><span class="line">                type: String</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">            iconName() &#123;</span><br><span class="line">                return &#96;#icon-$&#123;this.iconClass&#125;&#96;</span><br><span class="line">            &#125;,</span><br><span class="line">            svgClass() &#123;</span><br><span class="line">                if (this.className) &#123;</span><br><span class="line">                    return &#39;svg-icon &#39; + this.className</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    return &#39;svg-icon&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.svg-icon &#123;</span><br><span class="line">    float: left;</span><br><span class="line">    margin: 4px 6px 0 0;</span><br><span class="line">    width: 13px;</span><br><span class="line">    height: 13px;</span><br><span class="line">    vertical-align: 1px;</span><br><span class="line">    fill: #e1e1e1;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure></li>
<li>åœ¨<code>main.js</code>ä¸­å¼•å…¥<br>  <code>import &#39;./assets/icons&#39;</code></li>
<li>ä½¿ç”¨svg-icon  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;svg-icon</span><br><span class="line">    :iconClass&#x3D;&quot;&#39;download&#39;&quot;   &#x2F;&#x2F;è¦†ç›–æ ·å¼ç±»å</span><br><span class="line">    className&#x3D;&quot;downloadIcon&quot;  &#x2F;&#x2F;æ–‡ä»¶å</span><br><span class="line">&gt;&lt;&#x2F;svg-icon&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>svg</tag>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯å¦‚ä½•é˜²èŒƒxssæ”»å‡»</title>
    <url>/2020/09/10/%E5%89%8D%E7%AB%AF%E5%A6%82%E4%BD%95%E9%98%B2%E8%8C%83xss%E6%94%BB%E5%87%BB/</url>
    <content><![CDATA[<h5 id="xssæ˜¯ä»€ä¹ˆ"><a href="#xssæ˜¯ä»€ä¹ˆ" class="headerlink" title="xssæ˜¯ä»€ä¹ˆ"></a>xssæ˜¯ä»€ä¹ˆ</h5><p>  Cross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ç®€ç§° XSSï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œã€‚åˆ©ç”¨è¿™äº›æ¶æ„è„šæœ¬ï¼Œæ”»å‡»è€…å¯è·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯å¦‚ Cookieã€SessionID ç­‰ï¼Œè¿›è€Œå±å®³æ•°æ®å®‰å…¨ã€‚ä¸ºäº†å’Œ CSS åŒºåˆ†ï¼Œè¿™é‡ŒæŠŠæ”»å‡»çš„ç¬¬ä¸€ä¸ªå­—æ¯æ”¹æˆäº† Xï¼Œäºæ˜¯å«åš XSSã€‚</p>
<p>  XSS çš„æœ¬è´¨æ˜¯ï¼šæ¶æ„ä»£ç æœªç»è¿‡æ»¤ï¼Œä¸ç½‘ç«™æ­£å¸¸çš„ä»£ç æ··åœ¨ä¸€èµ·ï¼›æµè§ˆå™¨æ— æ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œã€‚</p>
<h5 id="æ€ä¹ˆåŠ"><a href="#æ€ä¹ˆåŠ" class="headerlink" title="æ€ä¹ˆåŠ"></a>æ€ä¹ˆåŠ</h5><ul>
<li><p>è¾“å…¥è¿‡æ»¤</p>
<p>â€‹    è¾“å…¥è¿‡æ»¤å°±åœ¨åå°æ¥å£å¤„ç†æ•°æ®æ—¶åˆé€‚ï¼Œåšä¸ªæ•°æ®è½¬ä¹‰</p>
</li>
<li><p>æ¸²æŸ“æ—¶å¤„ç†</p>
<p>â€‹    ä¼ ç»Ÿå‰ç«¯ï¼Œæ‹¼æ¥ HTMLåŠä½¿ç”¨ <code>.innerHTML</code>ã€<code>.outerHTML</code>ã€<code>document.write()</code>å°†æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Šæ—¶ï¼Œå¾ˆå®¹æ˜“å°†ä¸å¯ä¿¡çš„é—®é¢˜æ•°æ®æ’åˆ°é¡µé¢ä¸Šã€‚</p>
<p>â€‹    Sdkå‰ç«¯é¡¹ç›®ï¼Œä½¿ç”¨Vueæ¡†æ¶ã€‚Vueæ¡†æ¶åœ¨æ¸²æŸ“å‰ï¼Œä¼šå°†templateæ¨¡æ¿ç¼–è¯‘ä¸ºè™šæ‹ŸDomæ ‘ï¼Œå‡å°‘äº† encode æ“ä½œï¼Œå‡å°‘äº† XSS éšæ‚£ã€‚</p>
</li>
</ul>
<pre><code>ä½†æ˜¯ï¼Œä½¿ç”¨`v-html`æ—¶ä¼šæœ‰é—®é¢˜ï¼Œè¿™ä¸€ç‚¹åœ¨vueå®˜æ–¹æ–‡æ¡£ä¸­æœ‰æåˆ°ï¼š![v-html](http://i.feidom.com/Vhtml.jpg)

è§£å†³æ–¹æ¡ˆï¼š

  * å°½é‡ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼`{{}}`ï¼Œå®ƒä¼šæŠŠè¦æ˜¾ç¤ºçš„å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²ã€‚

  * å¦‚æœä½¿ç”¨v-htmlï¼Œè¦ä¿è¯æ¥è‡ªæœåŠ¡ç«¯çš„æ¸²æŸ“æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ã€‚

  * åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹UIç»„ä»¶åº“çš„çš„æ—¶å€™ï¼Œè¦æ£€æŸ¥ä¸€ä¸‹å®ƒä»¬æ¸²æŸ“é¡µé¢çš„æ–¹å¼ï¼Œæ˜¯å¦ä½¿ç”¨äº† v-htmlã€‚

  * æœ‰çš„æ—¶å€™å®åœ¨ç»•ä¸å¼€ï¼Œå¿…é¡»ç”¨ã€‚é‚£å°±ç”¨[lodashçš„_.template](https://www.lodashjs.com/docs/lodash.template)åšä¸€å±‚å­—ç¬¦ä¸²é€ƒé€¸æ“ä½œï¼Œå†å¡ç»™ v-html å°±è¡Œã€‚

    <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var template &#x3D; _.template(&quot;&lt;%- value %&gt;&quot;);</span><br><span class="line">template(&#123;value: &#39;&lt;script&gt;&#39;&#125;);</span><br><span class="line">è¾“å‡º &#x3D;&#x3D;&gt; &lt;script&gt;</span><br></pre></td></tr></table></figure></code></pre><ul>
<li>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“<a class="link"   href="https://www.npmjs.com/package/xss"  target="_blank" rel="noopener">xss<i class="fas fa-external-link-alt"></i></a>,<a class="link"   href="https://github.com/leizongmin/js-xss/blob/master/README.zh.md"  target="_blank" rel="noopener">ä¸­æ–‡æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a></li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯å®‰å…¨</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä½¿ç”¨jesté—®é¢˜è§£å†³</title>
    <url>/2020/09/03/vue%E4%BD%BF%E7%94%A8jest%E6%97%B6%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</url>
    <content><![CDATA[<p>vueé¡¹ç›®ä¸­ç”¨jestæµ‹è¯•æ—¶ï¼Œé‡åˆ°å‡ ä¸ªé—®é¢˜ï¼Œåœ¨è¿™è®°å½•ä»¥ä¸‹è¸©çš„å‘ï¼Œä»¥åçˆ¬å¾—å¿«ã€‚</p>
<h4 id="SecurityError-localStorage-is-not-available-for-opaque-origins"><a href="#SecurityError-localStorage-is-not-available-for-opaque-origins" class="headerlink" title="SecurityError: localStorage is not available for opaque origins"></a>SecurityError: localStorage is not available for opaque origins</h4><p>è¯¦ç»†æŠ¥é”™å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Test suite failed to run</span><br><span class="line"></span><br><span class="line">SecurityError: localStorage is not available for opaque origins</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">at Window.get localStorage [as localStorage] (node_modules&#x2F;jsdom&#x2F;lib&#x2F;jsdom&#x2F;browser&#x2F;Window.js:257:15)</span><br><span class="line">          at Array.forEach (&lt;anonymous&gt;)</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•ï¼š<br>åœ¨<code>jest.conf.js</code>æ–‡ä»¶ä¸­ï¼Œå¢åŠ é…ç½®<code>testURL: &quot;http://localhost/&quot;</code>ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    ...,</span><br><span class="line">    testURL: &quot;http:&#x2F;&#x2F;localhost&#x2F;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="HandlebarsæŠ¥é”™"><a href="#HandlebarsæŠ¥é”™" class="headerlink" title="HandlebarsæŠ¥é”™"></a>HandlebarsæŠ¥é”™</h4><p>å¯¼è‡´æµ‹è¯•æŠ¥å‘Šæ²¡æœ‰æ•°æ®å±•ç¤ºï¼Œè¯¦ç»†æŠ¥é”™å¦‚ä¸‹ï¼š<br><img src="http://i.feidom.com/handlebars_error.png" alt="handlebarsæŠ¥é”™"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Handlebars: Access has been denied to resolve the property &quot;statements&quot; because it is not an &quot;own property&quot; of its parent.</span><br><span class="line">You can add a runtime option to disable the check or this warning:</span><br><span class="line">See https:&#x2F;&#x2F;handlebarsjs.com&#x2F;api-reference&#x2F;runtime-options.html#options-to-control-prototype-access for details</span><br><span class="line">Handlebars: Access has been denied to resolve the property &quot;branches&quot; because it is not an &quot;own property&quot; of its parent.</span><br><span class="line">You can add a runtime option to disable the check or this warning:</span><br><span class="line">See https:&#x2F;&#x2F;handlebarsjs.com&#x2F;api-reference&#x2F;runtime-options.html#options-to-control-prototype-access for details</span><br><span class="line">Handlebars: Access has been denied to resolve the property &quot;functions&quot; because it is not an &quot;own property&quot; of its parent.</span><br><span class="line">You can add a runtime option to disable the check or this warning:</span><br><span class="line">See https:&#x2F;&#x2F;handlebarsjs.com&#x2F;api-reference&#x2F;runtime-options.html#options-to-control-prototype-access for details</span><br><span class="line">Handlebars: Access has been denied to resolve the property &quot;lines&quot; because it is not an &quot;own property&quot; of its parent.</span><br><span class="line">You can add a runtime option to disable the check or this warning:</span><br><span class="line">See https:&#x2F;&#x2F;handlebarsjs.com&#x2F;api-reference&#x2F;runtime-options.html#options-to-control-prototype-access for details</span><br></pre></td></tr></table></figure>
<p><a class="link"   href="https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access"  target="_blank" rel="noopener">æŠ¥é”™åŸå› <i class="fas fa-external-link-alt"></i></a>è¯´çš„å¾ˆæ¸…æ¥šï¼Œæ˜¯Handlebarsç‰ˆæœ¬çš„é—®é¢˜ã€‚<br>è§£å†³æ–¹æ³•ï¼š</p>
<ol>
<li>ç§»é™¤node_moudulesåŒ…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rm -rf node_moudules</span><br></pre></td></tr></table></figure></li>
<li>åœ¨package.jsonæ–‡ä»¶ä¸­ï¼Œæ–°å¢<code>&quot;handlebars&quot;: &quot;4.5.0&quot;,</code>è¿™ä¸ªåŒ…,ç›¸å½“äºæ‰‹åŠ¨æ·»åŠ è¿™ä¸ªåŒ…<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    ...,</span><br><span class="line">    <span class="string">"handlebars"</span>: <span class="string">"4.5.0"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><code>yarn.lock</code>è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œä¿®æ”¹handlebarsçš„åŒ…é…ç½®å’Œæ‰€æœ‰ä¾èµ–handlebarsåŒ…çš„åŒ…é…ç½®<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">handlebars@^4.0.3:</span><br><span class="line">    version &quot;4.7.6&quot;</span><br></pre></td></tr></table></figure>
æ”¹ä¸º==ã€‹<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">handlebars@4.5.0:</span><br><span class="line">  version &quot;4.5.0&quot;</span><br></pre></td></tr></table></figure>
ä¿®æ”¹ä¾èµ–handlebarsçš„åŒ…çš„é…ç½®<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">istanbul-reports@^1.5.1:</span><br><span class="line">  version &quot;1.5.1&quot;</span><br><span class="line">  resolved &quot;https:&#x2F;&#x2F;registry.yarnpkg.com&#x2F;istanbul-reports&#x2F;-&#x2F;istanbul-reports-1.5.1.tgz#97e4dbf3b515e8c484caea15d6524eebd3ff4e1a&quot;</span><br><span class="line">  integrity sha512-+cfoZ0UXzWjhAdzosCPP3AN8vvef8XDkWtTfgaN+7L3YTpNYITnCaEkceo5SEYy644VkHka&#x2F;P1FvkWvrG&#x2F;rrJw&#x3D;&#x3D;</span><br><span class="line">  dependencies:</span><br><span class="line">    handlebars &quot;^4.0.3&quot;</span><br></pre></td></tr></table></figure>
æ”¹ä¸º==ã€‹<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">istanbul-reports@^1.5.1:</span><br><span class="line">  version &quot;1.5.1&quot;</span><br><span class="line">  resolved &quot;https:&#x2F;&#x2F;registry.yarnpkg.com&#x2F;istanbul-reports&#x2F;-&#x2F;istanbul-reports-1.5.1.tgz#97e4dbf3b515e8c484caea15d6524eebd3ff4e1a&quot;</span><br><span class="line">  integrity sha512-+cfoZ0UXzWjhAdzosCPP3AN8vvef8XDkWtTfgaN+7L3YTpNYITnCaEkceo5SEYy644VkHka&#x2F;P1FvkWvrG&#x2F;rrJw&#x3D;&#x3D;</span><br><span class="line">  dependencies:</span><br><span class="line">    handlebars &quot;4.5.0&quot;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="è­¦å‘Šï¼šmapCoverageè¿™ä¸ªé…ç½®åº”è¯¥è¢«ç§»é™¤ï¼Œå› ä¸ºè®¡ç®—è¦†ç›–ç‡çš„æ—¶é—´å¹¶ä¸é•¿"><a href="#è­¦å‘Šï¼šmapCoverageè¿™ä¸ªé…ç½®åº”è¯¥è¢«ç§»é™¤ï¼Œå› ä¸ºè®¡ç®—è¦†ç›–ç‡çš„æ—¶é—´å¹¶ä¸é•¿" class="headerlink" title="è­¦å‘Šï¼šmapCoverageè¿™ä¸ªé…ç½®åº”è¯¥è¢«ç§»é™¤ï¼Œå› ä¸ºè®¡ç®—è¦†ç›–ç‡çš„æ—¶é—´å¹¶ä¸é•¿"></a>è­¦å‘Šï¼šmapCoverageè¿™ä¸ªé…ç½®åº”è¯¥è¢«ç§»é™¤ï¼Œå› ä¸ºè®¡ç®—è¦†ç›–ç‡çš„æ—¶é—´å¹¶ä¸é•¿</h4><ul>
<li><p>è¯¦ç»†è­¦å‘Šå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Deprecation Warning:</span><br><span class="line"></span><br><span class="line">  Option &quot;mapCoverage&quot; has been removed, as it&#39;s no longer necessary.</span><br><span class="line"></span><br><span class="line">  Please update your configuration.</span><br><span class="line"></span><br><span class="line">  Configuration Documentation:</span><br><span class="line">  https:&#x2F;&#x2F;facebook.github.io&#x2F;jest&#x2F;docs&#x2F;configuration.html</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿™ä¸ªé…ç½®åœ¨jesté…ç½®æ–‡æ¡£ä¸­çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
</li>
</ul>
<p>If you have transformers configured that emit source maps, Jest will use them to try and map code coverage against the original source code when writing reports and checking thresholds. This is done on a best-effort basis as some compile-to-JavaScript languages may provide more accurate source maps than others. This can also be resource-intensive. If Jest is taking a long time to calculate coverage at the end of a test run, try setting this option to false.</p>
<p>Both inline source maps and source maps returned directly from a transformer are supported. Source map URLs are not supported because Jest may not be able to locate them. To return source maps from a transformer, the process function can return an object like the following. The map property may either be the source map object, or the source map object as a JSON string.</p>
<p>å¤§è‡´æ„æ€æ˜¯ï¼š<br>*å¦‚æœæ‚¨é…ç½®äº†å‘å‡ºæºæ˜ å°„çš„è½¬æ¢å™¨ï¼Œé‚£ä¹ˆåœ¨ç¼–å†™æŠ¥å‘Šå’Œæ£€æŸ¥é˜ˆå€¼æ—¶ï¼ŒJestå°†ä½¿ç”¨å®ƒä»¬æ¥å°è¯•å°†ä»£ç è¦†ç›–ç‡æ˜ å°„åˆ°åŸå§‹æºä»£ç ä¸Šã€‚è¿™æ ·åšéœ€è¦ä»˜å‡ºæœ€å¤§çš„åŠªåŠ›ï¼Œå› ä¸ºä¸€äº›ç¼–è¯‘åˆ°javascriptçš„è¯­è¨€å¯èƒ½æ¯”å…¶ä»–è¯­è¨€æä¾›æ›´å‡†ç¡®çš„æºæ˜ å°„ã€‚è¿™ä¹Ÿå¯ä»¥æ˜¯èµ„æºå¯†é›†å‹çš„ã€‚å¦‚æœJeståœ¨æµ‹è¯•è¿è¡Œç»“æŸæ—¶èŠ±è´¹å¾ˆé•¿æ—¶é—´æ¥è®¡ç®—è¦†ç›–ç‡ï¼Œè¯·å°è¯•å°†æ­¤é€‰é¡¹è®¾ç½®ä¸ºfalseã€‚</p>
<p>æ”¯æŒå†…è”æºæ˜ å°„å’Œä»è½¬æ¢å™¨ç›´æ¥è¿”å›çš„æºæ˜ å°„ã€‚ä¸æ”¯æŒæºæ˜ å°„urlï¼Œå› ä¸ºJestå¯èƒ½æ— æ³•å®šä½å®ƒä»¬ã€‚è¦ä»è½¬æ¢å™¨è¿”å›æºæ˜ å°„ï¼Œprocesså‡½æ•°å¯ä»¥è¿”å›å¦‚ä¸‹æ‰€ç¤ºçš„å¯¹è±¡ã€‚mapå±æ€§å¯ä»¥æ˜¯æºæ˜ å°„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯JSONå­—ç¬¦ä¸²å½¢å¼çš„æºæ˜ å°„å¯¹è±¡ã€‚</p>
<ul>
<li>è§£å†³æ–¹æ³•ï¼š<br>åœ¨<code>jest.conf.js</code>æ–‡ä»¶ä¸­ï¼Œç§»é™¤<code>mapCoverage:true</code>è¿™ä¸ªé…ç½®ã€‚</li>
</ul>
]]></content>
      <tags>
        <tag>é—®é¢˜è§£å†³</tag>
        <tag>å•å…ƒæµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>astæŠ½è±¡è¯­æ³•æ ‘</title>
    <url>/2020/08/31/ast%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91/</url>
    <content><![CDATA[<p>å°½ç®¡é€šå¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®ä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚â€” ã€Šä½ ä¸çŸ¥é“çš„js(ä¸Š)ã€‹</p>
<h3 id="ä»£ç æ‰§è¡Œå‰çš„æ­¥éª¤-ç¼–è¯‘"><a href="#ä»£ç æ‰§è¡Œå‰çš„æ­¥éª¤-ç¼–è¯‘" class="headerlink" title="ä»£ç æ‰§è¡Œå‰çš„æ­¥éª¤-ç¼–è¯‘"></a>ä»£ç æ‰§è¡Œå‰çš„æ­¥éª¤-ç¼–è¯‘</h3><p>ä¸‹å›¾æ˜¯ç®€æ˜“çš„é‡ç‚¹æµç¨‹ï¼Œå®é™…jsçš„ç¼–è¯‘è¦å¤æ‚çš„å¤š</p>
<ul>
<li>è¯æ³•åˆ†æï¼ˆæ‰«æscannerï¼‰<br>  è¿™ä¸ªè¿‡ç¨‹å°†ç”±å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²åˆ†è§£ä¸ºæœ‰æ„ä¹‰çš„ä»£ç å—ï¼Œè¿™äº›ä»£ç å—å«â€œè¯æ³•å•å…ƒâ€ã€‚<br>  å¦‚ï¼š <code>let a = 2;</code> å°†è¢«åˆ†æä¸º<code>[let, a, =, 2]</code>è¿™äº›è¯æ³•å•å…ƒã€‚ç©ºæ ¼ç®—ä¸ç®—å–å†³äºç©ºæ ¼åœ¨è¿™é—¨è¯­è¨€ä¸­æ˜¯å¦æœ‰æ„ä¹‰<blockquote>
<p><a class="link"   href="https://github.com/antlr/grammars-v4"  target="_blank" rel="noopener">grammars-v4<i class="fas fa-external-link-alt"></i></a>ä¸­æœ‰æ‰€æœ‰è¯­è¨€çš„è¯­æ³•è§„åˆ™ï¼Œä¹ŸåŒ…æ‹¬jsã€‚</p>
</blockquote>
</li>
<li>è¯­æ³•åˆ†æï¼ˆè§£æå™¨ï¼‰<br>  è¿™ä¸ªè¿‡ç¨‹æ˜¯å°†è¯æ³•å•å…ƒæµï¼ˆæ•°ç»„ï¼Œé€šä¿—çš„è®²ï¼Œå¤„ç†è¿‡ç¨‹å°±æ˜¯ä¸ªforå¾ªç¯ï¼‰è½¬æ¢æˆä¸€ä¸ªç”±å…ƒç´ é€çº§åµŒå¥—æ‰€ç»„æˆçš„ä»£è¡¨äº†ç¨‹åºè¯­æ³•ç»“æ„çš„æ ‘ã€‚è¿™ä¸ªæ ‘è¢«ç§°ä¸º<strong>â€œæŠ½è±¡è¯­æ³•æ ‘â€</strong><code>Abstract Syntax Treeï¼ŒAST</code>ã€‚</li>
<li>ä»£ç ç”Ÿæˆ<br>  å°†ç”Ÿæˆçš„astè½¬åŒ–ä¸ºå¯æ‰§è¡Œä»£ç çš„è¿‡ç¨‹ã€‚</li>
</ul>
<h3 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h3><p><a class="link"   href="https://astexplorer.net/"  target="_blank" rel="noopener">AST Explorer<i class="fas fa-external-link-alt"></i></a>æä¾›äº†å¾ˆå¤šä¸åŒçš„astç”Ÿæˆè§„åˆ™å¯ç”¨æ¥å­¦ä¹ <br>ä¾‹å¦‚: ç¼–è¯‘javascriptæ—¶çš„<code>var a = 1;</code>å°†ç”Ÿæˆå¦‚ä¸‹æŠ½è±¡è¯­æ³•æ ‘</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type: "Program",   // ç¨‹åº</span><br><span class="line">    start: 0,</span><br><span class="line">    end: 10,</span><br><span class="line">    body: [</span><br><span class="line">        &#123;  <span class="comment">// VariableDeclaration</span></span><br><span class="line">            type: "VariableDeclaration",    // å˜é‡å£°æ˜</span><br><span class="line">            start: 0,</span><br><span class="line">            end: 10,</span><br><span class="line">            declarations: [</span><br><span class="line">                &#123; <span class="comment">// VariableDeclarator   // å˜é‡å£°æ˜è€…</span></span><br><span class="line">                    type: "VariableDeclarator",</span><br><span class="line">                    start: 4,</span><br><span class="line">                    end: 9,</span><br><span class="line">                    id: &#123; // Identifier     å£°æ˜a</span><br><span class="line">                        type: "Identifier",</span><br><span class="line">                        start: 4,</span><br><span class="line">                        end: 5,</span><br><span class="line">                        name: "a"</span><br><span class="line">                    &#125;,</span><br><span class="line">                    init:&#123;          // å°†açš„å€¼åˆå§‹åŒ–ä¸º 1 </span><br><span class="line">                        type: "Literal",</span><br><span class="line">                        start: 8,</span><br><span class="line">                        end: 9,</span><br><span class="line">                        value: 1,</span><br><span class="line">                        raw: "1"</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            kind: "var"</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">    sourceType: "module"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®ä¾‹ï¼š"><a href="#å®ä¾‹ï¼š" class="headerlink" title="å®ä¾‹ï¼š"></a>å®ä¾‹ï¼š</h3><ul>
<li>bableçš„ç¼–è¯‘ä½¿ç”¨äº†ASTã€‚</li>
<li>åœ¨vue3çš„æ¨¡æ¿è¯­æ³•ç¼–è¯‘ï¼Œå®šä¹‰äº†è‡ªå·±çš„ä¸€å¥—è¯­æ³•è§„åˆ™ï¼Œä½¿ç”¨ASTå¤§å¤§æé«˜äº†æ€§èƒ½</li>
</ul>
<h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p><a class="link"   href="https://www.npmjs.com/package/recast"  target="_blank" rel="noopener">recast<i class="fas fa-external-link-alt"></i></a>æ˜¯ä¸€ä¸ªastçš„å·¥å…·ï¼Œä½¿ç”¨å®ƒå¯ä»¥æŸ¥çœ‹astï¼Œæ›´æ¢è¯­æ³•è§„åˆ™ç­‰ã€‚</p>
]]></content>
      <categories>
        <category>ç¼–è¯‘åŸç†</category>
      </categories>
      <tags>
        <tag>ç¼–è¯‘åŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä¸­ä½¿ç”¨vueChartJs</title>
    <url>/2020/08/26/vue%E4%B8%AD%E4%BD%BF%E7%94%A8vueChartJs/</url>
    <content><![CDATA[<h3 id="vue-chartJs"><a href="#vue-chartJs" class="headerlink" title="vue-chartJs"></a>vue-chartJs</h3><p><a class="link"   href="https://vue-chartjs.org/zh-cn/"  target="_blank" rel="noopener">vue-chartJs<i class="fas fa-external-link-alt"></i></a>æ˜¯vueå¯¹<a class="link"   href="http://chartjs.cn/"  target="_blank" rel="noopener">Chart.js<i class="fas fa-external-link-alt"></i></a>çš„å°è£…,å¯ä»¥å¾ˆç®€å•çš„åˆ›å»ºå¯å¤ç”¨çš„å›¾è¡¨ç»„ä»¶ã€‚ç”±äºæ˜¯å¯¹åº•å±‚çš„å°è£…ï¼Œæ‰€ä»¥è®¸å¤šå›¾è¡¨çš„é…ç½®ï¼Œè¿˜æ˜¯éœ€è¦çœ‹è¿™ä¸ª<a class="link"   href="http://chartjs.cn/docs/"  target="_blank" rel="noopener">Chart.jsçš„æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="å…ˆç®€å•å°è£…ä¸ªç»„ä»¶"><a href="#å…ˆç®€å•å°è£…ä¸ªç»„ä»¶" class="headerlink" title="å…ˆç®€å•å°è£…ä¸ªç»„ä»¶"></a>å…ˆç®€å•å°è£…ä¸ªç»„ä»¶</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vBar.vue</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; Bar &#125; <span class="keyword">from</span> <span class="string">'vue-chartjs'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'vBar'</span>,</span><br><span class="line">  extends: Bar,</span><br><span class="line">  props: [<span class="string">'chartdata'</span>, <span class="string">'options'</span>],</span><br><span class="line">  mounted () &#123;</span><br><span class="line">    <span class="keyword">this</span>.renderChart(<span class="keyword">this</span>.chartdata,<span class="keyword">this</span>.options)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="åœ¨éœ€è¦çš„åœ°æ–¹ç”¨è¿™ä¸ªç»„ä»¶"><a href="#åœ¨éœ€è¦çš„åœ°æ–¹ç”¨è¿™ä¸ªç»„ä»¶" class="headerlink" title="åœ¨éœ€è¦çš„åœ°æ–¹ç”¨è¿™ä¸ªç»„ä»¶"></a>åœ¨éœ€è¦çš„åœ°æ–¹ç”¨è¿™ä¸ªç»„ä»¶</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"example-3d"</span>&gt;</span><br><span class="line">	&lt;vBar :chartdata=<span class="string">"vBarData"</span> :options=<span class="string">"vOptions"</span> :styles=<span class="string">"myStyles"</span>&gt;&lt;<span class="regexp">/vBar&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import &#123; vBar &#125; from '@/</span>components/vCharts/vBar<span class="string">'</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">	name: '</span>barTest<span class="string">',</span></span><br><span class="line"><span class="string">	components: &#123;</span></span><br><span class="line"><span class="string">		vBar,</span></span><br><span class="line"><span class="string">	&#125;,</span></span><br><span class="line"><span class="string">	data() &#123;</span></span><br><span class="line"><span class="string">		return &#123;</span></span><br><span class="line"><span class="string">			vBarData: &#123;</span></span><br><span class="line"><span class="string">				labels: ['</span><span class="number">1</span><span class="string">', '</span><span class="number">2</span><span class="string">', '</span><span class="number">3</span><span class="string">', '</span><span class="number">4</span><span class="string">', '</span><span class="number">5</span><span class="string">', '</span><span class="number">6</span><span class="string">'],</span></span><br><span class="line"><span class="string">				datasets: [</span></span><br><span class="line"><span class="string">					&#123;</span></span><br><span class="line"><span class="string">						data: [1,2,3,4,5,6],</span></span><br><span class="line">						backgroundColor: '#ffa200',</span><br><span class="line">						barPercentage: <span class="number">1</span>,</span><br><span class="line">						maxBarThickness: <span class="number">12</span>,</span><br><span class="line">					&#125;,</span><br><span class="line">				],</span><br><span class="line">			&#125;,</span><br><span class="line">			vOptions: &#123;</span><br><span class="line">                <span class="comment">// è‡ªé€‚åº”å¿…é¡»è¦åŠ çš„ä¸‹é¢ä¸¤ä¸ªé…ç½®</span></span><br><span class="line">                responsive: <span class="literal">true</span>,</span><br><span class="line">                maintainAspectRatio: <span class="literal">false</span>,</span><br><span class="line">				layout: &#123;</span><br><span class="line">					padding: &#123;</span><br><span class="line">						left: <span class="number">5</span>,</span><br><span class="line">						right: <span class="number">5</span>,</span><br><span class="line">						top: <span class="number">5</span>,</span><br><span class="line">						bottom: <span class="number">5</span>,</span><br><span class="line">					&#125;,</span><br><span class="line">				&#125;,</span><br><span class="line">				legend: &#123; <span class="attr">display</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">				scales: &#123;</span><br><span class="line">					grid: &#123;</span><br><span class="line">						x: <span class="number">10</span>,</span><br><span class="line">						x2: <span class="number">20</span>,</span><br><span class="line">						y: <span class="number">20</span>,</span><br><span class="line">						y2: <span class="number">10</span>,</span><br><span class="line">					&#125;,</span><br><span class="line">					xAxes: [</span><br><span class="line">						&#123;</span><br><span class="line">							gridLines: &#123;</span><br><span class="line">								display: <span class="literal">false</span>,</span><br><span class="line">							&#125;,</span><br><span class="line">							ticks: &#123;</span><br><span class="line">								display: <span class="literal">false</span>,</span><br><span class="line">							&#125;,</span><br><span class="line">						&#125;,</span><br><span class="line">					],</span><br><span class="line">					yAxes: [</span><br><span class="line">						&#123;</span><br><span class="line">							gridLines: &#123;</span><br><span class="line">								display: <span class="literal">false</span>,</span><br><span class="line">							&#125;,</span><br><span class="line">							ticks: &#123;</span><br><span class="line">								display: <span class="literal">false</span>,</span><br><span class="line">							&#125;,</span><br><span class="line">						&#125;,</span><br><span class="line">					],</span><br><span class="line">				&#125;,</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	computed: &#123;</span><br><span class="line">		myStyles() &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				height: <span class="string">'100px'</span>,</span><br><span class="line">                <span class="comment">// è‡ªé€‚åº”å¿…é¡»è¦åŠ çš„position: 'relative',</span></span><br><span class="line">                position: <span class="string">'relative'</span>,</span><br><span class="line">                marginTop: <span class="string">'200px'</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">	mounted() &#123;&#125;,</span><br><span class="line">	created() &#123;&#125;,</span><br><span class="line">	methods: &#123;&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="vue-chartJsçš„è‡ªé€‚åº”resize"><a href="#vue-chartJsçš„è‡ªé€‚åº”resize" class="headerlink" title="vue-chartJsçš„è‡ªé€‚åº”resize"></a>vue-chartJsçš„è‡ªé€‚åº”resize</h3><ul>
<li>v-charté…ç½®<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">Options: &#123;</span><br><span class="line">    responsive: <span class="literal">true</span>,</span><br><span class="line">    maintainAspectRatio: <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ç»„ä»¶å®ä¾‹ç»‘å®šstyleså±æ€§<code>:styles=&quot;myStyles&quot;</code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">myStyles() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// è‡ªé€‚åº”å¿…é¡»è¦åŠ çš„position: 'relative',</span></span><br><span class="line">        position: <span class="string">'relative'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>å›¾è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä½¿ç”¨swiper</title>
    <url>/2020/08/25/vue%E4%BD%BF%E7%94%A8swiper/</url>
    <content><![CDATA[<h3 id="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨swiper-js"><a href="#åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨swiper-js" class="headerlink" title="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨swiper.js"></a>åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨swiper.js</h3><p>æœ‰ä¸€ä¸ªä¸“ä¸švueå°è£…åº“çš„<code>vue-awesome-swiper.js</code>,åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨æ—¶ï¼Œéœ€è¦æŠŠè¿™ä¸ªåŒ…ä¹Ÿè£…ä¸Šã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add swiper@5.3.6 vue-awesome-swiper@4.1.0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¸Šé¢è£…åŒ…æ—¶æŒ‡å®šç‰ˆæœ¬ï¼Œæ˜¯å› ä¸ºåœ¨é¡¹ç›®ä¸­è¸©å‘äº†ã€‚è£…äº†æ–°åŒ…ä¸èƒ½ç”¨ã€‚äºæ˜¯æŸ¥çœ‹vue-awesome-swiper<a class="link"   href="https://github.com/surmon-china/surmon-china.github.io"  target="_blank" rel="noopener">åœ¨githubä¸Šçš„ç¤ºä¾‹ä»£ç <i class="fas fa-external-link-alt"></i></a>ï¼Œå‘ç°<code>swiper@5.3.6 vue-awesome-swiper@4.1.0</code>ï¼Œè£…åŒ…åå¯ä»¥ä½¿ç”¨</p>
</blockquote>
<h3 id="ä½¿ç”¨demo"><a href="#ä½¿ç”¨demo" class="headerlink" title="ä½¿ç”¨demo"></a>ä½¿ç”¨demo</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"example-3d"</span>&gt;</span><br><span class="line">		&lt;swiper <span class="class"><span class="keyword">class</span></span>=<span class="string">"swiper"</span> :options=<span class="string">"swiperOption"</span>&gt;</span><br><span class="line">			&lt;swiper-slide v-<span class="keyword">for</span>=<span class="string">"(item, index) in colorList"</span> :key=<span class="string">"index"</span> :style=<span class="string">"'background: '+item"</span>&gt;Slide &#123;&#123;index&#125;&#125;&lt;<span class="regexp">/swiper-slide&gt;</span></span><br><span class="line"><span class="regexp">		&lt;/</span>swiper&gt;</span><br><span class="line">	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; Swiper, SwiperSlide &#125; <span class="keyword">from</span> <span class="string">'vue-awesome-swiper'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'swiper/css/swiper.css'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	name: <span class="string">'swiper-example-3d-coverflow'</span>,</span><br><span class="line">	title: <span class="string">'3D Coverflow effect'</span>,</span><br><span class="line">	components: &#123;</span><br><span class="line">		Swiper,</span><br><span class="line">		SwiperSlide,</span><br><span class="line">	&#125;,</span><br><span class="line">	data() &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">            colorList:[<span class="string">'#c82829'</span>,<span class="string">'#f5871f'</span>,<span class="string">'#eab700'</span>,<span class="string">'#718c00'</span>,<span class="string">'#3e999f'</span>],</span><br><span class="line">			swiperOption: &#123;</span><br><span class="line">				initialSlide: <span class="number">1</span>,</span><br><span class="line">				virtualTranslate: <span class="literal">true</span>,</span><br><span class="line">				effect: <span class="string">'coverflow'</span>,</span><br><span class="line">				grabCursor: <span class="literal">false</span>,</span><br><span class="line">				centeredSlides: <span class="literal">true</span>,</span><br><span class="line">				slidesPerView: <span class="string">'auto'</span>,</span><br><span class="line">				coverflowEffect: &#123;</span><br><span class="line">					rotate: <span class="number">10</span>,</span><br><span class="line">					stretch: <span class="number">0</span>,</span><br><span class="line">					depth: <span class="number">10</span>,</span><br><span class="line">					modifier: <span class="number">1</span>,</span><br><span class="line">					slideShadows: <span class="literal">false</span>,</span><br><span class="line">				&#125;,</span><br><span class="line">				on: &#123;</span><br><span class="line">					click: <span class="function"><span class="keyword">function</span> (<span class="params">swiper, event</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">					&#125;,</span><br><span class="line">				&#125;,</span><br><span class="line">				slideToClickedSlide: <span class="literal">true</span>,</span><br><span class="line">				slidesPerView: <span class="number">5</span>,</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style lang="scss" scoped&gt;</span></span><br><span class="line"><span class="regexp">.example-3d &#123;</span></span><br><span class="line"><span class="regexp">	width: 100%;</span></span><br><span class="line"><span class="regexp">	height: 400px;</span></span><br><span class="line"><span class="regexp">	padding-top: 50px;</span></span><br><span class="line"><span class="regexp">	padding-bottom: 50px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">.swiper &#123;</span></span><br><span class="line"><span class="regexp">	height: 100%;</span></span><br><span class="line"><span class="regexp">	width: 100%;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">	.swiper-slide &#123;</span></span><br><span class="line"><span class="regexp">		display: flex;</span></span><br><span class="line"><span class="regexp">		justify-content: center;</span></span><br><span class="line"><span class="regexp">		align-items: center;</span></span><br><span class="line"><span class="regexp">		width: 300px;</span></span><br><span class="line"><span class="regexp">		height: 300px;</span></span><br><span class="line"><span class="regexp">		text-align: center;</span></span><br><span class="line"><span class="regexp">		font-weight: bold;</span></span><br><span class="line"><span class="regexp">		background-color: #2c8dfb;</span></span><br><span class="line"><span class="regexp">		background-position: center;</span></span><br><span class="line"><span class="regexp">		background-size: cover;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>vue</tag>
        <tag>åŠ¨ç”»</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä½¿ç”¨flowé™æ€æ£€æŸ¥</title>
    <url>/2020/08/18/vue%E4%BD%BF%E7%94%A8flow%E9%9D%99%E6%80%81%E6%A3%80%E6%9F%A5/</url>
    <content><![CDATA[<h3 id="äº†è§£ä¸‹flow"><a href="#äº†è§£ä¸‹flow" class="headerlink" title="äº†è§£ä¸‹flow"></a>äº†è§£ä¸‹flow</h3><p>jsæ˜¯ä¸€é—¨å¼±è¯­è¨€ï¼Œçµæ´»æ€§å¼ºã€‚è¿™æœ¬æ¥æ˜¯å®ƒçš„ä¼˜åŠ¿ã€‚ä½†æ˜¯åœ¨ç¨‹åºè¿è¡Œä¸­ï¼Œæ•°æ®ç±»å‹å˜å¹»å¾€å¾€é€ æˆç¨‹åºçš„ä¸ç¨³å®šã€‚<br>flow.jsæ˜¯ç”¨æ¥ä¸ºjsåšé™æ€ç±»å‹æ£€æŸ¥çš„ã€‚åœ¨ä½¿ç”¨tså‰ï¼Œflow.jsæ˜¯ä¸€ä¸ªä¸é”™çš„ç±»å‹æ£€æŸ¥å™¨ã€‚ä»–å’Œtsä¸æ˜¯ä¸€å›äº‹ã€‚tsæ˜¯jsçš„è¶…é›†ï¼Œè€Œflowåªæ˜¯ä¸€ä¸ªå·¥å…·</p>
<h3 id="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨flow"><a href="#åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨flow" class="headerlink" title="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨flow"></a>åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨flow</h3><ul>
<li>å®‰è£…flowç›¸å…³ä¾èµ–åŒ…<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># yarn</span></span><br><span class="line">$ yarn add </span><br><span class="line">  babel-plugin-syntax-flow <span class="comment"># æ·»åŠ å¯¹Babelä¸­çš„æµè¯­æ³•çš„æ”¯æŒã€‚</span></span><br><span class="line">  babel-plugin-transform-class-properties <span class="comment">#  æ·»åŠ å¯¹ç±»å±æ€§å’Œé™æ€æ–¹æ³•çš„æ”¯æŒ</span></span><br><span class="line">  babel-plugin-transform-flow-strip-types <span class="comment"># åœ¨ä½¿ç”¨Babelè½¬æ¢å‰ä»æºæ–‡ä»¶ä¸­åˆ é™¤ç±»å‹æ³¨é‡Šã€‚</span></span><br><span class="line">  eslint <span class="comment">#  Eslintã€‚å®ƒå®é™…ä¸Šæ˜¯JSçš„linterï¼Œé›†æˆäº†å„ç§ç¼–è¾‘å™¨å’Œideã€‚</span></span><br><span class="line">  babel-eslint <span class="comment"># å¯¹Eslintè¿›è¡Œè¡¥ä¸ï¼Œä»¥ä½¿ç”¨Babelçš„è§£æå™¨è§£ææºæ–‡ä»¶ã€‚</span></span><br><span class="line">  eslint-plugin-html <span class="comment"># å…è®¸Eslintå¤„ç†HTMLæ–‡ä»¶ (ie. Only lints stuff inside script tags.)</span></span><br><span class="line">  eslint-plugin-flowtype-errors <span class="comment"># é€šè¿‡Eslintä¼ é€’æµé”™è¯¯ï¼Œå¹¶ä¼ é€’åˆ°ç¼–è¾‘å™¨çš„Eslintæ’ä»¶(å¦‚æœæœ‰çš„è¯)ã€‚</span></span><br><span class="line">  eslint-plugin-vue <span class="comment"># ç”¨äºä½¿ç”¨Vueçš„Eslintçš„æ’ä»¶ã€‚</span></span><br><span class="line">  eslint-config-vue <span class="comment"># ç”¨äºä½¿ç”¨Vueçš„Eslintçš„é…ç½®.</span></span><br><span class="line">  flow-bin     <span class="comment"># flow ç±»å‹æ£€æŸ¥</span></span><br><span class="line">-D</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®.babelrc<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"babel-plugin-transform-class-properties"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-syntax-flow"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-flow-strip-types"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®.eslintrc<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"parser"</span>: <span class="string">"babel-eslint"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"html"</span>,</span><br><span class="line">    <span class="string">"flowtype-errors"</span></span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="string">"extends"</span>: [</span><br><span class="line">    <span class="string">"vue"</span></span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="string">"rules"</span>: &#123;</span><br><span class="line">    <span class="string">"flowtype-errors/show-errors"</span>: <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®.flowconfig<ul>
<li>åœ¨<code>package.json</code>çš„<code>scripts</code>æ ‡ç­¾ä¸­ã€‚æ·»åŠ <code>&quot;flow&quot;: &quot;flow&quot;</code><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>:&#123;</span><br><span class="line">    <span class="string">"flow"</span>: <span class="string">"flow"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ‰§è¡Œ<code>flow init</code> ç”Ÿæˆ.flowconfigæ–‡ä»¶<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ignore]</span><br><span class="line">.*&#x2F;node_modules&#x2F;.*</span><br><span class="line">.*&#x2F;test&#x2F;.*</span><br><span class="line">.*&#x2F;build&#x2F;.*</span><br><span class="line">.*&#x2F;config&#x2F;.*</span><br><span class="line">[include]</span><br><span class="line"></span><br><span class="line">[libs]</span><br><span class="line"></span><br><span class="line">[options]</span><br><span class="line">module.file_ext&#x3D;.vue</span><br><span class="line">module.file_ext&#x3D;.js</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>åœ¨jsæ–‡ä»¶å’Œ.vueæ–‡ä»¶ä¸­åŠ å…¥<code>/* @flow */</code>,flowå¼€å§‹å·¥ä½œ<br>test.js<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* @flow */</span></span><br><span class="line"><span class="keyword">const</span> doSomethingStupid(stringArg) &#123;</span><br><span class="line">  <span class="comment">// Flow should show an error here, "The operand of an arithmetic operation must be a number."</span></span><br><span class="line">  <span class="keyword">return</span> stringArg * <span class="number">3109</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(doSomethingStupid(<span class="string">`I'm stringy`</span>))</span><br></pre></td></tr></table></figure>
test.vue<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>I'm made with Flow!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">/* @flow */</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript"><span class="keyword">const</span> randomThing: string = <span class="string">'Boop!'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  created() &#123;</span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(randomThing)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="åœ¨webpack-ä¸­ä½¿ç”¨-flow-æ£€æŸ¥"><a href="#åœ¨webpack-ä¸­ä½¿ç”¨-flow-æ£€æŸ¥" class="headerlink" title="åœ¨webpack ä¸­ä½¿ç”¨ flow æ£€æŸ¥"></a>åœ¨webpack ä¸­ä½¿ç”¨ flow æ£€æŸ¥</h3><ul>
<li>å®‰è£…ä¸€ä¸ª flow çš„ webpack æ’ä»¶ <code>flow-webpack-next-plugin</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add flow-webpack-next-plugin -D</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®webpack  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> FlowWebpackPlugin = <span class="built_in">require</span>(<span class="string">'flow-webpack-next-plugin'</span>);</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> FlowWebpackPlugin()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h3 id="è®°å½•ä¸€ä¸ªflowæŠ¥é”™-required-module-not-found"><a href="#è®°å½•ä¸€ä¸ªflowæŠ¥é”™-required-module-not-found" class="headerlink" title="è®°å½•ä¸€ä¸ªflowæŠ¥é”™ required module not found"></a>è®°å½•ä¸€ä¸ªflowæŠ¥é”™ required module not found</h3><p>åŸå› ï¼š å› ä¸ºwebpacké…ç½®äº†åˆ«å(alias)ï¼Œæ‰€ä»¥åœ¨ js æ–‡ä»¶å†…ç›´æ¥ import åˆ«åä¼šå¯¼è‡´ flow æ— æ³•æ­£ç¡®æ‰¾åˆ°å¯¹åº”çš„ module<br>è§£å†³ï¼š åœ¨ .flowconfig ä½¿ç”¨ name_mapper å°†å¯¹åº”çš„åˆ«ååšä¸€ä¸ªæ˜ å°„ï¼Œé—®é¢˜è§£å†³</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[options]</span><br><span class="line">module.file_ext&#x3D;.vue</span><br><span class="line">module.file_ext&#x3D;.js</span><br><span class="line">module.name_mapper&#x3D;&#39;\(@\)&#39; -&gt; &#39;&lt;PROJECT_ROOT&gt;&#x2F;src&#x2F;&#39;</span><br></pre></td></tr></table></figure>

<h3 id="ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š"><a href="#ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š" class="headerlink" title="ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š"></a>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</h3><p><a class="link"   href="https://www.jianshu.com/p/95854085ec40"  target="_blank" rel="noopener">https://www.jianshu.com/p/95854085ec40<i class="fas fa-external-link-alt"></i></a><br><a class="link"   href="https://www.digitalocean.com/community/tutorials/vuejs-components-flow"  target="_blank" rel="noopener">https://www.digitalocean.com/community/tutorials/vuejs-components-flow<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>flow</tag>
      </tags>
  </entry>
  <entry>
    <title>node-sassè£…åŒ…æŠ¥é”™</title>
    <url>/2020/08/17/node-sass%E8%A3%85%E5%8C%85%E6%8A%A5%E9%94%99/</url>
    <content><![CDATA[<h3 id="node-sasså®‰è£…ä¾èµ–error-node-sass-Command-failedæŠ¥é”™è§£å†³"><a href="#node-sasså®‰è£…ä¾èµ–error-node-sass-Command-failedæŠ¥é”™è§£å†³" class="headerlink" title="node-sasså®‰è£…ä¾èµ–error: node-sass: Command failedæŠ¥é”™è§£å†³"></a>node-sasså®‰è£…ä¾èµ–error: node-sass: Command failedæŠ¥é”™è§£å†³</h3><p>å¥½å¥½çš„yarn installã€‚ æŠ¥ä¸€ä¸ªä¸‹å›¾çš„é”™ã€‚<br><img src="http://i.feidom.com/nodeSassError.jpg" alt="nodeSassError"></p>
<p><strong>é—®é¢˜åŸå› </strong>ï¼šæŸ¥çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œå†æŸ¥æ‰¾èµ„æ–™ã€‚å¯èƒ½æ˜¯è¢«å¢™äº†ã€‚<br><strong>è§£å†³åŠæ³•</strong>ï¼šå°† sass-binary-site æ·»åŠ è‡³ yarn/npm config ä¸­,æŒ‡å®šnode-sassåœ¨æ·˜å®æºä¸­ä¸‹è½½</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yarn config set sass-binary-site https:&#x2F;&#x2F;npm.taobao.org&#x2F;mirrors&#x2F;node-sass</span><br><span class="line">npm config set sass-binary-site https:&#x2F;&#x2F;npm.taobao.org&#x2F;mirrors&#x2F;node-sass</span><br></pre></td></tr></table></figure>

<blockquote>
<p>çˆ¬å‘è®°å½•ä¸€ä¸‹</p>
</blockquote>
]]></content>
      <tags>
        <tag>é—®é¢˜è§£å†³</tag>
        <tag>å®‰è£…ä¾èµ–é—®é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>vueæºç è§£è¯»ä¹‹htmlä¸vNodeé—´çš„è½¬æ¢</title>
    <url>/2020/08/13/vue%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB%E4%B9%8Bhtml%E4%B8%8EvNode%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<p><code>&lt;template&gt;</code>è¢«compilerå¤„ç†ã€‚compilerä½¿ç”¨<code>generate(ast, options)</code>æ–¹æ³•ï¼Œå°†templateè½¬æ¢ä¸ºæŒ‡å®šç»“æ„çš„å¯¹è±¡ã€‚</p>
<h3 id="compilerç¼–è¯‘"><a href="#compilerç¼–è¯‘" class="headerlink" title="compilerç¼–è¯‘"></a>compilerç¼–è¯‘</h3><p>é˜…è¯»æºç é€»è¾‘å¯å¾—ï¼Œåœ¨å®é™…ä¸Šcompilerçš„ä¸»è¦å¤„ç†ç‚¹æ˜¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> compiled = baseCompile(template.trim(), finalOptions);</span><br></pre></td></tr></table></figure>
<p>å³è°ƒç”¨baseCompileå‡½æ•°ï¼Œè€ŒbaseCompileåˆ™æ˜¯æ ¸å¿ƒï¼Œè¿™è¾¹ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ast = parse(template.trim(), options)</span><br><span class="line"><span class="keyword">if</span> (options.optimize !== <span class="literal">false</span>) &#123;</span><br><span class="line">    optimize(ast, options)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> code = generate(ast, options)</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    ast,</span><br><span class="line">    render: code.render,</span><br><span class="line">    staticRenderFns: code.staticRenderFns</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç  å°†templateå¤„ç†ä¸ºast(æŠ½è±¡è¯­æ³•æ ‘)ï¼Œä¸” æ ¹æ®astæ ‘ç»“æ„æ„å»ºrenderå‡½æ•°ä¸»ä½“éƒ¨åˆ†ã€‚</p>
<h3 id="compilerä¸­è°ƒç”¨parse-è§£æ"><a href="#compilerä¸­è°ƒç”¨parse-è§£æ" class="headerlink" title="compilerä¸­è°ƒç”¨parse()è§£æ"></a>compilerä¸­è°ƒç”¨parse()è§£æ</h3><p>æ ¸å¿ƒä¸­ç”¨åˆ°çš„parse()æ–¹æ³•çš„å¤„ç†è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li>åœ¨new Vueå®ä¾‹åŒ–æ—¶ï¼ŒparseHTMLè§£æhtmlæ ‡ç­¾ç­‰htmlå†…å®¹ã€‚parseHTMLå¤„ç†å®é™…ä¸Šä¼šè°ƒç”¨parseStartTagå’ŒhandleStartTagæ¥è§£æå‡ºå¼€å§‹æ ‡ç­¾ï¼Œè§£ææ—¶ï¼Œç”¨åˆ°çš„æ–¹æ³•æ˜¯<strong>æ­£åˆ™åŒ¹é…</strong>ã€‚</li>
<li>parseTextå¤„ç†ç±»ä¼¼æ–‡æœ¬èŠ‚ç‚¹ã€‚å®é™…ä¸Šä¼šå°†ä½¿ç”¨åˆ°å“åº”å¼æ•°æ®çš„æ–‡æœ¬å˜æˆï¼š_s(text)ï¼Œå¹¶ä¸”è®¾ç½®äº†@bindingå±æ€§è¡¨ç¤ºå¼•ç”¨äº†å“ªä¸ªå“åº”å¼å˜é‡ã€‚<br>è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯å¯¹äºæ¢è¡Œçš„å¤„ç†ä¹Ÿä¼šä¿ç•™ï¼Œå³æ–‡æœ¬åŒºåŸŸåŸæ ·ï¼Œè¯¥æœ‰æ¢è¡Œå°±æœ‰æ¢è¡Œåªæ˜¯å“åº”å¼å˜é‡çš„ç‰¹æ®Šå¤„ç†è€Œå·²ã€‚</li>
</ul>
<p>ç¤ºä¾‹æ€»ç»“ï¼š<br>å°†<code>&lt;div id=&quot;app&quot;&gt;  &lt;/div&gt;</code>,ç»è¿‡<code>parseHTML + parseText</code>çš„è§£æï¼Œå¾—åˆ°å¦‚ä¸‹çš„ä¸»è¦astç»“æ„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">type: <span class="number">1</span>,</span><br><span class="line">tag: <span class="string">'div'</span>,</span><br><span class="line">attrs: [&#123; <span class="attr">name</span>: <span class="string">'id'</span>, <span class="attr">value</span>: <span class="string">'app'</span>&#125;],</span><br><span class="line">attrList: [&#123;<span class="attr">name</span>: <span class="string">'id'</span>, <span class="attr">value</span>: <span class="string">'app'</span>&#125;],</span><br><span class="line">attrMap: &#123;<span class="attr">id</span>: <span class="string">'app'</span>&#125;</span><br><span class="line">children: [</span><br><span class="line">    expression: <span class="string">""</span>\n    <span class="string">"+_s(text)+"</span>\n  <span class="string">""</span></span><br><span class="line">    text: <span class="string">"â†µ    &#123;&#123; text &#125;&#125;â†µ  "</span></span><br><span class="line">    tokens: (<span class="number">3</span>) [<span class="string">"â†µ    "</span>, &#123;â€¦&#125;, <span class="string">"â†µ  "</span>]</span><br><span class="line">    type: <span class="number">2</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="generateé€šè¿‡è§£æå‡ºæ¥çš„astæ„å»ºrender"><a href="#generateé€šè¿‡è§£æå‡ºæ¥çš„astæ„å»ºrender" class="headerlink" title="generateé€šè¿‡è§£æå‡ºæ¥çš„astæ„å»ºrender"></a>generateé€šè¿‡è§£æå‡ºæ¥çš„astæ„å»ºrender</h3><p>åœ¨æ„å»ºrenderçš„è¿‡ç¨‹ä¸­ï¼Œç”¨åˆ°äº†ç½ªæ¶çš„<code>with()</code><br>å…ˆçœ‹ä¸€ä¸‹generateçš„éƒ¨åˆ†æºç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="keyword">new</span> CodegenState(options)</span><br><span class="line"><span class="keyword">const</span> code = ast ? genElement(ast, state) : <span class="string">'_c("div")'</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    render: <span class="string">`with(this)&#123;return <span class="subst">$&#123;code&#125;</span>&#125;`</span>,</span><br><span class="line">    staticRenderFns: state.staticRenderFns</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ä¾‹çš„astç»“æ„å®é™…ä¸Šæ„å»ºæˆäº†:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span>(<span class="keyword">this</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> _c(<span class="string">'div'</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            attrs:&#123;<span class="string">"id"</span>:<span class="string">"app"</span>&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        [</span><br><span class="line">            _v(<span class="string">"\n    "</span>+_s(text)+<span class="string">"\n  "</span>)</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä½¿ç”¨å‡½æ•°å½¢å¼è¡¨ç¤ºçš„ï¼Œå®é™…ä¸ŠVueæºç æ­¤å¤„æ˜¯å­—ç¬¦ä¸²ï¼Œå³ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"with(this)&#123;return _c("</span>div<span class="string">",&#123;attrs:&#123;"</span>id<span class="string">":"</span>app<span class="string">"&#125;&#125;,[_v("</span>\n <span class="string">"+_s(text)+"</span>\n <span class="string">")])&#125;"</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ç”¨åˆ°çš„_c(),_v(),_sçš„æ„æ€åˆ†åˆ«ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// _c()å°±æ˜¯$createElementï¼Œå³hå‡½æ•°ã€‚è¯¥æ–¹æ³•æ˜¯vnodeåˆ›å»ºçš„å®é™…å‡ºå‘ç‚¹ï¼ŒVueæ ¸å¿ƒæ–¹æ³•ä¹‹ä¸€ã€‚å…·ä½“æºç å¦‚ä¸‹ï¼š</span></span><br><span class="line">vm._c = <span class="function"><span class="keyword">function</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createElement(vm, a, b, c, d, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// -v()å®é™…ä¸Šæ˜¯createTextVNodeï¼Œå³åˆ›å»ºè™šæ‹Ÿæ–‡æœ¬èŠ‚ç‚¹ï¼ˆæ–‡æœ¬ç±»å‹çš„è™šæ‹ŸDOMï¼‰ï¼Œå®ä¾‹æ–¹æ³•å¦‚ä¸‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTextVNode</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> VNode(<span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="built_in">String</span>(val));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// -s()å®é™…ä¸Šæ˜¯toStringï¼Œå¤„ç†å¯¹è±¡å’Œå…¶ä»–å½¢å¼æ–‡æœ¬è¾“å‡ºã€‚å¤„ç†nullã€å¯¹è±¡ä»¥åŠæ•°ç»„å½¢å¼çš„æ•°æ®ç­‰å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚å®ä¾‹æ–¹æ³•å¦‚ä¸‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toString</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> val === <span class="literal">null</span> </span><br><span class="line">        ? <span class="string">' '</span> </span><br><span class="line">        : <span class="keyword">typeof</span> val === <span class="string">'object'</span> </span><br><span class="line">        <span class="comment">// æ ¼å¼åŒ–å¯¹è±¡ï¼Œå¹¶æŒ‡å®šç¼©è¿›ä¸º2ä¸ªç©ºæ ¼</span></span><br><span class="line">        ? <span class="built_in">JSON</span>.stringify(val, <span class="literal">null</span>, <span class="number">2</span>) </span><br><span class="line">        : <span class="built_in">String</span>(val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œéœ€è¦è¯´æ˜ä¸‹_cä¸­createElementä¸­aã€bã€cã€då‚æ•°è¡¨ç¤ºçš„å«ä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// aï¼štagï¼Œè¡¨ç¤ºæ ‡ç­¾å</span></span><br><span class="line"><span class="comment">// bï¼šdataï¼Œè¡¨ç¤ºå±æ€§ã€äº‹ä»¶ã€classã€propsç­‰çš„é…ç½®å¯¹è±¡</span></span><br><span class="line"><span class="comment">// c: childrenï¼Œè¡¨ç¤ºå­èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">// dï¼šnormalizationTypeï¼Œè¡¨ç¤ºç±»å‹ï¼Œå³è¦å¦‚ä½•å¤„ç†childrenä¸­çš„æ•°æ®</span></span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†renderå‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">render: <span class="string">`with(this)&#123;return <span class="subst">$&#123;code&#125;</span>&#125;`</span>,</span><br></pre></td></tr></table></figure>

<h3 id="VNodeçš„åˆ›å»ºæ˜¯åœ¨renderæ‰§è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„"><a href="#VNodeçš„åˆ›å»ºæ˜¯åœ¨renderæ‰§è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„" class="headerlink" title="VNodeçš„åˆ›å»ºæ˜¯åœ¨renderæ‰§è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„"></a>VNodeçš„åˆ›å»ºæ˜¯åœ¨renderæ‰§è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„</h3><p>renderä¸­ç”¨<code>with()</code>æ‰§è¡Œäº†_c(),_v()ç­‰æ–¹æ³•ã€‚<br>_c()å°±æ˜¯$createElement,åœ¨createElementçš„å¤„ç†é€»è¾‘ä¸­ï¼Œæœ€ä¸ºæ ¸å¿ƒçš„å°±æ˜¯è°ƒç”¨VNodeæ„é€ å‡½æ•°åˆ›å»ºè™šæ‹ŸDOM:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> VNode(tag, data, children, <span class="literal">undefined</span>, <span class="literal">undefined</span>, context)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†è¯´ä¸€ä¸‹VNodeæ„é€ å‡½æ•°<br>VNodeæ„é€ å‡½æ•°å®é™…ä¸Šå°±æ˜¯å®šä¹‰ç›¸å…³å±æ€§ï¼ŒVNodeä¸­é‡è¦çš„å±æ€§æœ‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// tagï¼šå½“å‰æ ‡ç­¾å</span></span><br><span class="line"><span class="comment">// dataï¼šæ ‡ç­¾å±æ€§ã€propsã€äº‹ä»¶ç­‰å¯¹è±¡é›†åˆ</span></span><br><span class="line"><span class="comment">// textï¼šå½“å‰æ ‡ç­¾æ–‡æœ¬å†…å®¹</span></span><br><span class="line"><span class="comment">// contextï¼šä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå³Vueå®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> VNode = <span class="function"><span class="keyword">function</span>(<span class="params">tag, data, children, text, elm, context, componentOptions, asyncFactory</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.tag = tag;</span><br><span class="line">	<span class="keyword">this</span>.data = data;</span><br><span class="line">	<span class="keyword">this</span>.children = children;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="renderä¸­åˆ›å»ºäº†VNodeï¼Œé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨renderå‘¢"><a href="#renderä¸­åˆ›å»ºäº†VNodeï¼Œé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨renderå‘¢" class="headerlink" title="renderä¸­åˆ›å»ºäº†VNodeï¼Œé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨renderå‘¢??"></a>renderä¸­åˆ›å»ºäº†VNodeï¼Œé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨renderå‘¢??</h3><p>è¿™é‡Œè¯´æ˜ä¸‹ä¹‹å‰renderç”Ÿæˆæ—¶çš„è¿‡ç¨‹åŠæ—¶é—´ç‚¹</p>
<ul>
<li>åˆå§‹åŒ–æ—¶renderMixin<br>è¿™éƒ¨åˆ†æ˜¯åŠ è½½Vue.jsæ–‡ä»¶è¿‡ç¨‹ä¸­çš„å¤„ç†ï¼Œæ¶‰åŠåˆ°renderçš„æ˜¯renderMixinå‡½æ•°ï¼Œå®é™…ä¸Šè¯¥å‡½æ•°ä¸»è¦å®šä¹‰VueåŸå‹æ–¹æ³•ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue.prototype.$nextTickæ–¹æ³•å®šä¹‰</span></span><br><span class="line"><span class="comment">// Vue.prototype._renderæ–¹æ³•å®šä¹‰</span></span><br></pre></td></tr></table></figure></li>
<li>new Vueæ—¶initRender<br>åˆ›å»ºVueå®ä¾‹æ—¶ä¼šè°ƒç”¨initRenderè¿›è¡Œåˆå§‹åŒ–ï¼Œå®é™…ä¸Šå°±æ˜¯ç›¸å…³å±æ€§çš„å®šä¹‰</li>
<li>$mountæŒ‚è½½renderå¤„ç†<br>åœ¨è¿™ä¸ªæ—¶å€™å°†templateå¤„ç†æˆrenderå‡½æ•°ã€‚</li>
<li>$mountä¸­æ„å»ºå‡ºäº†renderå‡½æ•°ï¼Œé‚£å†æ¥çœ‹çœ‹renderå‡½æ•°çš„è°ƒç”¨<br><img src="http://i.feidom.com/vue-render%28%29%E5%87%BD%E6%95%B0%E5%95%A5%E6%97%B6%E5%80%99%E7%94%A8.png" alt="çœ‹ä¸‹è¿™å¼ å›¾"><br>ä¸Šå›¾æ˜¯mountComponentä¸»è¦çš„å¤„ç†é€»è¾‘ï¼Œå®é™…ä¸Šrenderå‡½æ•°çš„æ‰§è¡Œæ˜¯åœ¨_renderä¸­å¤„ç†çš„ã€‚_renderå‡½æ•°çš„ç»“æœä½œä¸ºvm._updateå‡½æ•°çš„å‚æ•°ã€‚<br>è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ„å»ºWatcherå®ä¾‹è§¦å‘çš„ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> updateComponent = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	vm._update(vm._render());</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">new</span> Watcher(vm, updateComponent, noop)</span><br></pre></td></tr></table></figure>
updateComponentä¼šä½œä¸ºgetterå‡½æ•°ï¼Œå¹¶ä¸”ä¼šåœ¨Watcher.prototype.getä¸­è¢«è°ƒç”¨ï¼Œè€Œè¿™ä¸ªæ­¥éª¤å°±æ˜¯é‡æ–°ç”Ÿæˆhtmlçš„è¿‡ç¨‹ã€‚</li>
<li>å†è¯´ä¸‹_renderæ–¹æ³•<br>å®é™…ä¸Š_renderä¸­ä¸»è¦çš„å¤„ç†ä¹Ÿå°±æ˜¯renderå‡½æ•°çš„è°ƒç”¨ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vnode = render.call(vm._renderProxy, vm.$createElement);</span><br><span class="line"><span class="keyword">return</span> vnode;</span><br></pre></td></tr></table></figure></li>
<li>å†è¯´ä¸‹_updateå®ä¾‹æ–¹æ³•<br>_updateä¸­å¤„ç†å®é™…ä¸Šæœ‰ä¸¤ä¸ªä¸»è¦ç‚¹ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* vm._vnodeç›¸å…³å¤„ç†ï¼Œä¸¤ç‚¹ï¼šprevNode &#x3D; vm._vnodeï¼Œvm._vnode &#x3D; vnode</span><br><span class="line">* vm.__patch__çš„è°ƒç”¨</span><br></pre></td></tr></table></figure>
prevNodeè®°å½•æ›´æ–°å‰çš„vnodeï¼Œå¦‚æœæ˜¯åˆå§‹åŒ–ï¼Œé‚£ä¹ˆprevNodeå°±æ˜¯ç©ºï¼Œè°ƒç”¨<strong>patch</strong>å®ç°vnode -&gt; htmlçš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯<strong>diffç®—æ³•</strong>çš„å®ç°è¿‡ç¨‹ï¼Œæ˜¯æ•´ä¸ªVueä¸­æ ¸å¿ƒç‚¹ä¹‹ä¸€ã€‚<br>_updateæ ¸å¿ƒæºç å¦‚ä¸‹ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> prevNode = vm._vnode;</span><br><span class="line">vm._vnode = vnode;</span><br><span class="line"><span class="keyword">if</span> (!prevNode) &#123;</span><br><span class="line">	<span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">	vm.$el = vm.__patch__(vm.$elï¼Œvnode, hydrating, <span class="literal">false</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">// æ›´æ–°</span></span><br><span class="line">	vm.$el = vm.__patch__(prevNode, vnode);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
_updateè´Ÿè´£æ¯”è¾ƒdomèŠ‚ç‚¹å¹¶æ›¿æ¢ã€‚<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3>é€šè¿‡ä¸Šé¢ä¸»è¦åˆ†æäº†å¤„ç†htmlã€å¤„ç†æ–‡æœ¬æƒ…å†µï¼Œå¯¹äºæŒ‡ä»¤ç›¸å…³ç­‰éƒ¨åˆ†ç›´æ¥ç•¥è¿‡ï¼Œæ»¡è¶³äº†åˆ†æè¿™è¾¹çš„ç›®çš„ï¼šæ¢å¯»ä¸‹Vueæ˜¯å¦‚ä½•è§£ætemplateçš„ã€‚<br>æ•´ä¸ªå¤„ç†æµç¨‹å¦‚ä¸‹ï¼š<br>æ„å»ºcodeï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$mount -&gt; compileToFunctions -&gt; compile -&gt; baseCompile -&gt; parse -&gt; generate -&gt; render</span><br><span class="line">å…¶ä¸­parseä¸­ä¸»è¦çš„å¤„ç†ï¼š</span><br><span class="line">parse -&gt; parseHTMLã€parseTextï¼ˆå¾ªç¯å¤„ç†startTagã€textç­‰ï¼‰</span><br></pre></td></tr></table></figure>
è€Œvnodeçš„åˆ›å»ºå®é™…ä¸Šæ˜¯åœ¨renderè°ƒç”¨é˜¶æ®µå‘ç”Ÿçš„ï¼Œå³æ‰§è¡Œrenderå‡½æ•°ï¼Œå‡½æ•°ä½“ä¸­_cã€_vç­‰å‡½æ•°è§¦å‘çš„VNodeåˆ›å»ºã€‚<br>renderå‡½æ•°è°ƒç”¨:<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”Ÿæˆrenderå‡½æ•° -&gt; mountComponent -&gt; new Watcher -&gt; Vue.prototype._renderè°ƒç”¨</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>åœ¨æŸ¥çœ‹æºç çš„è¿‡ç¨‹ä¸­ï¼Œæœç´¢äº†å„ç§èµ„æ–™å¸®åŠ©è‡ªå·±ç†è§£ï¼Œå…¶ä¸­æ¥è‡ª<a class="link"   href="https://blog.csdn.net/s1879046/category_7294206.html"  target="_blank" rel="noopener">ç‰æ¡ˆè½©çª—è€å“¥çš„Vueç³»åˆ—<i class="fas fa-external-link-alt"></i></a>æ¡ç†æ¸…æ™°ï¼Œå¯¹è‡ªå·±å¸®åŠ©å¾ˆå¤§ã€‚ä»¥ä¸Šç¬”è®°ä¹Ÿå€Ÿé‰´äº†ä»–çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¹‹åå­¦ä¹ ç†è§£ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vueæºç è§£è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>vueæºç è§£è¯»</title>
    <url>/2020/08/13/vue%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/</url>
    <content><![CDATA[<h3 id="çœ‹å®Œè¿™å¼ å›¾"><a href="#çœ‹å®Œè¿™å¼ å›¾" class="headerlink" title="çœ‹å®Œè¿™å¼ å›¾"></a>çœ‹å®Œè¿™å¼ å›¾</h3><p><img src="http://i.feidom.com/vue%E6%A0%B8%E5%BF%83%E5%9B%BE.png" alt="vueçš„å·¥ä½œæµç¨‹å›¾"></p>
<h3 id="å„é˜¶æ®µé—´è¯¦ç»†è§£è¯»"><a href="#å„é˜¶æ®µé—´è¯¦ç»†è§£è¯»" class="headerlink" title="å„é˜¶æ®µé—´è¯¦ç»†è§£è¯»"></a>å„é˜¶æ®µé—´è¯¦ç»†è§£è¯»</h3><ul>
<li><a href="/2020/08/13/vueæºç è§£è¯»ä¹‹htmlä¸vNodeé—´çš„è½¬æ¢/">html ã€Š==è½¬æ¢==ã€‹ vNode</a></li>
<li><a href="/2020/08/12/vueæºç è§£æä¹‹observeré‡å†™arrayç›‘å¬/">Observeré‡å†™arrayç›‘å¬</a></li>
<li><a href="">keep-aliveçš„å®ç°</a></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vueæºç è§£è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>vue2.xæºç è§£è¯»ä¹‹observeré‡å†™arrayç›‘å¬</title>
    <url>/2020/08/12/vue%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8Bobserver%E9%87%8D%E5%86%99array%E7%9B%91%E5%90%AC/</url>
    <content><![CDATA[<h3 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h3><p>vueçš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€å°±æ˜¯åŒå‘ç»‘å®šï¼Œåœ¨vue2.xä¸­ï¼ŒåŒå‘ç»‘å®šçš„åŸç†ï¼Œæ˜¯ä¾èµ–<a class="link"   href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty"  target="_blank" rel="noopener">Object.defineProperty<i class="fas fa-external-link-alt"></i></a>è¿™ä¸ªæ–¹æ³•ã€‚ç”±äºè¿™ä¸ªæ–¹æ³•çš„ä¸€äº›å¼Šç«¯ï¼Œå¯¼è‡´Observerçš„å®ç°ï¼Œéœ€è¦å…¼å®¹è¿™äº›å¼Šç«¯ã€‚ä»¥ä¸‹å†…å®¹è¯¦ç»†è¯´æ˜äº†æ¥é¾™å»è„‰</p>
<h3 id="å…ˆè‡ªå·±å®ç°ä¸€ä¸ªObserver"><a href="#å…ˆè‡ªå·±å®ç°ä¸€ä¸ªObserver" class="headerlink" title="å…ˆè‡ªå·±å®ç°ä¸€ä¸ªObserver"></a>å…ˆè‡ªå·±å®ç°ä¸€ä¸ªObserver</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">data, key, value</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        <span class="keyword">get</span>: function defineGet()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`get key: <span class="subst">$&#123;key&#125;</span> vaule:<span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> value</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function defineSet(newVal)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`set key: <span class="subst">$&#123;key&#125;</span> vaule: vaule:<span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">            value = newVal</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">        defineReactive(data,key,data[key])</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let arr = [1, 2, 3]</span></span><br><span class="line"><span class="comment">// observe(arr)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é¦–å…ˆå¯¹æ•°ç»„(arr)çš„ç›‘å¬<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">observe(arr)</span><br></pre></td></tr></table></figure></li>
</ul>
<ol>
<li>ä»£ç è¿è¡Œåï¼Œåœ¨æ§åˆ¶å°ç›´æ¥ç»™arrå¢åŠ ä¸€ä¸ªå…ƒç´ ã€‚ä»£ç åŠè¾“å‡ºå¦‚ä¸‹ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é”®å…¥</span></span><br><span class="line">arr[<span class="number">3</span>] = <span class="number">4</span>;</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
===&gt; <strong>æ–°å¢çš„æ•°ç»„å…ƒç´ æ— æ³•ç›‘å¬</strong><br>åŸå› ï¼š åœ¨ç›‘å¬æ•°ç»„arræ—¶ï¼Œç›‘å¬äº†å®ƒçš„key:0,1,2(æ•°ç»„ä¸‹æ ‡)ã€‚å¹¶æ²¡æœ‰ç›‘å¬ä¸‹æ ‡3ï¼Œæ‰€ä»¥ç›‘å¬å¤±è´¥ã€‚</li>
<li>ä»£ç è¿è¡Œåï¼Œåœ¨æ§åˆ¶å°ç›´æ¥ç»™arræœ€å‰é¢unshiftä¸€ä¸ªå…ƒç´ ã€‚ä»£ç åŠè¾“å‡ºå¦‚ä¸‹ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é”®å…¥</span></span><br><span class="line">arr.unshift(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// get key: 2 vaule:3</span></span><br><span class="line"><span class="comment">// get key: 1 vaule:2</span></span><br><span class="line"><span class="comment">// set key: 2 vaule: vaule:2</span></span><br><span class="line"><span class="comment">// get key: 0 vaule:1</span></span><br><span class="line"><span class="comment">// set key: 1 vaule: vaule:1</span></span><br><span class="line"><span class="comment">// set key: 0 vaule: vaule:4</span></span><br><span class="line"><span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
===&gt; <strong>åœ¨è¿›è¡Œéƒ¨åˆ†æ•°ç»„æ“ä½œæ—¶ï¼Œä¼šé€ æˆç›‘å¬å¤šæ¬¡</strong>ï¼ˆæ•°ç»„ç§»ä½ï¼‰<br>åŸå› ï¼š åœ¨ç›‘å¬æ•°ç»„arræ—¶ï¼Œç›‘å¬äº†å®ƒçš„key:0,1,2(æ•°ç»„ä¸‹æ ‡)ã€‚å½“åœ¨æ•°ç»„arrçš„å‰é¢æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œé€ æˆæ•°ç»„ç§»ä½ï¼ˆspliceä¹Ÿä¼šè¿™æ ·ï¼‰ï¼Œæ‰€æœ‰çš„å…ƒç´ å‘åç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚é€ æˆå¤šæ¬¡get/setã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://i.feidom.com/%E6%95%B0%E7%BB%84%E7%A7%BB%E4%BD%8D.png" alt="æ•°ç»„ç§»ä½"></li>
</ol>
<ul>
<li>å¯¹å¯¹è±¡(obj)çš„ç›‘å¬<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="string">"key1"</span>:<span class="string">"vaule1"</span>&#125;</span><br><span class="line">observe(obj)</span><br></pre></td></tr></table></figure></li>
</ul>
<ol>
<li>ä»£ç è¿è¡Œåï¼Œåœ¨æ§åˆ¶å°ç›´æ¥ç»™objå¢åŠ ä¸€ä¸ªå…ƒç´ <code>obj[&quot;key2&quot;] = &quot;value2&quot;</code>ã€‚ä»£ç åŠè¾“å‡ºå¦‚ä¸‹ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é”®å…¥</span></span><br><span class="line">obj[<span class="string">"key2"</span>] = <span class="string">"value2"</span>;</span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// "value2"</span></span><br></pre></td></tr></table></figure>
===&gt; <strong>æ–°å¢çš„å¯¹è±¡å…ƒç´ æ— æ³•ç›‘å¬</strong><br>åŸå› ç±»åŒç›‘å¬æ•°ç»„æ—¶çš„æƒ…å†µ1</li>
</ol>
<h3 id="Observerçš„Object-definePropertyè¿™äº›é—®é¢˜ï¼Œvueå¦‚ä½•è§£å†³"><a href="#Observerçš„Object-definePropertyè¿™äº›é—®é¢˜ï¼Œvueå¦‚ä½•è§£å†³" class="headerlink" title="Observerçš„Object.definePropertyè¿™äº›é—®é¢˜ï¼Œvueå¦‚ä½•è§£å†³"></a>Observerçš„Object.definePropertyè¿™äº›é—®é¢˜ï¼Œvueå¦‚ä½•è§£å†³</h3><p>åœ¨vueçš„coreä¸­ï¼Œobserveä¸‹ä¸“é—¨å¯¹arrayçš„ç›‘å¬è¿›è¡Œäº†é‡å†™ï¼Œä»¥ä¸‹å†…å®¹ä¸ºæºç ä¸­çš„ä»£ç ç‰‡æ®µï¼Œæ¥è¯´æ˜å¦‚ä½•é‡å†™å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; def &#125; <span class="keyword">from</span> <span class="string">'../util/index'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arrayProto = <span class="built_in">Array</span>.prototype  <span class="comment">// è·å–ArrayåŸå‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> arrayMethods = <span class="built_in">Object</span>.create(arrayProto)  <span class="comment">// ç”¨æ–°çš„åŸå‹å¯¹è±¡åˆ›å»ºä¸€ä¸ªarrayMethods</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªè¦é‡å†™çš„æ–¹æ³•çš„æ•°ç»„ï¼Œå…¶ä¸­çš„æ–¹æ³•ï¼Œéƒ½æ˜¯ä¼šå‘ç”Ÿæ•°ç»„ç§»ä½çš„</span></span><br><span class="line"><span class="keyword">const</span> methodsToPatch = [</span><br><span class="line">  <span class="string">'push'</span>,</span><br><span class="line">  <span class="string">'pop'</span>,</span><br><span class="line">  <span class="string">'shift'</span>,</span><br><span class="line">  <span class="string">'unshift'</span>,</span><br><span class="line">  <span class="string">'splice'</span>,</span><br><span class="line">  <span class="string">'sort'</span>,</span><br><span class="line">  <span class="string">'reverse'</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹¦æˆªå˜åŒ–æ–¹æ³•å¹¶å‘å‡ºäº‹ä»¶,éå†é‡å†™çš„æ–¹æ³•çš„æ•°ç»„methodsToPatch</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">methodsToPatch.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">method</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// cache original method</span></span><br><span class="line">  <span class="keyword">const</span> original = arrayProto[method]</span><br><span class="line">  <span class="comment">// defæ˜¯ä¸€ä¸ªObject.defineProperty</span></span><br><span class="line">  def(arrayMethods, method, <span class="function"><span class="keyword">function</span> <span class="title">mutator</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> result = original.apply(<span class="keyword">this</span>, args)</span><br><span class="line">    <span class="keyword">const</span> ob = <span class="keyword">this</span>.__ob__</span><br><span class="line">    <span class="keyword">let</span> inserted</span><br><span class="line">    <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'push'</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'unshift'</span>:</span><br><span class="line">        inserted = args</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'splice'</span>:</span><br><span class="line">        inserted = args.slice(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (inserted) ob.observeArray(inserted)</span><br><span class="line">    <span class="comment">// notify change </span></span><br><span class="line">    <span class="comment">// æ‰‹åŠ¨å‘å¸ƒå˜æ›´ä¿¡æ¯</span></span><br><span class="line">    ob.dep.notify()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vueæºç è§£è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼</title>
    <url>/2020/08/12/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<h3 id="ç®€å•ä»‹ç»ä¸€ä¸‹"><a href="#ç®€å•ä»‹ç»ä¸€ä¸‹" class="headerlink" title="ç®€å•ä»‹ç»ä¸€ä¸‹"></a>ç®€å•ä»‹ç»ä¸€ä¸‹</h3><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåˆç§°<strong>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</strong>ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§<strong>ä¸€å¯¹å¤š</strong>çš„å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼Œè¿™ä¸ªä¸»é¢˜å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚</p>
<h3 id="ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„ï¼š"><a href="#ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„ï¼š" class="headerlink" title="ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„ï¼š"></a>ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼çš„å¥½å¤„ï¼š</h3><ul>
<li>æ”¯æŒç®€å•çš„å¹¿æ’­é€šä¿¡ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å·²ç»è®¢é˜…è¿‡çš„å¯¹è±¡ã€‚</li>
<li>é¡µé¢è½½å…¥åç›®æ ‡å¯¹è±¡å¾ˆå®¹æ˜“ä¸è§‚å¯Ÿè€…å­˜åœ¨ä¸€ç§åŠ¨æ€å…³è”ï¼Œå¢åŠ äº†çµæ´»æ€§ã€‚</li>
<li>ç›®æ ‡å¯¹è±¡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„æŠ½è±¡è€¦åˆå…³ç³»èƒ½å¤Ÿå•ç‹¬æ‰©å±•ä»¥åŠé‡ç”¨ã€‚</li>
</ul>
<h3 id="ç”¨javaScriptå®ç°ä¸€èˆ¬ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼"><a href="#ç”¨javaScriptå®ç°ä¸€èˆ¬ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="ç”¨javaScriptå®ç°ä¸€èˆ¬ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼"></a>ç”¨javaScriptå®ç°ä¸€èˆ¬ç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼</h3><p><em>pub(Publish) å‘å¸ƒ</em><br><em>sub(Subscribe) è®¢é˜…</em><br><em>dep å‘å¸ƒè®¢é˜…ä¸­å¿ƒ-ç”µè¯æœ¬</em></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> dep = &#123;&#125;;  <span class="comment">// depç›¸å½“äºç”µè¯æœ¬ï¼Œæ‰€æœ‰è®¢é˜…è€…éƒ½æ³¨å†Œåœ¨è¿™é‡Œ</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">q</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> topics = &#123;&#125;, <span class="comment">// å›è°ƒå‡½æ•°å­˜æ”¾çš„æ•°ç»„</span></span><br><span class="line">        subUid = <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">// å‘å¸ƒæ–¹æ³•</span></span><br><span class="line">    q.publish = <span class="function"><span class="keyword">function</span> (<span class="params">topic, args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!topics[topic]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> subscribers = topics[topic],</span><br><span class="line">                len = subscribers ? subscribers.length : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (len--) &#123;</span><br><span class="line">                <span class="comment">// éå†æ‰€æœ‰è®¢é˜…çš„æ–¹æ³•ï¼Œå…¨éƒ¨æ‰§è¡Œ</span></span><br><span class="line">                subscribers[len].func(topic, args);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è®¢é˜…æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// @param  topic  è®¢é˜…è€…åç§°</span></span><br><span class="line">    <span class="comment">// @param  func   è®¢é˜…æ–¹æ³•ï¼Œé€šçŸ¥æ—¶ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•å®ç°é€šçŸ¥</span></span><br><span class="line">    q.subscribe = <span class="function"><span class="keyword">function</span> (<span class="params">topic, func</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!topics[topic]) &#123;</span><br><span class="line">            <span class="comment">// æ³¨å†Œè§‚å¯Ÿå¯¹è±¡</span></span><br><span class="line">            topics[topic] = [];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> token = (++subUid).toString();   <span class="comment">// æ–¹æ³•çš„å”¯ä¸€å£ä»¤æ ‡è¯†ï¼Œé€€è®¢æ—¶å¯ç”¨</span></span><br><span class="line">        <span class="comment">// æ³¨å†Œè§‚å¯Ÿæ–¹æ³•</span></span><br><span class="line">        topics[topic].push(&#123;</span><br><span class="line">            token: token,</span><br><span class="line">            func: func</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//é€€è®¢æ–¹æ³•</span></span><br><span class="line">    q.unsubscribe = <span class="function"><span class="keyword">function</span> (<span class="params">token</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> m <span class="keyword">in</span> topics) &#123;</span><br><span class="line">            <span class="keyword">if</span> (topics[m]) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, j = topics[m].length; i &lt; j; i++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (topics[m][i].token === token) &#123;</span><br><span class="line">                        <span class="comment">// æ ¹æ®å”¯ä¸€å£ä»¤æ ‡è¯† ç§»é™¤è§‚å¯Ÿæ–¹æ³•ï¼Œå®ç°é€€è®¢</span></span><br><span class="line">                        topics[m].splice(i, <span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">return</span> token;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125; (dep));</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¸Šé¢è¿™ä¸ªè§‚å¯Ÿè€…æ¨¡å¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¥ï¼Œè®¢é˜…ä¸€ä¸ª</span></span><br><span class="line">pubsub.subscribe(<span class="string">'example1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">topics, data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// é€šçŸ¥æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•æ”¶åˆ°é€šçŸ¥æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">console</span>.log(topics + <span class="string">": "</span> + data);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// å†åŠ ä¸€ä¸ªè®¢é˜…æ–¹æ³•</span></span><br><span class="line">pubsub.subscribe(<span class="string">'example1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">topics, data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•ä¹Ÿæ”¶åˆ°é€šçŸ¥æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">Array</span>.isArray(data))&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æ¥åˆ°é€šçŸ¥2'</span>,topics,  data)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//å‘å¸ƒé€šçŸ¥</span></span><br><span class="line">pubsub.publish(<span class="string">'example1'</span>, <span class="string">'hello world!'</span>);</span><br><span class="line">pubsub.publish(<span class="string">'example1'</span>, [<span class="string">'test'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]);</span><br><span class="line">pubsub.publish(<span class="string">'example1'</span>, [&#123; <span class="string">'color'</span>: <span class="string">'blue'</span> &#125;, &#123; <span class="string">'text'</span>: <span class="string">'hello'</span>&#125;]);</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€å¼ å›¾è¯´æ¸…æ¥šè§‚å¯Ÿè€…æ¨¡å¼"><a href="#ä¸€å¼ å›¾è¯´æ¸…æ¥šè§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="ä¸€å¼ å›¾è¯´æ¸…æ¥šè§‚å¯Ÿè€…æ¨¡å¼"></a>ä¸€å¼ å›¾è¯´æ¸…æ¥šè§‚å¯Ÿè€…æ¨¡å¼</h3><p><img src="http://i.feidom.com/sub_pub%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.png" alt="è§‚å¯Ÿè€…æ¨¡å¼"></p>
<h3 id="ç‰¹åˆ«é¸£è°¢"><a href="#ç‰¹åˆ«é¸£è°¢" class="headerlink" title="ç‰¹åˆ«é¸£è°¢"></a>ç‰¹åˆ«é¸£è°¢</h3><p>æ­¤ç¯‡ç¬”è®°æ˜¯çœ‹äº†<a class="link"   href="https://www.cnblogs.com/TomXu/archive/2012/03/02/2355128.html"  target="_blank" rel="noopener">æ±¤å§†å¤§å”çš„åšå®¢-æ·±å…¥ç†è§£JavaScriptç³»åˆ—ï¼ˆ32ï¼‰ï¼šè®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼<i class="fas fa-external-link-alt"></i></a>,ç¬”è®°å†…å®¹å¤§å¤šæ¥è‡ªè¯¥ç¯‡åšå®¢ã€‚å¤§å”çš„åšå®¢ä¸­è¿˜æœ‰å…¶ä»–è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°æ–¹å¼ï¼Œå¦‚éœ€æ›´æ·±çš„ç†è§£ï¼Œè¯·ç§»æ­¥ã€‚</p>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä¸­ä½¿ç”¨gsapçš„åŠ¨ç”»æ’ä»¶</title>
    <url>/2020/08/07/vue%E4%B8%AD%E4%BD%BF%E7%94%A8tweenmax%E5%8A%A8%E7%94%BB%E6%8F%92%E4%BB%B6/</url>
    <content><![CDATA[<h3 id="gsap-åŠ¨ç”»"><a href="#gsap-åŠ¨ç”»" class="headerlink" title="gsap åŠ¨ç”»"></a>gsap åŠ¨ç”»</h3><p><a class="link"   href="https://www.tweenmax.com.cn/demo/"  target="_blank" rel="noopener">TweenMaxåŸºç¡€æ¡ˆä¾‹<i class="fas fa-external-link-alt"></i></a></p>
<ul>
<li><p>npm install / yarn add äºŒé€‰ä¸€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install gsap --save</span><br><span class="line">yarn add gsap</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>component.vue</code>å±€éƒ¨å¼•å…¥ï¼Œå“ªé‡Œéœ€è¦å“ªé‡Œæ¬</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä»¥ä¸‹ä¾‹å­æ¯ä¸ªåŠ¨ç”»çš„å¼€å§‹æ—¶é—´æŒ‰0.5s é”™å¼€ã€‚TweenLiteæ²¡æœ‰staggerã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box green"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box grey"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box orange"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box green"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box grey"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box orange"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box green"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box grey"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box orange"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"showTest()"</span>&gt;</span>å¼€å§‹<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> &#123; TweenLite, TweenMax &#125; <span class="keyword">from</span> <span class="string">'gsap'</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            showTest: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="comment">//TweenMaxã€TimelineLiteã€TimelineMaxå¯ä»¥ä½¿ç”¨staggerï¼ˆé”™å¼€åŠ¨ç”»ï¼‰ï¼ŒTweenLiteåˆ™æ²¡æœ‰ã€‚</span></span></span><br><span class="line"><span class="actionscript">                TweenMax.staggerTo(<span class="string">".box"</span>, <span class="number">1</span>, &#123;rotation:<span class="number">360</span>, y:<span class="number">100</span>&#125;, <span class="number">0.5</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>åŠ¨ç”»</tag>
        <tag>tweenmax</tag>
        <tag>gsap</tag>
      </tags>
  </entry>
  <entry>
    <title>vueä¸­ä½¿ç”¨animate.css</title>
    <url>/2020/08/07/vue%E4%B8%AD%E4%BD%BF%E7%94%A8animateCss/</url>
    <content><![CDATA[<h3 id="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨animate-css"><a href="#åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨animate-css" class="headerlink" title="åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨animate.css"></a>åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨animate.css</h3><p>é…åˆvueä¸­çš„transitionæ ‡ç­¾æ¥ç»“åˆanimate.cssä¸­çš„æ•ˆæœ</p>
<ul>
<li><p>npm install / yarn add äºŒé€‰ä¸€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add animate.css@3.5.1</span><br><span class="line"><span class="comment"># åœ¨è¿™è¦è£…3.5.1çš„ç‰ˆæœ¬ï¼Œè£…äº†4.0ä¹‹åçš„ç‰ˆæœ¬ï¼Œä¼šä¸ç”Ÿæ•ˆã€‚æ˜¯ç‰ˆæœ¬å…¼å®¹é—®é¢˜</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>main.js</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> animate <span class="keyword">from</span> <span class="string">'animate.css'</span></span><br><span class="line">Vue.use(animate);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>component.vue</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">transition</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">enter-active-class</span>=<span class="string">"animated bounceIn"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">leave-active-class</span>=<span class="string">"animated bounceOut"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:duration</span>=<span class="string">"1000"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-show</span>=<span class="string">"show"</span>&gt;</span>è¿™ä¸ªå…ƒç´ å­˜åœ¨åŠ¨ç”»æ•ˆæœ<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span>  @<span class="attr">click</span>=<span class="string">"show=!show"</span>&gt;</span>å¼€å§‹è¡¨æ¼”<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>vue</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>vue</tag>
        <tag>åŠ¨ç”»</tag>
      </tags>
  </entry>
  <entry>
    <title>Cssä»è¾¹è§’èµ°å‘ä¸­å¿ƒ</title>
    <url>/2020/08/04/postcss/</url>
    <content><![CDATA[<h3 id="è¢«è½»è§†çš„CSS"><a href="#è¢«è½»è§†çš„CSS" class="headerlink" title="è¢«è½»è§†çš„CSS"></a>è¢«è½»è§†çš„CSS</h3><p>CSSæ˜¯Cascading Style Sheetsï¼ˆå±‚å æ ·å¼è¡¨å•ï¼‰çš„ç®€ç§°ã€‚è¿™ç§æ ·å¼è„šæœ¬ä¸€ç›´å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€æœ‰å·®è·ã€‚å¯¼è‡´äº†cssè¢«è½»è§†ã€‚è¿‘å‡ å¹´æ‰€æœ‰çš„å‰ç«¯æŠ€æœ¯éƒ½åœ¨ç–¯ç‹‚çš„è¿­ä»£æ›´æ–°ï¼Œcssä¹Ÿä¸ä¾‹å¤–ã€‚ä»sassï¼Œlessï¼Œstylusè¿™äº›é¢„å¤„ç†å™¨ä¹‹åï¼Œåˆ°CSS Moduleï¼ŒCSS-in-JSï¼ˆå…¸å‹çš„ä»£è¡¨ï¼Œreactçš„styled-componentsï¼‰ã€‚å†èŠèŠ<a class="link"   href="https://www.postcss.com.cn/"  target="_blank" rel="noopener">PostCss<i class="fas fa-external-link-alt"></i></a>è¿™ç§æ’ä»¶ç³»ç»Ÿã€‚</p>
<h3 id="é¢„å¤„ç†å™¨"><a href="#é¢„å¤„ç†å™¨" class="headerlink" title="é¢„å¤„ç†å™¨"></a>é¢„å¤„ç†å™¨</h3><h5 id="åœ¨csså‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€äº›ç—›ç‚¹ï¼š"><a href="#åœ¨csså‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€äº›ç—›ç‚¹ï¼š" class="headerlink" title="åœ¨csså‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€äº›ç—›ç‚¹ï¼š"></a>åœ¨csså‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€äº›ç—›ç‚¹ï¼š</h5><ul>
<li>è¯­æ³•ä¸å¤Ÿå¼ºå¤§ï¼Œä¸èƒ½å¤ŸåµŒå¥—ä¹¦å†™ï¼Œä¸åˆ©äºæ¨¡å—å¼€å‘</li>
<li>æ²¡æœ‰å˜é‡å’Œé€»è¾‘ä¸Šçš„å¤ç”¨æœºåˆ¶ï¼Œå¯¼è‡´åœ¨cssçš„å±æ€§å€¼ä¸­åªèƒ½ä½¿ç”¨å­—é¢é‡å½¢å¼ï¼Œä»¥åŠä¸æ–­é‡å¤çš„æ ·å¼ï¼Œå¯¼è‡´éš¾ä»¥ç»´æŠ¤ã€‚</li>
</ul>
<h5 id="ç„¶åcssé¢„å¤„ç†å™¨çš„å‡ºç°ï¼Œå¼¥è¡¥äº†è¿™äº›é—æ†¾ï¼š"><a href="#ç„¶åcssé¢„å¤„ç†å™¨çš„å‡ºç°ï¼Œå¼¥è¡¥äº†è¿™äº›é—æ†¾ï¼š" class="headerlink" title="ç„¶åcssé¢„å¤„ç†å™¨çš„å‡ºç°ï¼Œå¼¥è¡¥äº†è¿™äº›é—æ†¾ï¼š"></a>ç„¶åcssé¢„å¤„ç†å™¨çš„å‡ºç°ï¼Œå¼¥è¡¥äº†è¿™äº›é—æ†¾ï¼š</h5><ul>
<li><strong>å˜é‡</strong>ï¼šå¯¹å˜é‡è¿›è¡Œå£°æ˜ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹å¼•ç”¨ã€‚</li>
<li><strong>ä½œç”¨åŸŸ</strong>ï¼šå¯¹å˜é‡è¿›è¡Œç®¡ç†ï¼Œåƒjsä¸€æ ·ï¼Œä»å±€éƒ¨ä½œç”¨åŸŸå¼€å§‹å‘ä¸ŠæŸ¥æ‰¾å˜é‡ã€‚</li>
<li><strong>åµŒå¥—</strong>ï¼šç”±äºdomçš„æ ‘çŠ¶ç»“æ„ï¼Œcssæœ‰åµŒå¥—çš„å†™æ³•ï¼Œæ›´ç›´æ¥çš„è¡¨ç°äº†çˆ¶å­å±‚çº§ä¹‹é—´çš„æ˜ç¡®å…³ç³»ã€‚</li>
<li><strong>æ··åˆ(Mixin) Extend</strong>ï¼š</li>
<li><strong>è¿ç®—</strong>ï¼š</li>
<li><strong>å‡½æ•°</strong>ï¼š</li>
<li><strong>Namespaces&amp;Accessors</strong>ï¼š</li>
<li><strong>scope</strong>ï¼š</li>
<li><strong>æ³¨é‡Š</strong>ï¼š</li>
</ul>
<p>cssé¢„å¤„ç†å™¨æä¾›çš„è¿™äº›æ–¹æ¡ˆï¼Œæ˜¯æˆ‘ä»¬å¼€å‘äººå‘˜åœ¨å†™cssæ—¶æ›´åŠ çµæ´»ï¼Œç»´æŠ¤æ€§å¼ºã€‚<br>ä½†æ˜¯ï¼Œé¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œç¼ºä¹æ¨¡å—çš„æ¦‚å¿µï¼Œå…¨å±€å˜é‡çš„é—®é¢˜å›°æ‰°ç€ä½ ã€‚æ¯æ¬¡å®šä¹‰é€‰æ‹©å™¨æ—¶ï¼Œæ€»è¦é¡¾åŠåˆ°å…¶ä»–æ–‡ä»¶ä¸­æ˜¯å¦ä½¿ç”¨äº†åŒæ ·çš„å‘½åã€‚</p>
<h5 id="æœ‰é—®é¢˜å°±æœ‰è§£å†³ï¼Œå„ç§æ–¹æ¡ˆå‡ºç°ï¼ˆcssåˆ†å±‚ï¼‰"><a href="#æœ‰é—®é¢˜å°±æœ‰è§£å†³ï¼Œå„ç§æ–¹æ¡ˆå‡ºç°ï¼ˆcssåˆ†å±‚ï¼‰" class="headerlink" title="æœ‰é—®é¢˜å°±æœ‰è§£å†³ï¼Œå„ç§æ–¹æ¡ˆå‡ºç°ï¼ˆcssåˆ†å±‚ï¼‰"></a>æœ‰é—®é¢˜å°±æœ‰è§£å†³ï¼Œå„ç§æ–¹æ¡ˆå‡ºç°ï¼ˆcssåˆ†å±‚ï¼‰</h5><h6 id="Qï¼šä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ"><a href="#Qï¼šä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ" class="headerlink" title="Qï¼šä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ"></a>Qï¼šä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ</h6><p>A:åŸå› ï¼š </p>
<ul>
<li>CSSæœ‰è¯­ä¹‰åŒ–çš„å‘½åçº¦å®šå’ŒCSSå±‚çš„åˆ†ç¦»ï¼Œå°†æœ‰åŠ©äºå®ƒçš„å¯æ‰©å±•æ€§ï¼Œæ€§èƒ½çš„æâ¾¼<br>å’Œä»£ç çš„ç»„ç»‡ç®¡ç†ã€‚</li>
<li>â¼¤é‡çš„æ ·å¼ï¼Œè¦†ç›–ã€æƒé‡å’Œå¾ˆå¤š!importantï¼Œåˆ†å¥½å±‚å¯ä»¥è®©å›¢é˜Ÿå‘½åç»Ÿâ¼€è§„èŒƒï¼Œ<br>â½…ä¾¿ç»´æŠ¤ã€‚</li>
<li>æœ‰è´£ä»»æ„Ÿåœ°å»å‘½åä½ çš„é€‰æ‹©å™¨ã€‚</li>
</ul>
<h6 id="åˆ†å±‚çš„è®¾è®¡è§„èŒƒæœ‰å¾ˆå¤šï¼Œä»¥ä¸‹å…·ä½“ä»‹ç»BEMè§„èŒƒ"><a href="#åˆ†å±‚çš„è®¾è®¡è§„èŒƒæœ‰å¾ˆå¤šï¼Œä»¥ä¸‹å…·ä½“ä»‹ç»BEMè§„èŒƒ" class="headerlink" title="åˆ†å±‚çš„è®¾è®¡è§„èŒƒæœ‰å¾ˆå¤šï¼Œä»¥ä¸‹å…·ä½“ä»‹ç»BEMè§„èŒƒ"></a>åˆ†å±‚çš„è®¾è®¡è§„èŒƒæœ‰å¾ˆå¤šï¼Œä»¥ä¸‹å…·ä½“ä»‹ç»BEMè§„èŒƒ</h6><ul>
<li>BEMè§„èŒƒ<br>å’ŒSMACCSâ¾®å¸¸ç±»ä¼¼ï¼Œä¸»è¦â½¤æ¥å¦‚ä½•ç»™é¡¹â½¬å‘½åã€‚â¼€ä¸ªç®€å•å‘½åæ›´å®¹æ˜“è®©åˆ«<br>â¼ˆâ¼€èµ·â¼¯ä½œã€‚â½å¦‚é€‰é¡¹å¡å¯¼èˆªæ˜¯â¼€ä¸ªå—(Block)ï¼Œè¿™ä¸ªå—â¾¥çš„å…ƒç´ çš„æ˜¯å…¶ä¸­æ ‡ç­¾ä¹‹â¼€<br>(Element)ï¼Œâ½½å½“å‰é€‰é¡¹å¡æ˜¯â¼€ä¸ªä¿®é¥°çŠ¶æ€(Modifier)ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// bookListæ¨¡å—   </span></span><br><span class="line">&lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"list-from"</span>&gt;</span><br><span class="line">    &lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"list-from__input"</span>&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button class="list-from__button"&gt;&lt;/</span>button&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ å…¶ä¸­å½’ç±»ä¸ºä»¥ä¸‹çº¦å®š</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ BEMï¼šå—ï¼ˆblockï¼‰ã€å…ƒç´ ï¼ˆelementï¼‰ã€ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰</span></span><br><span class="line"><span class="regexp">.block&#123;&#125;  /</span><span class="regexp">/ ä»£è¡¨äº†æ›´â¾¼çº§åˆ«çš„æŠ½è±¡æˆ–ç»„ä»¶</span></span><br><span class="line"><span class="regexp">.block__element&#123;&#125;  /</span><span class="regexp">/ ä»£è¡¨.blockçš„åä»£ï¼Œâ½¤äºå½¢æˆâ¼€ä¸ªå®Œæ•´çš„.blockçš„æ•´ä½“</span></span><br><span class="line"><span class="regexp">.block--modifier&#123;&#125;  /</span><span class="regexp">/ ä»£è¡¨.blockçš„ä¸åŒçŠ¶æ€æˆ–ä¸åŒç‰ˆæœ¬</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ å…¶ä¸­å—å¯ä»¥ç”¨å•ä¸ªè¿å­—ç¬¦æ¥ç•Œå®šï¼šå¦‚</span></span><br><span class="line"><span class="regexp">.site-search&#123;&#125; /</span><span class="regexp">/å—</span></span><br><span class="line"><span class="regexp">.site-search__field&#123;&#125; /</span><span class="regexp">/å…ƒç´ </span></span><br><span class="line"><span class="regexp">.site-search--full&#123;&#125; /</span><span class="regexp">/ä¿®é¥°ç¬¦</span></span><br></pre></td></tr></table></figure>
â€¦â€¦<br>å¥½éº»çƒ¦ã€‚</li>
</ul>
<hr>
<p>è¿˜æœ‰<a class="link"   href="https://smacss.com/"  target="_blank" rel="noopener">SMACSS(Scalable and Modular Architecture for CSS å¯æ‰©å±•çš„æ¨¡å—åŒ–æ¶æ„çš„CSS)<i class="fas fa-external-link-alt"></i></a>ã€<a class="link"   href="https://suitcss.github.io/"  target="_blank" rel="noopener">SUITï¼šè¡ç”Ÿè‡ªBEM<i class="fas fa-external-link-alt"></i></a>ã€<a class="link"   href="http://patternlab.io/"  target="_blank" rel="noopener">ACSSï¼šåŸå­cssè§„èŒƒ<i class="fas fa-external-link-alt"></i></a>ã€<a class="link"   href="http://csswizardry.net/talks/2014/11/itcss-dated.pdf"  target="_blank" rel="noopener">ITCSS<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="åå¤„ç†å™¨"><a href="#åå¤„ç†å™¨" class="headerlink" title="åå¤„ç†å™¨"></a>åå¤„ç†å™¨</h3><ul>
<li>CSSå‹ç¼© ClEAN_CSS</li>
<li>è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å‰ç¼€ Autoprefixer</li>
<li>CSSæ›´åŠ ç¾è§‚æ’åº CSScomb</li>
<li>Reworkå–ä»£stylesï¼Œåå¤„ç†å™¨å‘çƒ­</li>
</ul>
<h3 id="è¿‘å‡ å¹´ç«çˆ†çš„CSS-Moduleï¼ŒCSS-in-JSï¼ˆå…¸å‹çš„ä»£è¡¨ï¼Œreactçš„styled-componentsï¼‰ã€‚"><a href="#è¿‘å‡ å¹´ç«çˆ†çš„CSS-Moduleï¼ŒCSS-in-JSï¼ˆå…¸å‹çš„ä»£è¡¨ï¼Œreactçš„styled-componentsï¼‰ã€‚" class="headerlink" title="è¿‘å‡ å¹´ç«çˆ†çš„CSS Moduleï¼ŒCSS-in-JSï¼ˆå…¸å‹çš„ä»£è¡¨ï¼Œreactçš„styled-componentsï¼‰ã€‚"></a>è¿‘å‡ å¹´ç«çˆ†çš„CSS Moduleï¼ŒCSS-in-JSï¼ˆå…¸å‹çš„ä»£è¡¨ï¼Œreactçš„styled-componentsï¼‰ã€‚</h3><p>å¯ä»¥å‚è€ƒ<a class="link"   href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html"  target="_blank" rel="noopener">é˜®ä¸€å³°å†™çš„CSS Module<i class="fas fa-external-link-alt"></i></a><br>çœ‹8æœˆ3è€è¢çš„è¯¾ï¼Œå†™ä¸€ä¸‹ã€‚</p>
<h3 id="PostCSSæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#PostCSSæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="PostCSSæ˜¯ä»€ä¹ˆï¼Ÿ"></a>PostCSSæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><a class="link"   href="https://www.postcss.com.cn/"  target="_blank" rel="noopener">PostCSS<i class="fas fa-external-link-alt"></i></a><br>æ˜¯ä¸€ä¸ªç”¨ JavaScript å·¥å…·å’Œæ’ä»¶è½¬æ¢ CSS ä»£ç çš„å·¥å…·ã€‚â€”-å®˜æ–¹ç®€ä»‹</p>
<p>PostCSSåŒæ—¶æ”¯æŒé¢„å¤„ç†å’Œåå¤„ç†ï¼Œä¹Ÿå¯ä»¥åœ¨åŸç”Ÿçš„cssä¸­ä½¿ç”¨å®ƒã€‚é€šä¿—æ¥è¯´ï¼ŒPostCSSæ˜¯ä¸€ä¸ªâ€œå£³å£³â€ï¼Œå¯ä»¥åŠ è½½å„ç§ç”Ÿæ€ä¸­çš„æ’ä»¶æ¥å®ç°å¯¹cssçš„å¤„ç†ï¼Œå¯ä»¥ç»“åˆå…¼å®¹sassï¼Œlessç­‰</p>
<h5 id="ä¸‹é¢ä»‹ç»å‡ ç§æ’ä»¶ï¼ˆpluginsï¼‰ï¼š"><a href="#ä¸‹é¢ä»‹ç»å‡ ç§æ’ä»¶ï¼ˆpluginsï¼‰ï¼š" class="headerlink" title="ä¸‹é¢ä»‹ç»å‡ ç§æ’ä»¶ï¼ˆpluginsï¼‰ï¼š"></a>ä¸‹é¢ä»‹ç»å‡ ç§æ’ä»¶ï¼ˆpluginsï¼‰ï¼š</h5><ul>
<li>postcss-cssnext plugin â€”  ä½¿ç”¨ä¸‹ä¸ªç‰ˆæœ¬çš„cssè¯­æ³•ï¼Œè¯­æ³•è§cssnext (css4)è¯­æ³•</li>
<li>postcss-custom-properties â€” è¿è¡Œæ—¶å˜é‡</li>
<li>postcss-simple-vars â€” ä¸SCSSä¸€è‡´çš„å˜é‡å®ç°</li>
<li>postcss-mixins â€” å®ç°ç±»ä¼¼sassçš„@mixinçš„åŠŸèƒ½</li>
<li>postcss-extend â€” å®ç°ç±»ä¼¼sassçš„ç»§æ‰¿åŠŸèƒ½</li>
<li>postcss-import â€” å®ç°ç±»ä¼¼sassçš„import<h5 id="ä½¿ç”¨gulpå’Œwebpackå¤„ç†postcssä»£ç ï¼š"><a href="#ä½¿ç”¨gulpå’Œwebpackå¤„ç†postcssä»£ç ï¼š" class="headerlink" title="ä½¿ç”¨gulpå’Œwebpackå¤„ç†postcssä»£ç ï¼š"></a>ä½¿ç”¨gulpå’Œwebpackå¤„ç†postcssä»£ç ï¼š</h5>// gulpfile.js<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>); </span><br><span class="line"><span class="keyword">var</span> postcss = <span class="built_in">require</span>(<span class="string">'gulp-postcss'</span>); </span><br><span class="line"><span class="keyword">var</span> autoprefixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>); </span><br><span class="line"><span class="keyword">var</span> cssgrace = <span class="built_in">require</span>(<span class="string">'cssgrace'</span>); </span><br><span class="line"><span class="keyword">var</span> cssnext = <span class="built_in">require</span>(<span class="string">'cssnext'</span>); </span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">var</span> processors = [ </span><br><span class="line">        autoprefixer(&#123;<span class="attr">browsers</span>: [<span class="string">'last 3 version'</span>], </span><br><span class="line">        cascade: <span class="literal">false</span>, </span><br><span class="line">        remove: <span class="literal">false</span> </span><br><span class="line">        &#125;), </span><br><span class="line">        cssnext(), </span><br><span class="line">        cssgrace </span><br><span class="line">    ]; </span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./src/css/*.css'</span>) </span><br><span class="line">        .pipe(postcss(processors)) </span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist'</span>)); </span><br><span class="line">&#125;); </span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    gulp.watch(<span class="string">'./src/css/*.css'</span>, [<span class="string">'css'</span>]); </span><br><span class="line">&#125;); </span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'watch'</span>, <span class="string">'css'</span>]);</span><br></pre></td></tr></table></figure>
// webpack.conf.js<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">    output:&#123;<span class="attr">publicPath</span>: <span class="string">'../dist/'</span>&#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        <span class="comment">// loaders...</span></span><br><span class="line">    &#125;,</span><br><span class="line">    postcss: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            ima4dpr(dpr: <span class="number">3</span>,<span class="attr">q</span>: <span class="string">'q50'</span>,<span class="attr">s</span>: <span class="string">'s150'</span>&#125;),</span><br><span class="line">            px2rem(&#123;<span class="attr">remUnit</span>: remUnit, <span class="attr">baseDpr</span>: baseDpr &#125;),</span><br><span class="line">            autoprefixer(&#123;<span class="attr">browers</span>: [<span class="string">"ios_saf &gt;= 7"</span>,<span class="string">"android &gt;= 4"</span>]&#125;)</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: <span class="string">'source-map'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
æ‰“åŒ…å¤„ç†é€»è¾‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li>
</ul>
<p><img src="http://i.feidom.com/%E6%89%93%E5%8C%85%E5%90%8E%E7%94%9F%E6%88%90%E7%9A%84postcss.jpg" alt="æ‰“åŒ…å¤„ç†é€»è¾‘"></p>
<hr>
<p><em>ä»¥ä¸Šå†…å®¹å€Ÿé‰´<a class="link"   href="https://segmentfault.com/a/1190000011595620"  target="_blank" rel="noopener">zimoçš„ã€Šè°ˆè°ˆPostCSSã€‹<i class="fas fa-external-link-alt"></i></a></em></p>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>postcss</tag>
      </tags>
  </entry>
  <entry>
    <title>npm/yarnåŠå…¶ä»–åŒ…ç®¡ç†å·¥å…·å¸¸ç”¨æ€»ç»“</title>
    <url>/2020/08/02/npm%E5%B8%B8%E7%94%A8%E5%8C%85/</url>
    <content><![CDATA[<ul>
<li><p>å®‰è£…</p>
<ul>
<li><p>npm<br>è£…äº†<code>nodeJs</code>ä¼šè£…å¥½npm</p>
</li>
<li><p>yarn<br><a class="link"   href="https://yarn.bootcss.com/docs/install/"  target="_blank" rel="noopener">å®‰è£…yarn<i class="fas fa-external-link-alt"></i></a></p>
<p><code>npm install -g yarn</code></p>
</li>
</ul>
</li>
<li><p>ä¿®æ”¹æº</p>
<ul>
<li><p>npm (æ·˜å®æº ï½œ æœ¬æº)<br><code>npm config set registry http://registry.npm.taobao.org/</code></p>
<p><code>npm config set registry https://registry.npmjs.org/</code></p>
</li>
<li><p>yarn (æ·˜å®æº ï½œ æœ¬æº)<br><code>yarn config set registry http://registry.npm.taobao.org/</code></p>
<p><code>yarn config set registry https://registry.npmjs.org/</code></p>
</li>
</ul>
</li>
<li><p>è®¾ç½®ä»£ç†</p>
<ul>
<li><p>npm<br><code>npm config set proxy http://127.0.0.1:8080</code></p>
<p><code>npm config set https-proxy http://127.0.0.1:8080</code></p>
</li>
<li><p>yarn<br><code>yarn config set proxy http://127.0.0.1:8080</code></p>
<p><code>yarn config set https-proxy http://127.0.0.1:8080</code></p>
</li>
</ul>
</li>
<li><p>åˆ é™¤ä»£ç†</p>
<ul>
<li><p>npm<br><code>npm config delete proxy</code> </p>
<p><code>npm config delete https-proxy</code></p>
</li>
<li><p>yarn<br><code>yarn config delete proxy</code> </p>
<p><code>yarn config delete https-proxy</code></p>
</li>
</ul>
</li>
<li><p>æŸ¥çœ‹å®‰è£…åŒ…</p>
<ul>
<li>npm<br><code>npm list -g --depth 0</code></li>
<li>yarn<br><code>yarn global list --depth=0</code></li>
</ul>
</li>
</ul>
<blockquote>
<p><font color=red size=5>npx</font><br>    npx æ˜¯ npm 5.2+ ç‰ˆæœ¬ä¹‹åè‡ªå¸¦çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´é«˜æ•ˆçš„æ‰§è¡Œ npm è½¯ä»¶ä»“åº“é‡Œçš„å®‰è£…åŒ…ã€‚å¯¹äºé‚£äº›ä¸å¸¸ä½¿ç”¨ã€æˆ–è€…åªæƒ³ä¸€æ¬¡æ€§å°è¯•çš„å·¥å…·ï¼Œæ¨èä½¿ç”¨ npx çš„æ–¹å¼ä»£æ›¿ npm install -gã€yarn global å…¨å±€å®‰è£…<br>    $ npx create-react-app my-app<br>    # æ‰§è¡Œä»¥ä¸Šè¿™æ¡å‘½ä»¤ npx ä¼šæŒ‰ä»¥ä¸‹é¡ºåºå·¥ä½œï¼š<br>    # 1. å…ˆæŸ¥çœ‹å½“å‰é¡¹ç›®æœ‰æ²¡ create-react-app<br>    # 2. å¦‚æœå½“å‰é¡¹ç›®æ‰¾ä¸åˆ°ï¼Œä¼šå»å…¨å±€æŸ¥æ‰¾ create-react-app<br>    # 3. å¦‚æœå…¨å±€è¿˜æ‰¾ä¸åˆ°ï¼Œä¼šå¸®æˆ‘ä»¬ä¸´æ—¶ä» npm åŒ…ä»“åº“å®‰è£… create-react-appï¼Œä¸ä¼šæ±¡æŸ“åˆ°å½“å‰é¡¹ç›®ï¼Œä¹Ÿä¸ä¼šè£…åˆ°å…¨å±€</p>
</blockquote>
]]></content>
      <categories>
        <category>npm</category>
      </categories>
      <tags>
        <tag>yarn</tag>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>package.jsonäº†è§£å¤šå°‘</title>
    <url>/2020/08/02/package%E5%8C%85/</url>
    <content><![CDATA[<ul>
<li><strong>scriptså±æ€§</strong><br>ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<ol>
<li>preé’©å­<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"predev"</span>: <span class="string">"echo 111"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"echo 222"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
ä¸Šè¿°ä»£ç æ‰§è¡Œ<code>yarn run dev</code>,ä¼šå…ˆæ‰§è¡Œpreé’©å­ï¼Œç»“æœå¦‚ä¸‹ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ yarn run dev</span><br><span class="line">// ä»¥ä¸‹ä¸ºç»“æœ</span><br><span class="line">111</span><br><span class="line">222</span><br></pre></td></tr></table></figure></li>
<li>&amp;(åŒæ­¥ä¸²è¡Œ) å’Œ &amp;&amp;(å¼‚æ­¥å¹¶è¡Œ)<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"echo 111"</span>,</span><br><span class="line">    <span class="string">"server"</span>: <span class="string">"echo 222"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run dev &amp; npm run server"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
ä¸Šè¿°ä»£ç æ‰§è¡Œ<code>yarn start</code>,ä¼šå…ˆæ‰§è¡Œdev,å†æ‰§è¡Œserverï¼Œdevæœ‰æŠ¥é”™ï¼Œserverä¸ä¼šè¢«æ‰§è¡Œã€‚<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"echo 111"</span>,</span><br><span class="line">    <span class="string">"server"</span>: <span class="string">"echo 222"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run dev &amp;&amp; npm run server"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
ä¸Šè¿°ä»£ç æ‰§è¡Œ<code>yarn start</code>,ä¼šåŒæ­¥è¡Œdevå’Œserverï¼Œdevæœ‰æŠ¥é”™ï¼Œserverä»ä¼šè¢«æ‰§è¡Œã€‚</li>
</ol>
]]></content>
      <categories>
        <category>nodejs</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx 403 Forbidden</title>
    <url>/2020/07/31/nginx403/</url>
    <content><![CDATA[<ul>
<li><p>æ£€æŸ¥ç›®å½•æƒé™ã€‚æƒé™ä¸è¶³çš„å°±åŠ ä¸ªæƒé™ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod -R 755 /root/feidom_blog/</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>nginx.conf</code>ä¸­çš„useré—®é¢˜</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vi /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</span><br><span class="line"><span class="comment"># user  nobody;</span></span><br><span class="line"><span class="comment"># æŠŠ user ç”¨æˆ·å æ”¹ä¸º user root æˆ– å…¶å®ƒæœ‰é«˜æƒé™çš„ç”¨æˆ·åç§°å³å¯</span></span><br><span class="line">user root;</span><br></pre></td></tr></table></figure></li>
<li><p>centosä¸­çš„selinuxæ˜¯å¦ä¸ºå…³é—­çŠ¶æ€<br>æŸ¥çœ‹SELinuxçŠ¶æ€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ &#x2F;usr&#x2F;sbin&#x2F;sestatus -v</span><br><span class="line">SELinux status:                 disabled</span><br><span class="line">##  disabled&#x2F;enabled  (å…³é—­&#x2F;å¼€å¯)</span><br></pre></td></tr></table></figure>
<p>å…³é—­SELinuxï¼š</p>
</li>
</ul>
<ol>
<li>ä¸´æ—¶å…³é—­ï¼Œä¸ç”¨é‡å¯æœºå™¨ã€‚<br><code>$ setenforce 0</code>  #è®¾ç½®SELinux æˆä¸ºpermissiveæ¨¡å¼;<br><code>$ setenforce 1</code>      #è®¾ç½®SELinux æˆä¸ºenforcingæ¨¡å¼</li>
<li>ä¿®æ”¹/etc/selinux/config æ–‡ä»¶åï¼Œé‡å¯æœºå™¨ä½¿å…¶ç”Ÿæ•ˆã€‚<br><code>SELINUX=enforcing</code>  æ”¹ä¸º <code>SELINUX=disabled</code></li>
</ol>
]]></content>
      <categories>
        <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      </categories>
      <tags>
        <tag>é—®é¢˜è§£å†³</tag>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>DNSåŸŸåè§£æ</title>
    <url>/2020/07/28/DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/</url>
    <content><![CDATA[<p>DNS: domain name system  </p>
<p><em>ä½œç”¨ï¼šå°†åŸŸåè§£æåˆ°å¯¹åº”çš„ipåœ°å€</em><br><em>è§£æåŸç†ï¼šåˆ†çº§è§£æ</em></p>
<ul>
<li><p>åŸŸååˆ†çº§(ä¸€çº§ï¼ŒäºŒçº§ï¼Œä¸‰çº§)<br>  <code>www.baidu.com</code><br>  <code>com</code>æ˜¯æ ¹åŸŸåï¼Œ<code>baidu.com</code>æ˜¯ä¸€çº§åŸŸåï¼ˆé¡¶çº§åŸŸåï¼‰ï¼Œ<code>www.baidu.com</code>æ˜¯äºŒçº§åŸŸå</p>
</li>
<li><p>ip<br>  åˆ†ä¸ºipv4ï¼Œipv6</p>
</li>
<li><p>è§£æè¯¦è§£<br>  <img src="http://i.feidom.com/dns%E8%A7%A3%E6%9E%90.png" alt="è§£æå›¾è§£"></p>
<ol>
<li><a class="link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com<i class="fas fa-external-link-alt"></i></a>?</li>
<li>com = 1.1.1.1 ï¼ˆTLDæœåŠ¡å™¨åœ°å€ï¼‰</li>
<li><a class="link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com<i class="fas fa-external-link-alt"></i></a>?</li>
<li>baidu.com = 2.2.2.2 ï¼ˆåç§°æœåŠ¡å™¨åœ°å€ name serverï¼‰</li>
<li><a class="link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com<i class="fas fa-external-link-alt"></i></a>?</li>
<li><a class="link"   href="http://www.baidu.com"  target="_blank" rel="noopener">www.baidu.com<i class="fas fa-external-link-alt"></i></a> = 3.3.3.3 ï¼ˆç›®æ ‡ipåœ°å€ï¼‰</li>
</ol>
</li>
</ul>
<p>dnsç¼“å­˜å¯ä»¥ä½¿è§£ææ›´å¿«å“åº”ã€‚</p>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>Navigation Timing &amp; Navigation Timing API</title>
    <url>/2020/07/24/navigationTiming/</url>
    <content><![CDATA[<h3 id="Navigation-Timing"><a href="#Navigation-Timing" class="headerlink" title="Navigation Timing"></a>Navigation Timing</h3><p><img src="http://i.feidom.com/performance_timing_api.jpg" alt="å®é™…æƒ…å†µ"></p>
<p>å›¾è§£ï¼š</p>
<ul>
<li><p>Prompt for unload                   // æ¿€èµ·å¸è½½</p>
<ul>
<li>navigationStart                 // å¯¼èˆªå¼€å§‹</li>
</ul>
</li>
<li><p>redirect                            // æœ¬åœ°é‡å®šå‘</p>
<ul>
<li>redirectStart</li>
<li>redirectEnd</li>
</ul>
</li>
<li><p>unload                              // æœ¬åœ°é‡å®šå‘çš„åŒæ—¶ å¸è½½</p>
<ul>
<li>unloadStart</li>
<li>unloadEnd</li>
</ul>
</li>
<li><p>App cache                           // æœ‰ç¼“å­˜æ‹¿ç¼“å­˜</p>
<ul>
<li>fetchStart</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>DNS                                 // <a href="/2020/07/28/DNSåŸŸåè§£æ/">DNSåŸŸåè§£æ</a><ul>
<li>domainLookipStart</li>
<li>domainLookupEnd</li>
</ul>
</li>
<li>TCP                                 // å»ºç«‹tcpè¿æ¥<ul>
<li>connectStart                    // å¼€å§‹ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹</li>
<li>(secureConnectionStart)         // å»ºç«‹httpså®‰å…¨åè®®çš„åŠ å¯†é“¾æ¥</li>
<li>connectEnd</li>
</ul>
</li>
<li>Request                             // è¯·æ±‚<ul>
<li>requestStart</li>
</ul>
</li>
<li>Response                            // å“åº”<ul>
<li>responseStart</li>
<li>responseEnd</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>Processing                          // å‰ç«¯HTMLå¤„ç†<ul>
<li>domLoading                      </li>
<li>domInteractive                  </li>
<li>domContentLoaded                </li>
<li>domComplate</li>
</ul>
</li>
<li>onload                              // onload<ul>
<li>loadEventStart</li>
<li>loadEventEnd</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>HTMLã€CSSã€JSäº’ç›¸é˜»å¡ï¼Ÿå’‹å›äº‹</title>
    <url>/2020/07/23/HTMLCSSJS%E6%B8%B2%E6%9F%93%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<p>jsæ˜¯åŒæ­¥çš„ï¼Œä¸ºäº†æ“ä½œdomã€‚åœ¨htmlæ‰§è¡Œä¸­ï¼Œä¹Ÿç”±äºè¿™ä¸ªåŸå› ï¼Œæœ‰åŒæ­¥é˜»å¡çš„æƒ…å†µã€‚</p>
<h3 id="jsçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—"><a href="#jsçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—" class="headerlink" title="jsçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—?"></a>jsçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—?</h3><pre><code><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// è¿™ä¸ªscriptæ”¾åœ¨domä¸Šè¾¹ï¼Œå½±å“domè§£æï¼Œä¹Ÿå½±å“domæ¸²æŸ“ã€‚</span></span></span><br><span class="line"><span class="actionscript">        alert(<span class="string">'1'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// è¿™ä¸ªscriptæ”¾åœ¨domä¸‹è¾¹ï¼Œå½±å“domæ¸²æŸ“ï¼Œä¸å½±å“domè§£æ</span></span></span><br><span class="line"><span class="actionscript">        alert(<span class="string">'1'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></code></pre><h3 id="cssçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—"><a href="#cssçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—" class="headerlink" title="cssçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—?"></a>cssçš„æ‰§è¡Œä¼šå½±å“Domæ¸²æŸ“å—?</h3><pre><code><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h1&#123;</span><br><span class="line">            color: red !important;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">document</span>.querySelectorAll(<span class="string">'h1'</span>))</span></span><br><span class="line">        &#125;,0)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.staticfile.org/animate.css/4.1.0/animate.compat.css"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- animate.cssæ²¡å›æ¥ä¹‹å‰ï¼Œscriptä¸­æ‰“å°äº†h1ï¼Œä½†æ˜¯h1å¹¶æ²¡æœ‰åœ¨é¡µé¢ä¸­å±•ç¤ºã€‚ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cssä¸å½±å“domè§£æï¼Œå½±å“domæ¸²æŸ“ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></code></pre><h3 id="cssçš„æ‰§è¡Œä¼šå½±å“jsæ‰§è¡Œå—"><a href="#cssçš„æ‰§è¡Œä¼šå½±å“jsæ‰§è¡Œå—" class="headerlink" title="cssçš„æ‰§è¡Œä¼šå½±å“jsæ‰§è¡Œå—?"></a>cssçš„æ‰§è¡Œä¼šå½±å“jsæ‰§è¡Œå—?</h3><pre><code><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h1&#123;</span><br><span class="line">            color: red !important;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.staticfile.org/animate.css/4.1.0/animate.compat.css"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- animate.cssæ²¡å›æ¥ä¹‹å‰ï¼Œscriptä¸­æ²¡æœ‰æ‰“å°h1ã€‚h1å¹¶æ²¡æœ‰åœ¨é¡µé¢ä¸­å±•ç¤ºã€‚ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cssåŠ è½½é˜»å¡jsæ‰§è¡Œã€‚åŸå› ï¼šjsä¸­å¯èƒ½å­˜åœ¨å¯¹domå…ƒç´ çš„æ“ä½œæˆ–è€…å–å€¼ï¼ŒåŒæ­¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥é˜»å¡ã€‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'1'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></code></pre><h3 id="cssçš„æ‰§è¡Œä¼šå½±å“domReadyå—"><a href="#cssçš„æ‰§è¡Œä¼šå½±å“domReadyå—" class="headerlink" title="cssçš„æ‰§è¡Œä¼šå½±å“domReadyå—?"></a>cssçš„æ‰§è¡Œä¼šå½±å“domReadyå—?</h3><p>domReadyæ—¶ï¼Œjså¯ä»¥æ“ä½œdomã€‚<br>    <figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">       <span class="built_in">document</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">           <span class="built_in">console</span>.log(<span class="string">'DOMContentLoaded'</span>)</span></span><br><span class="line">       &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.staticfile.org/animate.css/4.1.0/animate.compat.css"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åœ¨animate.cssæ²¡å›æ¥ä¹‹å‰ï¼Œæ‰“å°äº†DOMContentLoadedã€‚è¯´æ˜cssä¸å½±å“domReady --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'111'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åŠ äº†ä¸Šé¢è¿™ä¸ªscriptè„šæœ¬æ—¶ï¼Œåœ¨animate.cssæ²¡å›æ¥ä¹‹å‰ï¼Œä¸æ‰“å°111ï¼Œä¹Ÿä¸æ‰“å°DOMContentLoadedã€‚</span></span><br><span class="line"><span class="comment">    ä¹Ÿæ˜¯å› ä¸ºjsä¸­å¯èƒ½å­˜åœ¨å¯¹domå…ƒç´ çš„æ“ä½œæˆ–è€…å–å€¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹åŠä¼˜åŒ–</title>
    <url>/2020/07/22/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/</url>
    <content><![CDATA[<h3 id="ç†Ÿç»ƒä½¿ç”¨Chromeå¼€å‘å·¥å…·"><a href="#ç†Ÿç»ƒä½¿ç”¨Chromeå¼€å‘å·¥å…·" class="headerlink" title="ç†Ÿç»ƒä½¿ç”¨Chromeå¼€å‘å·¥å…·"></a>ç†Ÿç»ƒä½¿ç”¨Chromeå¼€å‘å·¥å…·</h3><p><img src="http://i.feidom.com/chrome_performance.png" alt="ChromePerformance"></p>
<h3 id="æµè§ˆå™¨æ¸²æŸ“åŸºç¡€"><a href="#æµè§ˆå™¨æ¸²æŸ“åŸºç¡€" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“åŸºç¡€"></a>æµè§ˆå™¨æ¸²æŸ“åŸºç¡€</h3><p>cpuä¸»è¦è´Ÿè´£æ“ä½œç³»ç»Ÿå’Œç¨‹åº  gpuè´Ÿè´£æ˜¾å¼  æ•°æ®å¤„ç†æ•ˆç‡æ›´é«˜  gpu.js</p>
<ul>
<li>Domæ˜¯åˆ†å±‚çš„<br>  firefoxçš„3dæ’ä»¶ï¼ˆå·²åºŸå¼ƒï¼‰å¾ˆå¥½çš„å±•ç°äº†è¿™ä¸ªç‚¹ã€‚<br>  <strong>Q:</strong>ä»€ä¹ˆå…ƒç´ ä¼šåˆ†å±‚ï¼Ÿ<br>  <strong>A:</strong>æ ¹å…ƒç´ ï¼Œpositionå±‚ï¼Œtransformã€åŠé€æ˜ã€cssæ»¤é•œã€canvasã€videoã€overflowç­‰</li>
<li>å¯¹DOMå…ƒç´ èŠ‚ç‚¹è®¡ç®—æ ·å¼ç»“æœã€‚ï¼ˆRecalculate Styleï¼‰</li>
<li>ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆå›¾å½¢ä½ç½®ã€‚ï¼ˆLayout å›æµ/é‡æ’ï¼‰</li>
<li>å°†æ¯ä¸ªèŠ‚ç‚¹ç»˜åˆ¶å¡«å……åˆ°å›¾å±‚ä½å›¾ä¸­ã€‚ï¼ˆPaintï¼‰</li>
<li>æŠŠå›¾å±‚ä½œä¸ºçº¹ç†ï¼Œä¸Šä¼ åˆ°GPU</li>
<li>æŠŠç¬¦åˆçš„å›¾å±‚ç”Ÿæˆåˆ°é¡µé¢ä¸Šã€‚ï¼ˆComposite Layers åˆæˆå±‚ï¼‰<br>  <strong>Q:</strong>Composite Layersåšäº†å•¥ï¼Ÿ<br>  <strong>A:</strong><pre><code>å›¾å±‚çš„ç»˜åˆ¶åˆ—è¡¨ï¼Œå‡†å¤‡å¥½ï¼Œcommitç»™ï¼ˆåˆæˆçº¿ç¨‹ï¼‰ä¸»çº¿ç¨‹
åˆæˆçº¿ç¨‹ viewport åˆ’åˆ†å›¾å—
ç”Ÿæˆä½å›¾çš„è¿‡ç¨‹  å…‰æ …åŒ– Raster
æ‰€æœ‰å›¾å— åˆæˆDarwQuadæäº¤ç»™æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹
vizç»„ä»¶æ¥æ”¶åˆ°DarwQuad åï¼Œç»˜åˆ¶åˆ°å±å¹•ä¸Š</code></pre></li>
</ul>
<p><strong>æ€»ç»“ä¸Šé¢è¿‡ç¨‹çš„ä¸»è¦è¿‡ç¨‹</strong><br>Layout ==&gt; Paint ==&gt; Composite Layers</p>
<h3 id="æ¸²æŸ“å¼•æ“ç»“æ„ä¸å·¥ä½œæµç¨‹"><a href="#æ¸²æŸ“å¼•æ“ç»“æ„ä¸å·¥ä½œæµç¨‹" class="headerlink" title="æ¸²æŸ“å¼•æ“ç»“æ„ä¸å·¥ä½œæµç¨‹"></a>æ¸²æŸ“å¼•æ“ç»“æ„ä¸å·¥ä½œæµç¨‹</h3><p>ä»¥HTMLã€JSã€CSSç­‰æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œä»¥å¯è§†åŒ–å†…å®¹ä½œä¸ºè¾“å‡º<br>ç»è¿‡ä¸‹é¢æ­¥éª¤ï¼š</p>
<ol>
<li>Parsing HTML to construct DOM tree<br> æ ¹æ®htmlæ–‡ä»¶ç”Ÿæˆdomæ ‘ï¼Œæ¡†æ¶</li>
<li>Render Tree Construction<br> æ ¹æ®cssï¼Œjsæ–‡ä»¶ï¼Œ<strong>åœ¨domæ ‘çš„åŸºç¡€ä¸Š</strong>ç”Ÿæˆæ¸²æŸ“æ ‘</li>
<li>Layout of Render Tree<br> æ¸²æŸ“æ ‘å¸ƒå±€æ’ç‰ˆï¼ˆé‡æ’ï¼‰</li>
<li>Painting Render Tree<br> æ’ç‰ˆä¹‹åã€‚ç»˜åˆ¶ï¼ˆé‡ç»˜ï¼‰</li>
<li>Display<br> ï¼ˆComposite Layers åˆæˆå±‚ï¼Œå¸ƒå±€æ ‘ï¼‰åï¼ŒæŠŠç¬¦åˆçš„å›¾å±‚ä¸Šä¼ åˆ°GPUç”Ÿæˆåˆ°é¡µé¢ä¸Šå±•ç¤ºã€‚<ul>
<li>æŠŠæ–‡æ¡£çš„ç»“æ„ã€å…ƒç´ çš„æ ·å¼ã€å‡ ä½•å½¢çŠ¶å’Œç»˜åˆ¶é¡ºåºè½¬æ¢åœ¨å±å¹•ä¸Šçš„åƒç´ ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå…‰æ …åŒ–</li>
<li>åˆæˆæ˜¯ä¸€ç§å°†é¡µé¢çš„å„ä¸ªéƒ¨åˆ†åˆ†å±‚ï¼Œåˆ†åˆ«æ …æ ¼åŒ–ï¼Œå¹¶åœ¨ä¸€ä¸ªè¢«ç§°ä¸ºåˆæˆå™¨çº¿ç¨‹çš„ç‹¬ç«‹çº¿ç¨‹ä¸­åˆæˆé¡µé¢çš„æŠ€æœ¯</li>
<li>ä¸Šä¼ åˆ°GPUç”Ÿæˆåˆ°é¡µé¢ä¸Šå±•ç¤ºã€‚</li>
</ul>
</li>
</ol>
<h3 id="æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–"><a href="#æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–"></a>æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–</h3><ul>
<li><p>è·³è¿‡é‡æ’é‡ç»˜ ç›´æ¥è§¦å‘äº†GPUæ‰§è¡Œ  è¿™å°±æ˜¯ç¡¬ä»¶åŠ é€Ÿ<br>  <strong>Q:</strong>ä»€ä¹ˆä¼šè§¦å‘ç¡¬ä»¶åŠ é€Ÿï¼Œè®©GPUåŠ å…¥è¿›æ¥ï¼Ÿ<br>  <strong>A:</strong>CSS3Dã€videoã€webglã€transformã€cssæ»¤é•œã€will-change:transform</p>
  <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> ball-running &#123;</span><br><span class="line">    0% &#123;</span><br><span class="line">        <span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/* transform: translate(0,0); */</span></span><br><span class="line">    &#125;</span><br><span class="line">    25% &#123;</span><br><span class="line">        <span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="comment">/* transform: translate(200px,0); */</span></span><br><span class="line">    &#125;</span><br><span class="line">    50% &#123;</span><br><span class="line">        <span class="attribute">top</span>:<span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">200px</span>;</span><br><span class="line">        <span class="comment">/* transform: translate(200px,200px); */</span></span><br><span class="line">    &#125;</span><br><span class="line">    75% &#123;</span><br><span class="line">        <span class="attribute">top</span>:<span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/* transform: translate(0,200px); */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  <em>ä¸Šé¢çš„åŠ¨ç”»ä»£ç ä¼šä¸€ç›´è§¦å‘é‡æ’é‡ç»˜ï¼Œæ€§èƒ½å·®</em><br>  <em>ä¸‹é¢çš„åŠ¨ç”»ä»£ç å°†å¤„ç†äº¤ç»™GPUæ”¾åœ¨ä¸€ä¸ªlayerå±‚ä¸­å»å¤„ç†ï¼Œè·³è¿‡é‡æ’é‡ç»˜,æ€§èƒ½å¤§å¤§æå‡</em></p>
  <figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> ball-running &#123;</span><br><span class="line">    0% &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    25% &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">200px</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    50% &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">200px</span>,<span class="number">200px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    75% &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>,<span class="number">200px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  <strong>Q:</strong>ä»€ä¹ˆå±æ€§ä¼šé€ æˆé‡æ’é‡ç»˜ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Ÿ<br>  <strong>A:</strong></p>
<pre><code>å¯ä»¥å‚è€ƒè¿™ä¸ªç½‘ç«™ï¼š[csstriggers](https://csstriggers.com/)
ç›’å­æ¨¡å‹çš„ç›’å­å˜äº†
è¯»å±æ€§æ—¶ï¼šoffsetã€scrollã€clientã€widthä¼šé€ æˆé‡æ’ï¼ˆä¸‹é¢ä¸ºè§£å†³æ–¹æ¡ˆ:requestAnimationFrameï¼‰
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; è§£å†³æ–¹å¼: è¯»å†™åˆ†ç¦»ï¼ˆè¯»å†™è¯»å†™è¯»å†™&#x3D;&#x3D;&#x3D;&gt;è¯»è¯»è¯»å†™å†™å†™ï¼‰</span><br><span class="line">const width &#x3D; document.getElementById(&quot;xx&quot;).width;</span><br><span class="line">requestAnimationFrame(function()&#123;</span><br><span class="line">    &#x2F;&#x2F; å†™é€»è¾‘</span><br><span class="line">    &#x2F;&#x2F; React Fiberï¼Ÿ</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></code></pre></li>
</ul>
<h3 id="å¤§é‡Domå¦‚ä½•ä¼˜åŒ–"><a href="#å¤§é‡Domå¦‚ä½•ä¼˜åŒ–" class="headerlink" title="å¤§é‡Domå¦‚ä½•ä¼˜åŒ–"></a>å¤§é‡Domå¦‚ä½•ä¼˜åŒ–</h3><p>ä»¥ä¸‹å†…å®¹æ¥è‡ª<strong>äº¬åŸä¸€ç¯</strong>å°ç¨‹åºDay102é¢˜</p>
<ul>
<li>ç¼“å­˜Domå¯¹è±¡<br>  æ“ä½œDomæ—¶ï¼Œå¦‚æœæœ‰è®¿é—®Domçš„æ“ä½œã€‚å°¤å…¶åƒå¾ªç¯éå†è¿™ç§æ—¶é—´å¤æ‚åº¦è¾ƒé«˜çš„æ“ä½œã€‚<br>  åœ¨å¾ªç¯å‰å°†çˆ¶ï¼ˆä¸»ï¼‰èŠ‚ç‚¹å…ˆè·å–åˆ°ï¼Œåœ¨å¾ªç¯ä¸­å°±å¯ä»¥ç›´æ¥é¥®ç”¨ï¼Œä¸å¿…è¦å¾ªç¯æŸ¥è¯¢  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> rootElem = <span class="built_in">document</span>.querySelector(<span class="string">'#app'</span>);</span><br><span class="line"><span class="keyword">let</span> childList = rootElem.child; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;childList.length;j++)&#123;</span><br><span class="line">    <span class="comment">//å¯¹åº”æ“ä½œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æ–‡æ¡£ç‰‡æ®µ<br>  åˆ©ç”¨<code>document.createDocumentFragment()</code>æ–¹æ³•åˆ›å»ºæ–‡æ¡£ç¢ç‰‡èŠ‚ç‚¹ï¼Œåˆ›å»ºçš„æ˜¯ä¸€ä¸ªè™šæ‹ŸDomå¯¹è±¡ã€‚å‘è¿™ä¸ªèŠ‚ç‚¹æ·»åŠ DomèŠ‚ç‚¹ï¼Œä¿®æ”¹DomèŠ‚ç‚¹å¹¶ä¸ä¼šå½±å“åˆ°çœŸæ˜¯çš„Domç»“æ„ã€‚<br>  æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹å…ˆå°†éœ€è¦ä¿®æ”¹çš„Domä¸€å¹¶ä¿®æ”¹å®Œï¼Œä¿å­˜è‡³æ–‡æ¡£ç¢ç‰‡ä¸­ï¼Œç„¶åç”¨æ–‡æ¡£ç¢ç‰‡ä¸€æ¬¡æ€§çš„æ›¿æ¢çœŸå®çš„DomèŠ‚ç‚¹ã€‚ä¸è™šæ‹ŸDomç±»ä¼¼ï¼Œä¹Ÿè¾¾åˆ°äº†ä¸é¢‘ç¹ä¿®æ”¹Domè€Œå¯¼è‡´çš„é‡æ’å’Œé‡ç»˜çš„è¿‡ç¨‹  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fragment = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line"><span class="keyword">const</span> operationDomHandler = <span class="function">(<span class="params">fragment</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line">operationDomHandler(fragment);</span><br><span class="line">rootElem.replaceChild(fragment, oldDom)</span><br></pre></td></tr></table></figure>
  è¿™æ ·åªè§¦å‘ä¸€æ¬¡å›æµï¼ˆé‡æ’ï¼‰ï¼Œæ•ˆç‡ä¼šæ‰“æ‰“æå‡ã€‚å¦‚æœéœ€è¦å¯¹å…ƒç´ è¿›è¡Œå¤æ‚çš„æ“ä½œï¼ˆåˆ å‡ï¼Œæ·»åŠ åŠ ç‚¹ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”å½“å…ˆå°†å…ƒç´ ä»é¡µé¢ä¸­ç§»é™¤ï¼Œç„¶åå†å¯¹å…¶è¿›è¡Œæ“ä½œã€‚æˆ–è€…å°†å…¶å¤åˆ¶ä¸€ä¸ªï¼ˆcloneNode()ï¼‰,åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œåå†æ›¿æ¢åŸæ¥çš„èŠ‚ç‚¹  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> cloneNode = old.cloneNode(<span class="literal">true</span>);</span><br><span class="line">operationDomHandler(cloneNode);</span><br><span class="line"> rootElem.replaceChild(cloneNode, oldDom);</span><br></pre></td></tr></table></figure></li>
<li>ç”¨<code>innerHtml</code>ä»£æ›¿é«˜é¢‘çš„<code>appendChild</code></li>
<li>æœ€ä¼˜çš„layoutæ–¹æ¡ˆ<br>  æ‰¹é‡è¯»ï¼Œä¸€æ¬¡æ€§å†™ã€‚<br>  å…ˆå¯¹ä¸€ä¸ªä¸åœ¨render treeä¸Šçš„èŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼Œåœ¨æŠŠè¿™ä¸ªèŠ‚ç‚¹æ·»åŠ å›render treeã€‚è¿™æ ·åªå¤„ç½šä¸€æ¬¡Domæ“ä½œã€‚ä½¿ç”¨<code>requestAnimationFrame()</code>ï¼ŒæŠŠä»»ä½•å¯¼è‡´é‡ç»˜çš„æ“ä½œæ”¾å…¥<code>requestAnimationFrame</code>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> width = <span class="built_in">document</span>.getElementById(<span class="string">"xx"</span>).width;</span><br><span class="line">requestAnimationFrame(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// å†™é€»è¾‘</span></span><br><span class="line">    <span class="comment">// React Fiberï¼Ÿ</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>è™šæ‹ŸDom<br>  jsæ¨¡æ‹ŸDomæ ‘å¹¶å¯¹Domæ ‘æ“ä½œçš„ä¸€ç§æŠ€æœ¯ã€‚Virtual Domæ˜¯ä¸€ä¸ªçº¯jså¯¹è±¡ï¼ˆå­—ç¬¦ä¸²å¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥å¯¹å®ƒæ“ä½œæ˜¯é«˜æ•ˆçš„ã€‚<br>  åˆ©ç”¨Virtual Domï¼Œå°†domæŠ½è±¡ä¸ºè™šæ‹ŸDomï¼Œåœ¨Domå‘ç”Ÿæ”¹å˜çš„æ—¶å€™å…ˆå°†è™šæ‹ŸDomè¿›è¡Œæ“ä½œï¼Œé€šè¿‡Dom diffç®—æ³•å°†è™šæ‹ŸDomå’ŒåŸè™šæ‹ŸDomçš„ç»“æ„å¯¹æ¯”ï¼Œæœ€ç»ˆæ‰¹é‡çš„å»ä¿®æ”¹çœŸæ˜¯çš„Domç»“æ„ï¼Œå°½å¯èƒ½çš„é¿å…äº†é¢‘ç¹ä¿®æ”¹Domè€Œå¯¼è‡´çš„é¢‘ç¹çš„é‡æ’å’Œé‡ç»˜ã€‚</li>
</ul>
<blockquote>
<p><a class="link"   href="https://www.npmjs.com/package/fastdom"  target="_blank" rel="noopener">fastdom<i class="fas fa-external-link-alt"></i></a>ï¼Œå¤„ç†domçš„æ’ä»¶</p>
</blockquote>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</title>
    <url>/2020/07/21/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h1 id="Httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„"><a href="#Httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„" class="headerlink" title="Httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„"></a>Httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„</h1><p><a href="/2020/07/24/navigationTiming/">Navigation Timing</a>ä»è¾“å…¥ç½‘å€æ•²å‡»å›è½¦å¼€å§‹åˆ°é¡µé¢å®Œå…¨åŠ è½½å®Œæˆå±•ç¤ºã€‚å…¶ä¸­çš„è¿‡ç¨‹æ˜¯ä¼˜åŒ–çš„è¦ç‚¹ã€‚</p>
<h3 id="æ€§èƒ½ä¼˜åŒ–æ–¹å‘"><a href="#æ€§èƒ½ä¼˜åŒ–æ–¹å‘" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–æ–¹å‘"></a>æ€§èƒ½ä¼˜åŒ–æ–¹å‘</h3><p><a href="/2020/07/21/å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸€ï¼‰é›…è™å†›è§„/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸€ï¼‰é›…è™å†›è§„</a><br><a href="/2020/07/21/å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆäºŒï¼‰ç¼“å­˜ä¸ºç‹/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆäºŒï¼‰ç¼“å­˜ä¸ºç‹</a><br><a href="/2020/07/21/å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸‰ï¼‰åè®®å¤„ç†/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸‰ï¼‰åè®®å¤„ç†</a><br><a href="/2020/07/22/æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆå››ï¼‰æ¸²æŸ“ä¼˜åŒ–</a><br><a href="/2020/07/23/HTMLCSSJSæ¸²æŸ“æ‰§è¡Œ/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆäº”ï¼‰HTMLä¸­css,jsæ ‡ç­¾ä½ç½®çš„å½±å“</a></p>
<p><a class="link"   href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps"  target="_blank" rel="noopener">æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="ç«™ç‚¹æµ‹é€Ÿ"><a href="#ç«™ç‚¹æµ‹é€Ÿ" class="headerlink" title="ç«™ç‚¹æµ‹é€Ÿ"></a>ç«™ç‚¹æµ‹é€Ÿ</h3><p>æ ¹æ®ç”¨æˆ·çš„ç½‘é€Ÿè¿›è¡Œé€‚é…çš„èµ„æºåŠ è½½</p>
<ul>
<li><strong>navigator.connection</strong><br>  Navigator.connection æ˜¯åªè¯»çš„ï¼Œæä¾›ä¸€ä¸ªNetworkInformation å¯¹è±¡æ¥è·å–è®¾å¤‡çš„ç½‘ç»œè¿æ¥ä¿¡æ¯ã€‚ä¾‹å¦‚ç”¨æˆ·è®¾å¤‡çš„å½“å‰å¸¦å®½æˆ–è¿æ¥æ˜¯å¦è¢«è®¡é‡ï¼Œ è¿™å¯ä»¥ç”¨äºåŸºäºç”¨æˆ·çš„è¿æ¥æ¥é€‰æ‹©é«˜æ¸…æ™°åº¦å†…å®¹æˆ–ä½æ¸…æ™°åº¦å†…å®¹ã€‚(ä¸å¤ªå‡†ç¡®)<br>  <code>connectionInfo = navigator.connection</code></li>
<li>çº¯å›¾ç‰‡è¯·æ±‚ï¼Œé€Ÿåº¦ = æ–‡ä»¶å¤§å° / æ—¶é—´<br>  ç®—å‡ºçš„é€Ÿåº¦åŒ…å«dnsè§£æç­‰æ—¶é—´ï¼Œä¸çº¯ç²¹ä¸å‡†<br>  <code>speed = size/time</code></li>
<li>å¤šæ™®å‹’æµ‹é€Ÿ<br>  <img src="http://i.feidom.com/%E5%A4%9A%E6%99%AE%E5%8B%92%E6%B5%8B%E9%80%9F.jpg" alt="å¤šæ™®å‹’æµ‹é€Ÿ"><br>  <code>speed = (40k-10k)/(t5-t4)</code></li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸‰ï¼‰åè®®å¤„ç†</title>
    <url>/2020/07/21/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%88%E4%B8%89%EF%BC%89%E5%8D%8F%E8%AE%AE%E5%A4%84%E7%90%86/</url>
    <content><![CDATA[<h3 id="httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„"><a href="#httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„" class="headerlink" title="httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„"></a>httpè¯·æ±‚çš„ä»£ä»·æ˜¯æ˜‚è´µçš„</h3><p>HTTP ç¼“å­˜ï¼Œå¯¹äºå‰ç«¯çš„æ€§èƒ½ä¼˜åŒ–æ–¹é¢æ¥è®²ï¼Œæ˜¯éå¸¸å…³é”®çš„ï¼Œä»ç¼“å­˜ä¸­è¯»å–æ•°æ®å’Œç›´æ¥å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚</p>
<h3 id="åè®®ç¼“å­˜è§„åˆ™"><a href="#åè®®ç¼“å­˜è§„åˆ™" class="headerlink" title="åè®®ç¼“å­˜è§„åˆ™"></a>åè®®ç¼“å­˜è§„åˆ™</h3><p>æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”è¯·æ±‚ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŒæ–¹åå•†äº†ä¸¤ç§æ–¹å¼æ¥è§„å®šç¼“å­˜è§„åˆ™ã€‚</p>
<ul>
<li>å¼ºç¼“å­˜ï¼š<br>  æµè§ˆå™¨åœ¨åŠ è½½èµ„æºæ—¶ï¼Œæ ¹æ®è¯·æ±‚å¤´çš„ <code>Expires</code> å’Œ <code>Cache-control</code> åˆ¤æ–­ï¼Œæ˜¯åˆ™ç›´æ¥ä»ç¼“å­˜è¯»å–èµ„æºï¼Œä¸ä¼šå‘è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚<br>  ä¼˜å…ˆçº§é«˜äº<strong>åå•†ç¼“å­˜</strong><br>  <img src="http://i.feidom.com/%E5%BC%BA%E7%BC%93%E5%AD%98%E5%91%BD%E4%B8%AD.gif" alt="å¼ºç¼“å­˜å‘½ä¸­"><br>  <img src="http://i.feidom.com/%E5%BC%BA%E7%BC%93%E5%AD%98%E5%A4%B1%E6%95%88.gif" alt="å¼ºç¼“å­˜æœªå‘½ä¸­"></li>
<li>åå•†ç¼“å­˜<br>  å¦‚æœæ²¡æœ‰å‘½ä¸­<strong>å¼ºç¼“å­˜</strong>ï¼ŒåŠ è½½èµ„æºçš„è¯·æ±‚ä¼šå‘é€åˆ°æœåŠ¡å™¨ï¼Œé€šè¿‡ <code>Last-Modified</code> å’Œ <code>Etag</code> éªŒè¯èµ„æºæ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™ä¸ªè¯·æ±‚è¿”å›<strong>304</strong>ï¼ˆNot Modifiedï¼‰ï¼Œä½†æ˜¯ä¸ä¼šè¿”å›è¿™ä¸ªèµ„æºçš„æ•°æ®ï¼Œä¾ç„¶æ˜¯ä»ç¼“å­˜ä¸­è¯»å–èµ„æºã€‚<br>  <img src="http://i.feidom.com/%E5%8D%8F%E5%95%86%E7%BC%93%E5%AD%98%E5%91%BD%E4%B8%AD.gif" alt="åå•†ç¼“å­˜å‘½ä¸­"><br>  <img src="http://i.feidom.com/%E5%8D%8F%E5%95%86%E7%BC%93%E5%AD%98%E6%9C%AA%E5%91%BD%E4%B8%AD.gif" alt="åå•†ç¼“å­˜æœªå‘½ä¸­"><br>å¦‚æœå‰é¢ä¸¤è€…éƒ½æ²¡æœ‰å‘½ä¸­ï¼Œç›´æ¥ä»æœåŠ¡å™¨åŠ è½½èµ„æºã€‚</li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆäºŒï¼‰ç¼“å­˜ä¸ºç‹</title>
    <url>/2020/07/21/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89%E7%BC%93%E5%AD%98%E4%B8%BA%E7%8E%8B/</url>
    <content><![CDATA[<h3 id="HTTPç¼“å­˜"><a href="#HTTPç¼“å­˜" class="headerlink" title="HTTPç¼“å­˜"></a>HTTPç¼“å­˜</h3><p>å¸¸ç”¨çš„åº“(jqueryç­‰)ï¼Œä¸ç»å¸¸å˜å¾—è¿™äº›åº“ï¼Œç‰ˆæœ¬è¦æ±‚ä¸æ˜¯å¾ˆä¸¥æ ¼ï¼Œç”¨HTTPå¼ºç¼“å­˜ã€‚<br><a href="/2020/07/21/å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸‰ï¼‰åè®®å¤„ç†/">å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸‰ï¼‰åè®®å¤„ç†</a></p>
<h3 id="å‰ç«¯ç¦»çº¿ç¼“å­˜"><a href="#å‰ç«¯ç¦»çº¿ç¼“å­˜" class="headerlink" title="å‰ç«¯ç¦»çº¿ç¼“å­˜"></a>å‰ç«¯ç¦»çº¿ç¼“å­˜</h3><p>ä¸šåŠ¡ä»£ç ï¼Œmd5å˜åŒ–é¢‘ç¹ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚</p>
<ul>
<li><p>cookie</p>
<ul>
<li>å­˜å‚¨æœ€å¤§æ•°æ®é‡ä¸º4K</li>
<li>åŒä¸€ä¸ªåŸŸåä¸‹å­˜æ”¾ Cookie çš„ä¸ªæ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸åŒæµè§ˆå™¨çš„ä¸ªæ•°ä¸ä¸€æ ·ï¼Œä¸€èˆ¬ä¸º 20 ä¸ªï¼›</li>
<li>Cookie æ”¯æŒè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå½“è¿‡æœŸæ—¶è‡ªåŠ¨é”€æ¯ï¼›</li>
<li>æ¯æ¬¡å‘èµ·åŒåŸŸä¸‹çš„è¯·æ±‚éƒ½ä¼šå‘é€å›æœåŠ¡å™¨</li>
</ul>
</li>
<li><p>Local Storage</p>
<ul>
<li>ç”¨äºé•¿ä¹…ä¿å­˜æ•´ä¸ªç½‘ç«™çš„æ•°æ®ï¼Œä¿å­˜çš„æ•°æ®æ²¡æœ‰è¿‡æœŸæ—¶é—´ï¼Œç›´åˆ°æ‰‹åŠ¨å»åˆ é™¤ã€‚ï¼ˆå’ŒSession Storageçš„åŒºåˆ«ï¼‰</li>
<li>ç›¸å½“äºä¸€ä¸ª 5Må·¦å³çš„é’ˆå¯¹äºå‰ç«¯é¡µé¢çš„æ•°æ®åº“</li>
<li>é”®å€¼å¯¹å­˜å‚¨ï¼Œå­˜å‚¨çš„Valueé™å®šä¸ºstringç±»å‹</li>
<li>åœ¨æµè§ˆå™¨çš„éšç§æ¨¡å¼ä¸‹ä¸å¯è¯»å–</li>
<li>æœ¬è´¨ä¸Šæ˜¯å¯¹å­—ç¬¦ä¸²çš„è¯»å–,ä¸”<strong>æ“ä½œæ˜¯åŒæ­¥çš„</strong>ï¼Œå»ºè®®å­˜å‚¨é‡åœ¨2.5Mä»¥ä¸‹ï¼Œå¦åˆ™ä¼šå˜å¡</li>
<li>ä¸èƒ½è¢«çˆ¬è™«æŠ“å–åˆ°</li>
<li>å—åˆ°åŒæºé™åˆ¶ï¼Œä¸èƒ½è·¨åŸŸã€‚ä½†æ˜¯,å¯ä»¥å€ŸåŠ©postMessageå’Œiframeæ¥å®ç°è·¨åŸŸçš„æ•°æ®è¯»å–</li>
<li>åœ¨åŒæºçš„æ‰€æœ‰æ ‡ç­¾é¡µå’Œçª—å£ä¹‹é—´å…±äº«æ•°æ®</li>
</ul>
</li>
<li><p>Session Storage</p>
<ul>
<li>ä¸ localStorage æ‹¥æœ‰ç»Ÿä¸€çš„ API æ¥å£ï¼›</li>
<li>ç”¨äºä¸´æ—¶ä¿å­˜åŒä¸€çª—å£(æˆ–æ ‡ç­¾é¡µ)çš„æ•°æ®ï¼Œåœ¨å…³é—­çª—å£æˆ–æ ‡ç­¾é¡µä¹‹åå°†ä¼šåˆ é™¤è¿™äº›æ•°æ®ã€‚ï¼ˆå’ŒLocal Storageçš„åŒºåˆ«ï¼‰</li>
<li>æ•°æ®åœ¨é¡µé¢åˆ·æ–°åä¾ç„¶å­˜åœ¨ï¼Œä½†åœ¨å…³é—­æµè§ˆå™¨æ ‡ç­¾é¡µä¹‹åæ•°æ®å°±ä¼šè¢«æ¸…é™¤ï¼›</li>
</ul>
</li>
<li><p>IndexedDBï¼ˆNoSQL æ•°æ®åº“ï¼‰</p>
<ul>
<li>å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼ˆä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250Mï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ï¼‰ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚</li>
<li>é”®å€¼å¯¹å‚¨å­˜ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚åŒæ—¶æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚</li>
<li><strong>æ“ä½œæ˜¯å¼‚æ­¥çš„</strong></li>
<li>æ”¯æŒäº‹åŠ¡ã€‚</li>
<li>å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚è®¿é—®ä¸èƒ½è·¨åŸŸã€‚<blockquote>
<p>æ¥è‡ª <a class="link"   href="http://www.ruanyifeng.com/blog/2018/07/indexeddb.html"  target="_blank" rel="noopener">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
</li>
</ul>
</li>
<li><p>Web SQl</p>
<ul>
<li>Web SQL èƒ½æ–¹ä¾¿è¿›è¡Œå¯¹è±¡å­˜å‚¨</li>
<li>Web SQL æ”¯æŒäº‹åŠ¡ï¼Œèƒ½æ–¹ä¾¿åœ°è¿›è¡Œæ•°æ®æŸ¥è¯¢å’Œæ•°æ®å¤„ç†æ“ä½œ</li>
<li><strong>HTML5æ”¾å¼ƒäº†Web SQL Database</strong><br>æ”¾å¼ƒçš„åŸå› æ˜¯ï¼š<br>This document was on the W3C Recommendation track but specification work has stopped. The specification reached an impasse: all interested implementors have used the same SQL backend (Sqlite), but we need multiple independent implementations to proceed along a standardisation path.<br>å¤§æ¦‚æ„æ€æ˜¯ï¼šè¿™ä¸ªæ–‡æ¡£æ˜¯W3Cæ¨èçš„ï¼Œä½†æ˜¯è§„èŒƒå·¥ä½œå·²ç»åœæ­¢äº†ã€‚è§„èŒƒé™·å…¥äº†åƒµå±€:æ‰€æœ‰æ„Ÿå…´è¶£çš„å®ç°è€…éƒ½ä½¿ç”¨ç›¸åŒçš„SQLåç«¯(Sqlite)ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å¤šä¸ªç‹¬ç«‹çš„å®ç°æ¥æ²¿ç€æ ‡å‡†åŒ–çš„é“è·¯å‰è¿›ã€‚</li>
</ul>
</li>
</ul>
<h3 id="æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ"><a href="#æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ" class="headerlink" title="æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ"></a>æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ</h3><ul>
<li>ä¸»æµçš„æ•°æ® å¼€æºåº“<ul>
<li>localForage<br>localForage æ˜¯ä¸€ä¸ªå¿«é€Ÿç®€å•çš„ JavaScript å­˜å‚¨åº“ã€‚å®ƒé€šè¿‡ä½¿ç”¨ç±»ä¼¼äº localStorage çš„ç®€å• API æ¥ä½¿ç”¨å¼‚æ­¥å­˜å‚¨ï¼ˆIndexedDB æˆ– WebSQL)ï¼‰ï¼Œè¿›è€Œæ”¹å–„ä½ çš„ Web åº”ç”¨ç¨‹åºçš„ç¦»çº¿ä½“éªŒã€‚</li>
<li>Dexie.js<br>Dexie.js æ˜¯ IndexedDB çš„åŒ…è£…åº“ï¼Œå®ƒæä¾›äº†ä¸€å¥—ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„ APIï¼Œå¼ºå¤§çš„é”™è¯¯å¤„ç†ï¼Œè¾ƒå¼ºçš„å¯æ‰©å±•æ€§ï¼Œæ­¤å¤–å®ƒèƒ½å¤Ÿè·Ÿè¸ªæ•°æ®å˜åŒ–ï¼Œæ”¯æŒ KeyRange (æœç´¢ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯è®¾ç½®åŒ¹æ–¹å¼å’Œ OR æ“ä½œ)ã€‚<br>Dexie.js ä¸»è¦ä¸ºäº†è§£å†³åŸç”Ÿ IndexedDB API ä¸­å­˜åœ¨çš„ä¸‰ä¸ªä¸»è¦é—®é¢˜ï¼šå¼‚å¸¸é”™è¯¯å¤„ç†ã€‚è¾ƒå¼±çš„æŸ¥è¯¢åŠŸèƒ½ã€‚ä»£ç å¤æ‚æ€§ã€‚</li>
</ul>
</li>
<li>local Storageç¼“å­˜jsæ–¹æ¡ˆç®¡ç†ç‰ˆæœ¬</li>
</ul>
<ol>
<li>å­˜å‚¨æ–‡ä»¶çš„jså®Œæ•´è·¯å¾„åŠåç§°ï¼Œåç§°ä¸­åŒ…å«æ–‡ä»¶ç‰ˆæœ¬ä¿¡æ¯ï¼ˆmd5ç­‰ï¼‰ã€‚<br><code>localStorage.setItem(&quot;common:widget/a.js&quot;, &quot;/static/common/widget/a_[md5æ—§].js&quot;)</code></li>
<li>æ ¹æ®jså®Œæ•´è·¯å¾„åŠåç§°ï¼Œå­˜å‚¨jsä»£ç <br><code>localStorage.setItem(&quot;/static/common/widget/a_[md5æ—§].js&quot;, &quot;ä»£ç code...&quot;)</code></li>
<li>initæ—¶ï¼Œå¯åŠ¨çš„jsè„šæœ¬åŠ è½½manifestè¿™ç§æ¸…å•<figure class="highlight"><table><tr><td class="code"><pre><span class="line">const manifest = &#123;</span><br><span class="line">    "common:widget/a.js":"/static/common/widget/a_[md5æ–°].js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>é€»è¾‘åˆ¤æ–­ï¼ŒåŠ è½½js<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> aJs = localStorage.getItem(<span class="string">"common:widget/a.js"</span>) <span class="comment">// "/static/common/widget/a_[md5æ—§].js"</span></span><br><span class="line"><span class="keyword">const</span> md5 = <span class="string">"md5æ–°"</span> <span class="comment">// æ–‡ä»¶ç‰ˆæœ¬</span></span><br><span class="line">&lt;!-- ç„¶ååˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ --&gt;</span><br><span class="line"><span class="keyword">if</span>(aJs)&#123;</span><br><span class="line">    <span class="comment">// å­˜åœ¨ï¼Œæœ‰ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">if</span>(md5 === <span class="string">"md5æ—§"</span>)&#123;</span><br><span class="line">        <span class="comment">// ç¼“å­˜æ²¡è¿‡æœŸï¼Œç›´æ¥å»ç¼“å­˜é‡Œçš„</span></span><br><span class="line">        <span class="keyword">const</span> aJsCode =  localStorage.getItem(aJs)</span><br><span class="line">        <span class="comment">// æ‰§è¡Œç¼“å­˜çš„jsä»£ç ,evelåªæ˜¯ä¾‹å­ï¼Œä¸å»ºè®®ä½¿ç”¨.å¯ä»¥addScript</span></span><br><span class="line">        evel(aJsCode)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// ç¼“å­˜è¿‡æœŸ</span></span><br><span class="line">        localStorage.removeItem(aJs)</span><br><span class="line">        <span class="comment">// æ‹‰å–æ–°çš„</span></span><br><span class="line">        <span class="keyword">const</span> aJsCodeNew = fetch(<span class="string">"/static/common/widget/a_[md5æ–°].js"</span>)</span><br><span class="line">        <span class="comment">// å­˜ç¼“å­˜</span></span><br><span class="line">        localStorage.setItem(<span class="string">"common:widget/a.js"</span>, <span class="string">"/static/common/widget/a_[md5æ–°].js"</span>)</span><br><span class="line">        localStorage.setItem( <span class="string">"/static/common/widget/a_[md5æ–°].js"</span>, aJsNew)</span><br><span class="line">        <span class="comment">// æ‰§è¡Œæ–°çš„jsä»£ç </span></span><br><span class="line">        evel(aJsCodeNew)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// ä¸å­˜åœ¨ï¼Œæ²¡æœ‰ç¼“å­˜ã€‚æ‹‰å–æ–°çš„æ–‡ä»¶ï¼Œæ‰§è¡Œ</span></span><br><span class="line">    fetch(<span class="string">"/static/common/widget/a_[md5æ–°].js"</span>)</span><br><span class="line">    <span class="comment">// åšç¼“å­˜</span></span><br><span class="line">    localStorage.setItem(<span class="string">"common:widget/a.js"</span>, <span class="string">"/static/common/widget/a_[md5æ–°].js"</span>)</span><br><span class="line">    localStorage.setItem(<span class="string">"/static/common/widget/a_[md5æ–°].js"</span>, <span class="string">"ä»£ç code..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸€ï¼‰é›…è™å†›è§„</title>
    <url>/2020/07/21/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%88%E4%B8%80%EF%BC%89%E9%9B%85%E8%99%8E%E5%86%9B%E8%A7%84/</url>
    <content><![CDATA[<h3 id="é›…è™å†›è§„"><a href="#é›…è™å†›è§„" class="headerlink" title="é›…è™å†›è§„"></a>é›…è™å†›è§„</h3><ul>
<li>å†…å®¹ä¸»ä½“ï¼š</li>
</ul>
<ol>
<li>å°½é‡å‡å°‘HTTPè¯·æ±‚æ•°</li>
<li>å‡å°‘DNSæŸ¥æ‰¾</li>
<li>é¿å…é‡å®šå‘</li>
<li>è®©Ajaxå¯ç¼“å­˜</li>
<li>å»¶è¿ŸåŠ è½½ç»„ä»¶</li>
<li>é¢„åŠ è½½ç»„ä»¶</li>
<li>å‡å°‘DOMå…ƒç´ çš„æ•°é‡<br> å–„ç”¨cssä¼ªç±»<br> æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“<br> ç»“æ„åˆç†ï¼Œè¯­ä¹‰åŒ–æ ‡ç­¾</li>
<li>è·¨åŸŸåˆ†ç¦»ç»„ä»¶<br> åˆ†ç¦»ç»„ä»¶å¯ä»¥æœ€å¤§åŒ–å¹¶è¡Œä¸‹è½½ï¼Œä½†è¦ç¡®ä¿åªç”¨ä¸è¶…è¿‡2-4ä¸ªåŸŸï¼Œå› ä¸ºå­˜åœ¨DNSæŸ¥æ‰¾çš„ä»£ä»·ã€‚</li>
<li>å°½é‡å°‘ç”¨iframe</li>
<li>æœç»404</li>
</ol>
<ul>
<li>csséƒ¨åˆ†ï¼š</li>
</ul>
<ol>
<li>æŠŠæ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨</li>
<li>é¿å…ä½¿ç”¨CSSè¡¨è¾¾å¼</li>
<li>é€‰æ‹©<code>&lt;link&gt;</code>èˆå¼ƒ<code>@import</code></li>
<li>é¿å…ä½¿ç”¨æ»¤é•œ</li>
</ol>
<ul>
<li>jséƒ¨åˆ†ï¼š</li>
</ul>
<ol>
<li>å»é™¤é‡å¤è„šæœ¬</li>
<li>å°½é‡å‡å°‘DOMè®¿é—®</li>
<li>ç”¨æ™ºèƒ½çš„äº‹ä»¶å¤„ç†å™¨<br> äº‹ä»¶å§”æ‰˜</li>
<li>æŠŠè„šæœ¬æ”¾åœ¨åº•éƒ¨<blockquote>
<p>5-6ä¸ªscriptè¯·æ±‚ï¼Œæ¯ä¸ªæ–‡ä»¶å¤§å°gzipå30kbå·¦å³</p>
</blockquote>
</li>
</ol>
<ul>
<li>javascript, csséƒ¨åˆ†:</li>
</ul>
<ol>
<li>æŠŠJavaScriptå’ŒCSSæ”¾åˆ°å¤–é¢</li>
<li>å‹ç¼©JavaScriptå’ŒCSS</li>
</ol>
<ul>
<li>å›¾ç‰‡</li>
</ul>
<ol>
<li>ä¼˜åŒ–å›¾ç‰‡</li>
<li>ä¼˜åŒ–CSS Sprite</li>
<li>ä¸è¦ç”¨HTMLç¼©æ”¾å›¾ç‰‡</li>
<li>ç”¨å°çš„å¯ç¼“å­˜çš„favicon.icoï¼ˆP.S. æ”¶è—å¤¹å›¾æ ‡ï¼‰<blockquote>
<p>svgå›¾ç‰‡çš„ä½¿ç”¨ï¼›CSS Spritesï¼ˆé›ªç¢§å›¾/ç²¾çµå›¾ï¼‰ï¼›tinypngjsï¼ˆå›¾ç‰‡å‹ç¼©å·¥å…·ï¼‰</p>
</blockquote>
</li>
</ol>
<ul>
<li>cookie</li>
</ul>
<ol>
<li>ç»™cookieå‡è‚¥</li>
<li>æŠŠç»„ä»¶æ”¾åœ¨ä¸å«cookieçš„åŸŸä¸‹</li>
</ol>
<ul>
<li>ç§»åŠ¨ç«¯ </li>
</ul>
<ol>
<li>ä¿è¯æ‰€æœ‰ç»„ä»¶éƒ½å°äº25K<br> è¿™ä¸ªé™åˆ¶æ˜¯å› ä¸ºiPhoneä¸èƒ½ç¼“å­˜å¤§äº25Kçš„ç»„ä»¶</li>
<li>æŠŠç»„ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ªå¤åˆæ–‡æ¡£é‡Œ</li>
</ol>
<ul>
<li>æœåŠ¡å™¨</li>
</ul>
<ol>
<li>Gzipç»„ä»¶</li>
<li>é¿å…å›¾ç‰‡srcå±æ€§ä¸ºç©º</li>
<li>é…ç½®ETags</li>
<li>å¯¹Ajaxç”¨GETè¯·æ±‚</li>
<li>å°½æ—©æ¸…ç©ºç¼“å†²åŒº</li>
<li>ä½¿ç”¨CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰</li>
<li>æ·»ä¸ŠExpiresæˆ–è€…Cache-Control HTTPå¤´</li>
</ol>
]]></content>
      <categories>
        <category>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>nodeçš„websocketsç›‘å¬unix_domain_socket</title>
    <url>/2020/07/20/node%E7%9A%84websockets%E7%9B%91%E5%90%ACunix-domain-socket/</url>
    <content><![CDATA[<h3 id="WebSockets-listening-on-UNIX-domain-socket"><a href="#WebSockets-listening-on-UNIX-domain-socket" class="headerlink" title="WebSockets listening on UNIX domain socket?"></a>WebSockets listening on UNIX domain socket?</h3><ul>
<li><p>Server side:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> WebSocketServer = <span class="built_in">require</span>(<span class="string">'ws'</span>).Server;</span><br><span class="line"><span class="keyword">var</span> server = http.createServer()</span><br><span class="line"><span class="keyword">var</span> wss = <span class="keyword">new</span> WebSocketServer(&#123; <span class="attr">server</span> : server&#125;);</span><br><span class="line">server.listen(<span class="string">'/tmp/server.sock'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Client side:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="built_in">require</span>(<span class="string">'ws'</span>);</span><br><span class="line"><span class="keyword">var</span> client = <span class="keyword">new</span> ws(<span class="string">"ws+unix:///tmp/server.sock"</span>)</span><br><span class="line">client.send(<span class="string">'hello'</span>)</span><br></pre></td></tr></table></figure>


</li>
</ul>
<p><a class="link"   href="https://stackoverflow.com/questions/23930293/websockets-listening-on-unix-domain-socket?answertab=active#tab-top"  target="_blank" rel="noopener">åŸæ–‡åœ°å€<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <categories>
        <category>nodejs</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxä¸‹å¸¸ç”¨å‘½ä»¤æŸ¥çœ‹ç«¯å£å ç”¨</title>
    <url>/2020/07/11/linux%E4%B8%8B%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8/</url>
    <content><![CDATA[<ul>
<li>æŸ¥çœ‹å½“å‰æ‰€æœ‰tcpç«¯å£<br><code>$ netstat -ntlp</code></li>
<li>æŸ¥çœ‹æ‰€æœ‰9000ç«¯å£ä½¿ç”¨æƒ…å†µ<br><code>netstat -ntulp | grep 3306</code></li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>sonarqubeé…ç½®åŠä½¿ç”¨</title>
    <url>/2020/07/11/sonarqube%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<p><a class="link"   href="https://docs.sonarqube.org/latest/"  target="_blank" rel="noopener">sonarqubeå®˜ç½‘æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a>ï¼šä»£ç è´¨é‡çš„æ£€æµ‹åŠç®¡ç†</p>
<h3 id="å®‰è£…javaç¯å¢ƒ"><a href="#å®‰è£…javaç¯å¢ƒ" class="headerlink" title="å®‰è£…javaç¯å¢ƒ"></a>å®‰è£…javaç¯å¢ƒ</h3><ul>
<li>å®‰è£…javaç¯å¢ƒï¼ˆæœ¬åœ°å’ŒæœåŠ¡å™¨éƒ½éœ€è¦ï¼‰<br>sonarqubeä¾èµ–é«˜ç‰ˆæœ¬çš„javaç¯å¢ƒï¼Œä»¥ä¸‹å†…å®¹ä½¿ç”¨jdk14<br>åœ¨<a class="link"   href="https://www.oracle.com/"  target="_blank" rel="noopener">oracleå®˜ç½‘<i class="fas fa-external-link-alt"></i></a>ä¸‹è½½<a class="link"   href="https://www.oracle.com/java/technologies/javase-jdk14-downloads.html"  target="_blank" rel="noopener">java<i class="fas fa-external-link-alt"></i></a>macç‰ˆï¼ˆmacOS Installerï¼‰å’ŒæœåŠ¡å™¨Linuxç‰ˆï¼ˆLinux RPM Packageï¼‰ã€‚è¿™ç§çš„ä¸éœ€è¦é…ç¯å¢ƒå˜é‡ï¼Œè‡ªåŠ¨é…å¥½ã€‚<blockquote>
<p>æ³¨æ„ï¼šä¸è¦è£…openjdk</p>
</blockquote>
</li>
<li>å°†æœåŠ¡å™¨Linuxç‰ˆçš„jdkä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶å®‰è£…(pwdå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç»å¯¹è·¯å¾„)<br><code>$ scp /Users/yingying/Downloads/jdk-14.0.1_linux-x64_bin.rpm root@8.129.182.113:/opt/</code><br>rpmå®‰è£…jdk<br><code>$ rpm -i jdk-14.0.1_linux-x64_bin.rpm</code><br>rpmæŸ¥è¯¢åŒ…ä¿¡æ¯<br><code>$ rpm -qa</code>  æ‰¾åˆ°=&gt; <code>jdk-14.0.1-14.0.1-ga.x86_64</code><br>rpmå¸è½½jsk<br><code>$ rpm -e jdk-14.0.1-14.0.1-ga.x86_64</code></li>
</ul>
<h3 id="å®‰è£…sonarqube"><a href="#å®‰è£…sonarqube" class="headerlink" title="å®‰è£…sonarqube"></a>å®‰è£…sonarqube</h3><ul>
<li>åœ¨æœåŠ¡å™¨ç«¯å®‰è£…Communityç‰ˆæœ¬<br><code>wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-8.4.0.35506.zip</code></li>
<li>sonarqubeä¸èƒ½ä½¿ç”¨rootèº«ä»½å¯åŠ¨ï¼Œæ‰€ä»¥å»ºä¸€ä¸ªsonarç”¨æˆ·ï¼Œå°†sonarqube-developer-8.4.0.35506.zipæ–‡ä»¶ç»™åˆ°sonarç”¨æˆ·ã€‚<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root$ useradd sonar</span><br><span class="line">root$ passwd sonar</span><br><span class="line">root$ chown -R sonar sonarqube-developer-8.4.0.35506.zip</span><br></pre></td></tr></table></figure></li>
<li>åˆ‡æ¢ç”¨æˆ·èº«ä»½åˆ°sonarè¿›è¡Œæ¥ä¸‹æ¥çš„æ“ä½œ<code>su sonar</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sonar$ unzip sonarqube-developer-8.4.0.35506.zip</span><br></pre></td></tr></table></figure>
æç¤ºæ²¡æœ‰æƒé™ã€‚<blockquote>
<p>æ³¨æ„ï¼šåœ¨optæ–‡ä»¶å¤¹ä¸‹è§£å‹ æ–‡ä»¶.zipã€‚ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹å­˜æ”¾è§£å‹æ–‡ä»¶ã€‚æ­¤æ—¶sonarç”¨æˆ·æ²¡æœ‰optæ–‡ä»¶å¤¹çš„è¯»å†™æ‰§è¡Œæƒé™ã€‚æ‰€ä»¥æŠ¥é”™<code>Permission denied</code><br>è§£å†³ï¼šä½¿ç”¨rootèº«ä»½ä¿®æ”¹æ–‡ä»¶æƒé™ã€‚ç»™sonaræƒé™ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root$ chmod 754 opt</span><br><span class="line">root$ chmod 777 /opt/sonarqube-developer-8.4.0.35506.zip</span><br></pre></td></tr></table></figure>
ç„¶åæ‰§è¡Œunzipï¼Œè§£å‹æˆåŠŸã€‚ä¹‹åè¿›å…¥è§£å‹æ–‡ä»¶å¤¹ä¸‹çš„binç›®å½•çš„linux-x86-64ç›®å½•<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sonar$ <span class="built_in">cd</span> /opt/sonarqube-8.4.0.35506/bin/linux-x86-64/</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="è¿è¡Œsonarqube"><a href="#è¿è¡Œsonarqube" class="headerlink" title="è¿è¡Œsonarqube"></a>è¿è¡Œsonarqube</h3><p>åœ¨è¿™æœ‰sonar.shå¯åŠ¨è„šæœ¬ï¼Œå…ˆä¸ç€æ€¥./sonar.sh startã€‚å…ˆä½¿ç”¨consoleæŸ¥çœ‹å¯åŠ¨æ—¥å¿—,å†start</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sonar$ <span class="built_in">cd</span> /opt/sonarqube-8.4.0.35506/bin/linux-x86-64/</span><br><span class="line">sonar$ ./sonar.sh console</span><br><span class="line">sonar$ ./sonar.sh start</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ„å¤–ï¼šåœ¨å¯åŠ¨æˆåŠŸåï¼Œä½¿ç”¨å…¬ç½‘ip:ç«¯å£å· è®¿é—®å¤±è´¥ã€‚å‘ç°æ˜¯é˜¿é‡Œäº‘å®‰å…¨ç»„çš„é—®é¢˜ã€‚é…ç½®å¥½äº†ä»¥åè®¿é—®æˆåŠŸ<br>æ„å¤–ï¼šåœ¨è£…äº†æ±‰åŒ–åŒ…ä¹‹åï¼Œé‡å¯sonarqubeï¼Œå¯åŠ¨æˆåŠŸã€‚ä½†æ˜¯è®¿é—®ä¸€ç›´pendingã€‚è¿‡ä¸€ä¼šå°±å¥½äº†ã€‚åº”è¯¥æ˜¯æ±‰åŒ–åŒ…å¤ªå¤§ï¼Œåœ¨åŠ è½½çš„åŸå› </p>
</blockquote>
<h3 id="åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ˆtestï¼‰"><a href="#åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ˆtestï¼‰" class="headerlink" title="åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ˆtestï¼‰"></a>åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ˆtestï¼‰</h3><p>ä»¥ä¸‹æ“ä½œéƒ½å¯ä»¥åœ¨å…¬ç½‘ip:9000é¡¹ç›®ä¸­å¯è§†åŒ–æ“ä½œ</p>
<ol>
<li>ä½¿ç”¨å…¬ç½‘ip:9000è®¿é—®åˆ°sonarqube</li>
<li>ä½¿ç”¨é»˜è®¤è´¦å·/å¯†ç ï¼šadmin/adminç™»é™†</li>
<li>æ‰‹å·¥è®¾ç½®ä¸€ä¸ªé¡¹ç›®ï¼štest</li>
<li>è®¾ç½®ä¸€ä¸ªtokenï¼ˆå®¢æˆ·ç«¯ä¼šç”¨åˆ°çš„å£ä»¤ï¼‰</li>
<li>å¼€å§‹åˆ†æé¡¹ç›®</li>
<li>é€‰æ‹©é¡¹ç›®çš„ä¸»è¦è¯­è¨€ï¼šå…¶ä»–ï¼ˆjsï¼‰</li>
<li>é€‰æ‹©å®¢æˆ·ç«¯çš„æ“ä½œç³»ç»Ÿï¼ˆmacOSï¼‰</li>
<li><a class="link"   href="https://docs.sonarqube.org/latest/analysis/scan/sonarscanner/"  target="_blank" rel="noopener">ä¸‹è½½å¹¶è§£å‹macOSå¹³å°çš„è§£æå™¨SonarScanner<i class="fas fa-external-link-alt"></i></a>ï¼Œæ˜¯ä¸€ä¸ªzipæ–‡ä»¶</li>
<li>ä¸ºSonarScanneré…ç½®ç¯å¢ƒå˜é‡<br>é…ç½®ï½/.bash_profile<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sonar-scanner ç¯å¢ƒå˜é‡  pwdæ‰¾åˆ°sonar-scannerç›®å½•ä¸‹çš„binæ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line"><span class="built_in">export</span> SCANNER_HOME=<span class="string">"/Users/yingying/Documents/qwf/libs/sonar-scanner-4.4.0.2170-macosx"</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SCANNER_HOME</span>/bin</span><br></pre></td></tr></table></figure>
ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ<br><code>$ source .bash_profile</code><br>å¯ä»¥æ‰§è¡Œ<code>$ sonar-scanner -v</code>æ¥æŸ¥çœ‹æ˜¯å¦é…ç½®å®‰è£…æˆåŠŸ</li>
<li>åœ¨é¡¹ç›®ï¼ˆä¾‹ï¼šnodejs-demoï¼‰ä¸­é…ç½®SonarScanner<br>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º<code>sonar-project.properties</code>æ–‡ä»¶ã€‚<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sonar-scanner \</span><br><span class="line">  <span class="comment"># é¡¹ç›®å</span></span><br><span class="line">  -Dsonar.projectKey=<span class="built_in">test</span> \</span><br><span class="line">  <span class="comment"># è¦æ‰«æçš„ä»£ç ç›®å½•</span></span><br><span class="line">  -Dsonar.sources=. \</span><br><span class="line">  <span class="comment"># è¦ä¸ŠæŠ¥æŠ¥å‘Šçš„æœåŠ¡å™¨é“¾æ¥</span></span><br><span class="line">  -Dsonar.host.url=http://8.129.182.113:9000 \</span><br><span class="line">  <span class="comment"># token</span></span><br><span class="line">  -Dsonar.login=a258647adea0e982df705ac3512cbbe47154cfd3</span><br></pre></td></tr></table></figure></li>
<li>åœ¨ç»ˆç«¯ shell æ‰§è¡Œä½ çš„è¿™ä¸ª sonar-project.properties æ–‡ä»¶<code>bash sonar-project.properties</code>ã€‚é™é™ç­‰å¾…10åˆ†é’Ÿå·¦å³â€¦</li>
<li>ç»“æœæŠ¥è¡¨ä¼šåœ¨å…¬ç½‘ip:9000ä¸­å¯è§†åŒ–å±•ç¤º</li>
</ol>
<h3 id="æ•°æ®åº“é…ç½®"><a href="#æ•°æ®åº“é…ç½®" class="headerlink" title="æ•°æ®åº“é…ç½®"></a>æ•°æ®åº“é…ç½®</h3><ul>
<li>è‡ªå¸¦çš„å†…åµŒæ•°æ®åº“æ¯”è¾ƒå°ã€‚å¤„ç†å¤§é¡¹ç›®éœ€è¦é…ä¸€ä¸‹</li>
<li>sonarQubeé»˜è®¤ä¸æ”¯æŒmysqlã€‚éœ€è¦å®‰è£…<a class="link"   href="https://dev.mysql.com/downloads/connector/j/"  target="_blank" rel="noopener">mysql Connector(é©±åŠ¨)<i class="fas fa-external-link-alt"></i></a>åæ‰èƒ½ä½¿ç”¨<br>å®‰è£…æ–¹å¼ï¼šå°†é©±åŠ¨æ”¾åœ¨<code>extensions/jdbc-driver/mysql/</code>ï¼ˆè¿™ä¸ªè·¯å¾„ä¸ç¡®å®šï¼‰ä¸‹</li>
<li>é…ç½®æ–‡ä»¶ï¼š/opt/sonarqube-8.4.0.35506/conf/sonar.properties<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sonar.jdbc.url&#x3D;jdbc:mysql:&#x2F;&#x2F;192.168.1.222:3306&#x2F;sonar?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf8&amp;rewriteBatchedStatements&#x3D;true</span><br></pre></td></tr></table></figure></li>
<li>åœ¨ä½¿ç”¨åº“ä½¿ï¼Œè¦æå‰å»ºç«‹å¥½sonaråº“ï¼Œå‘½ä»¤å‚ç…§å¦‚ä¸‹ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DROP DATABASE sonar;</span><br><span class="line"></span><br><span class="line">CREATE DATABASE sonar CHARACTER SET utf8 COLLATE utf8_general_ci;</span><br><span class="line"></span><br><span class="line">CREATE USER &#39;sonar&#39; IDENTIFIED BY &#39;sonar&#39;;</span><br><span class="line"></span><br><span class="line">GRANT ALL ON sonar.* TO &#39;sonar&#39;@&#39;%&#39; IDENTIFIED BY &#39;sonar&#39;;</span><br><span class="line"></span><br><span class="line">GRANT ALL ON sonar.* TO &#39;sonar&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;sonar&#39;;</span><br><span class="line"></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><p><a class="link"   href="https://hondrytravis.github.io/blog/engineering/sonar.html#sonar"  target="_blank" rel="noopener">è¯¦ç»†æ“ä½œé“¾æ¥<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <categories>
        <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
        <tag>sonarqube</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿›ç¨‹&amp;çº¿ç¨‹&amp;åç¨‹</title>
    <url>/2020/07/08/%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E5%8D%8F%E7%A8%8B/</url>
    <content><![CDATA[<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ul>
<li>è¿›ç¨‹æ˜¯cpuè°ƒåº¦çš„åŸºæœ¬å•ä½</li>
<li>çº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰</li>
<li>åç¨‹ä¸è¢«æ“ä½œç³»ç»Ÿå†…æ ¸æ‰€ç®¡ç†ï¼Œå®Œå…¨ç”±ç¨‹åºæ§åˆ¶ã€‚</li>
</ul>
<h3 id="å¤šç§è¿›ç¨‹"><a href="#å¤šç§è¿›ç¨‹" class="headerlink" title="å¤šç§è¿›ç¨‹"></a>å¤šç§è¿›ç¨‹</h3><p><img src="http://i.feidom.com/%E5%A4%9A%E7%A7%8D%E8%BF%9B%E7%A8%8Ba.png" alt="å®é™…æƒ…å†µ"></p>
<ul>
<li>å•çº¿ç¨‹è¿›ç¨‹çš„forkè¿‡ç¨‹ï¼Œå°†ä¸»çº¿ç¨‹çš„ä»£ç ã€æ•°æ®ã€æ–‡ä»¶ã€å¯„å­˜å™¨çŠ¶æ€ã€æ ˆéƒ½å¤åˆ¶å¤šä»½ã€‚</li>
<li>å¤šçº¿ç¨‹è¿›ç¨‹ä¸­ï¼Œå„ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨çŠ¶æ€å’Œæ ˆã€‚å…±äº«è¿›ç¨‹ä¸­çš„ä»£ç ã€æ•°æ®ã€æ–‡ä»¶ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>æ“ä½œç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>jså®ç°PM2å¤šè¿›ç¨‹åŸç†ï¼ˆç®€ç‰ˆï¼‰</title>
    <url>/2020/07/07/js%E5%AE%9E%E7%8E%B0PM2%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%8E%9F%E7%90%86%EF%BC%88%E7%AE%80%E7%89%88%EF%BC%89/</url>
    <content><![CDATA[<p>äº†è§£<a href="/2020/07/08/è¿›ç¨‹çº¿ç¨‹åç¨‹/">è¿›ç¨‹&amp;çº¿ç¨‹&amp;åç¨‹</a></p>
<h3 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h3><blockquote>
<p>å‰ç«¯å®ç°çš„nodeé¡¹ç›®</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// worker</span></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>);</span><br><span class="line">    res.end(<span class="string">"hello world\n"</span>);</span><br><span class="line">&#125;).listen(<span class="number">8000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="pm2-js"><a href="#pm2-js" class="headerlink" title="pm2.js"></a>pm2.js</h3><blockquote>
<p>æ¨¡æ‹ŸPM2å¤šè¿›ç¨‹</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// master</span></span><br><span class="line"><span class="keyword">var</span> cluster = <span class="built_in">require</span>(<span class="string">'cluster'</span>);</span><br><span class="line"><span class="keyword">var</span> numCPUs = <span class="built_in">require</span>(<span class="string">'os'</span>).cpus().length;   <span class="comment">// å¤šæ ¸cpuçš„æ ¸æ•°</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// cluster.isMasterä¸ºtrueï¼Œè¡¨ç¤ºæ˜¯ä¸»è¿›ç¨‹</span></span><br><span class="line"><span class="keyword">if</span> (cluster.isMaster) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(numCPUs);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; numCPUs; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> worker = cluster.fork();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">"./app.js"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>pm2.jsè¿è¡Œåï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¸»è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹masterï¼‰ã€‚</li>
<li>ç„¶ååˆ›å»ºnumCPUsä¸ªnodeè¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹ç›¸å½“äºå­è¿›ç¨‹ã€‚å—åˆ°ä¸»è¿›ç¨‹masterçš„ç®¡ç†ï¼Œè°ƒåº¦åˆ†é…<br>å…±åˆ›å»ºäº†numCPUs+1ä¸ªè¿›ç¨‹<blockquote>
<p>é‡ç‚¹åœ¨<code>cluster.fork()</code>æ¥forkå­è¿›ç¨‹ã€‚ç„¶åcluster.isMasterä¸ºfalseæ—¶ï¼Œåˆ›å»ºçš„å­è¿›ç¨‹å»<code>require(&quot;./app.js&quot;)</code>ï¼Œå®ç°å¤šè¿›ç¨‹ç®¡ç†ã€‚</p>
</blockquote>
</li>
</ul>
]]></content>
      <categories>
        <category>nodejs</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
        <tag>PM2</tag>
        <tag>è¿›ç¨‹ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxå…å¯†è¿œç¨‹ç™»å½•</title>
    <url>/2020/07/07/Linux%E5%85%8D%E5%AF%86%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95/</url>
    <content><![CDATA[<p>å‰ç«¯åœ¨éƒ¨ç½²é¡¹ç›®æ—¶ï¼Œä½¿ç”¨Linuxå…å¯†è¿œç¨‹ç™»å½•å¯ä»¥å®ç°è‡ªåŠ¨åŒ–ä¸­çš„ä¸€ç¯ã€‚</p>
<h3 id="å…å¯†ç™»å½•çš„åŸç†"><a href="#å…å¯†ç™»å½•çš„åŸç†" class="headerlink" title="å…å¯†ç™»å½•çš„åŸç†"></a>å…å¯†ç™»å½•çš„åŸç†</h3><p>sshï¼Œå¯†ç å­¦ï¼Œå…¬é’¥ï¼Œç§é’¥</p>
<h3 id="å…å¯†ç™»å½•çš„æ­¥éª¤"><a href="#å…å¯†ç™»å½•çš„æ­¥éª¤" class="headerlink" title="å…å¯†ç™»å½•çš„æ­¥éª¤"></a>å…å¯†ç™»å½•çš„æ­¥éª¤</h3><blockquote>
<p>ä¸‹æ–‡ä¸­ï¼š[ä½ è‡ªå·±çš„åå­—]æ˜¯ç§é’¥ï¼Œ[ä½ è‡ªå·±çš„åå­—_rsa]æ˜¯å…¬é’¥</p>
</blockquote>
<ul>
<li><p>ç”Ÿæˆå¯†åŒ™å¯¹</p>
<p>  <code>$ ssh-keygen -t rsa -C [ä½ è‡ªå·±çš„åå­—] -f [ä½ è‡ªå·±çš„åå­—_rsa]</code></p>
</li>
<li><p>ä¸Šä¼ é…ç½®å…¬é’¥</p>
<ul>
<li>ä¸Šä¼ å…¬é’¥åˆ°æœåŠ¡å™¨å¯¹åº”è´¦å·çš„homeè·¯å¾„ä¸‹çš„.ssh/ä¸­<br><code>$ ssh-copy-id -i [ä½ è‡ªå·±çš„åå­—_rsa] [ç”¨æˆ·å@æœåŠ¡å™¨ipæˆ–åŸŸå]</code></li>
<li>é…ç½®å…¬é’¥æ–‡ä»¶è®¿é—®æƒé™ä¸º 600  (è®¾ç½®æ‹¥æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººä¸å¯è¯»å†™æ‰§è¡Œ -rwâ€”â€”-)<br><code>$ chmod 600 [ä½ è‡ªå·±çš„åå­—_rsa]</code></li>
</ul>
</li>
<li><p>é…ç½®æœ¬åœ°ç§é’¥</p>
<ul>
<li>æŠŠç¬¬ä¸€æ­¥ç”Ÿæˆçš„ç§é’¥å¤åˆ¶åˆ°ä½ çš„homeç›®å½•ä¸‹çš„.ssh/ è·¯å¾„ä¸‹</li>
<li>é…ç½®ä½ çš„ç§é’¥æ–‡ä»¶è®¿é—®æƒé™ä¸º 600  (-rwâ€”â€”-,ä¸æ˜¯600ç³»ç»Ÿä¼šè®¤ä¸ºä¸å®‰å…¨æ‹’ç»è®¿é—®)<br><code>$ chmod 600 [ä½ è‡ªå·±çš„åå­—]</code><blockquote>
<p>è¿™ä¸€æ­¥ä¹‹åå·²ç»å¯ä»¥å…å¯†ç™»å½•<code>ssh -i [ä½ è‡ªå·±çš„åå­—] root@[ip]</code></p>
</blockquote>
</li>
</ul>
</li>
<li><p>å…å¯†ç™»é™†åŠŸèƒ½çš„æœ¬åœ°é…ç½®æ–‡ä»¶(æ›´æ–¹ä¾¿çš„å…å¯†ç™»å½•æ–¹å¼)</p>
<ul>
<li>ç¼–è¾‘è‡ªå·±homeç›®å½•çš„.ssh/ è·¯å¾„ä¸‹çš„configæ–‡ä»¶<code>vi config</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¤šä¸»æœºé…ç½®</span></span><br><span class="line">Host gateway-produce</span><br><span class="line">HostName IPæˆ–ç»‘å®šçš„åŸŸå</span><br><span class="line">Port 22</span><br><span class="line">Host node-produce</span><br><span class="line">HostName IPæˆ–ç»‘å®šçš„åŸŸå</span><br><span class="line">Port 22</span><br><span class="line">Host java-produce</span><br><span class="line">HostName IPæˆ–ç»‘å®šçš„åŸŸå</span><br><span class="line">Port 22</span><br><span class="line"></span><br><span class="line">Host *-produce (å¤šä¸»æœºåˆ«åï¼Œå…å¯†ç™»å½•æ—¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªåˆ«åç™»å½•)</span><br><span class="line">User root</span><br><span class="line">IdentityFile ~/.ssh/ä½ è‡ªå·±çš„åå­—_rsa</span><br><span class="line">Protocol 2</span><br><span class="line">Compression yes</span><br><span class="line">ServerAliveInterval 60</span><br><span class="line">ServerAliveCountMax 20</span><br><span class="line">LogLevel INFO</span><br><span class="line"></span><br><span class="line"><span class="comment">#å•ä¸»æœºé…ç½®</span></span><br><span class="line">Host feidom-cloud (åˆ«åï¼Œå…å¯†ç™»å½•æ—¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªåˆ«åç™»å½•)</span><br><span class="line">User root</span><br><span class="line">HostName IPæˆ–ç»‘å®šçš„åŸŸå</span><br><span class="line">IdentityFile ~/.ssh/ä½ è‡ªå·±çš„åå­—_rsa</span><br><span class="line">Protocol 2</span><br><span class="line">Compression yes</span><br><span class="line">ServerAliveInterval 60</span><br><span class="line">ServerAliveCountMax 20</span><br><span class="line">LogLevel INFO</span><br><span class="line"></span><br><span class="line"><span class="comment">#å•ä¸»æœºé…ç½®</span></span><br><span class="line">Host feidom2-site</span><br><span class="line">User git</span><br><span class="line">HostName IPæˆ–ç»‘å®šçš„åŸŸå</span><br><span class="line">IdentityFile ~/.ssh/ä½ è‡ªå·±çš„åå­—_rsa</span><br><span class="line">Protocol 2</span><br><span class="line">Compression yes</span><br><span class="line">ServerAliveInterval 60</span><br><span class="line">ServerAliveCountMax 20</span><br><span class="line">LogLevel INFO</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®configæ–‡ä»¶çš„è®¿é—®æƒé™ä¸º 644<blockquote>
<p>ä½¿ç”¨<code>ssh [åˆ«å]</code></p>
</blockquote>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>categorieså’Œtagsé¡µé¢ä¸è‡ªåŠ¨æ”¶å½•çš„é—®é¢˜</title>
    <url>/2020/07/06/hexo%E7%9A%84categories%E5%92%8Ctags%E9%A1%B5%E9%9D%A2%E4%B8%8D%E8%87%AA%E5%8A%A8%E6%94%B6%E5%BD%95%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>åœ¨ä½¿ç”¨hexoçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°åˆ†ç±»(categories)é¡µé¢å’Œæ ‡ç­¾(tags)é¡µé¢ä¸è‡ªåŠ¨æ”¶å½•æ–‡ç« (å…¶å®æ”¶å½•äº†ï¼Œåªæ˜¯æ²¡æ˜¾ç¤º)çš„categorieså’Œtagsã€‚<br>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¼–è¾‘categories/index.md<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: åˆ†ç±»</span><br><span class="line">date: 2020-07-01 08:56:35</span><br><span class="line">type: categories</span><br><span class="line"></span><br><span class="line">å¢åŠ ä¸‹é¢è¿™ä¸€è¡Œ</span><br><span class="line">layout: &quot;categories&quot;</span><br></pre></td></tr></table></figure></li>
<li>tags/index.md<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">title: æ ‡ç­¾</span><br><span class="line">date: 2020-07-01 09:03:55</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line"></span><br><span class="line">å¢åŠ ä¸‹é¢è¿™ä¸€è¡Œ</span><br><span class="line">layout: &quot;tags&quot;</span><br></pre></td></tr></table></figure>

</li>
</ul>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>é—®é¢˜è§£å†³</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>gitå¸¸ç”¨å‘½ä»¤(ä¸ªäººæ€»ç»“)</title>
    <url>/2020/07/04/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h3 id="gitæ¦‚å¿µ"><a href="#gitæ¦‚å¿µ" class="headerlink" title="gitæ¦‚å¿µ"></a>gitæ¦‚å¿µ</h3><ul>
<li>Workspaceï¼šå·¥ä½œåŒº</li>
<li>Index / Stageï¼šæš‚å­˜åŒº</li>
<li>Repositoryï¼šæœ¬åœ°ä»“åº“</li>
<li>Remoteï¼šè¿œç¨‹ä»“åº“</li>
</ul>
<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><ul>
<li><p>æŸ¥çœ‹git configé…ç½®<br><code>git config --list</code></p>
</li>
<li><p>git configå…¨å±€é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">"feidom"</span></span><br><span class="line">git config --global user.email <span class="string">"qiaoxiansen@hotmail.com"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>git configé’ˆå¯¹å•ä¸ªé¡¹ç›®é…ç½®ç”¨æˆ·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd é¡¹ç›®ç›®å½•,ä½œç”¨äºå½“å‰é¡¹ç›®ä¸‹çš„.gitç›®å½•ä¸‹çš„config</span></span><br><span class="line">git config user.name <span class="string">"feidom"</span></span><br><span class="line">git config user.email <span class="string">"qiaoxiansen@hotmail.com"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><p>å…‹éš†ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²<br><code>$ git clone [url]</code></p>
</li>
<li><p>æŸ¥çœ‹æœ¬åœ°ä»“åº“åˆ†æ”¯<br><code>$ git branch</code></p>
</li>
<li><p>æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯<br><code>$ git branch -a</code></p>
</li>
<li><p>æŸ¥çœ‹æ‰€æœ‰æ‰€æœ‰è¿œç¨‹åˆ†æ”¯<br><code>$ git branch -r</code></p>
</li>
<li><p>æŸ¥çœ‹åˆ†æ”¯å…³è”å…³ç³»<br><code>$ git branch -vv</code></p>
</li>
</ul>
<hr>
<ul>
<li><p>æŸ¥çœ‹ä¸åŒ<br><code>$ git diff</code></p>
</li>
<li><p>æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶<br><code>$ git status</code></p>
</li>
<li><p>æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº<br><code>$ git add .</code></p>
</li>
<li><p>æäº¤æš‚å­˜åŒºåˆ°æœ¬åœ°ä»“åº“<br><code>$ git commit -m [æäº¤ä¿¡æ¯]</code></p>
</li>
<li><p>æ‹‰å–è¿œç¨‹ä»“åº“å¸¦ä»£ç åˆ°æœ¬åœ°ä»“åº“å¹¶åˆå¹¶<br><code>$ git pull [remote] [branch]</code><br><code>$ git pull</code>(åˆ†æ”¯æœ‰å…³è”å…³ç³»æ—¶)</p>
</li>
<li><p>ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“<br><code>$ git push [remote] [branch]</code><br><code>$ git push</code>(åˆ†æ”¯æœ‰å…³è”å…³ç³»æ—¶)</p>
</li>
</ul>
<hr>
<ul>
<li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºåˆ†æ”¯ï¼ˆå†…å®¹æ¥è‡ªäº’è”ç½‘ï¼‰<br><code>$ git checkout --orphan [æ–°çš„åˆ†æ”¯å]</code> (å»ºä¸€ä¸ªæ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„åˆ†æ”¯ï¼Œä½†æ˜¯ä¼šå¤åˆ¶å½“å‰åˆ†æ”¯çš„å†…å®¹åˆ°æ–°çš„åˆ†æ”¯ä¸Šã€‚)</li>
</ul>
<blockquote>
<p>&emsp; è¿™ä¸ªå‘½ä»¤åˆ›å»ºäº†æ–°çš„åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯ä¸‹ï¼Œå¹¶ä¸”é‡Œè¾¹æœ‰ä¸Šä¸ªåˆ†æ”¯çš„å†…å®¹<br>&emsp; <strong>æ³¨æ„</strong> ï¼šå…¶å®è¿™ä¸ªæ—¶å€™æ–°çš„åˆ†æ”¯è¿˜ä¸èƒ½è¯´æ˜¯ä¸€ä¸ªåˆ†æ”¯ï¼Œä½ æŸ¥çœ‹åˆ†æ”¯çš„è¯ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªåˆ†æ”¯çš„ï¼Œä½ å¿…é¡»è¦æäº¤ä¸€æ¬¡ï¼Œè¿™ä¸ªåˆ†æ”¯æ‰ç®—æ˜¯çœŸçš„åˆ›å»ºå‡ºæ¥äº†<br>&emsp; å› ä¸ºè¿™ä¸ªåˆ†æ”¯æ²¡æœ‰çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ²¡æœ‰ä»»ä½•çš„å†å²ï¼Œåªéœ€è¦è°ƒç”¨<br>&emsp; <code>$ git rm -rf .</code><br>&emsp; åˆ é™¤æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆåªä¼šåˆ é™¤åŠ å…¥ç‰ˆæœ¬ç®¡ç†çš„æ–‡ä»¶ï¼‰ï¼Œç„¶åä½ å¯ä»¥éšä¾¿åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæäº¤ä¹‹åï¼Œè¿™ä¸ªæ–°çš„ç©ºåˆ†æ”¯å°±ç®—æ˜¯åˆ›å»ºå®Œæˆäº†ã€‚</p>
</blockquote>
<ul>
<li><p>æ–°å»ºä¸€ä¸ªæœ¬åœ°åˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯<br><code>$ git checkout -b [æœ¬åœ°åˆ†æ”¯] [remote]</code>(-bä¼šå»ºç«‹æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„å…³è”å…³ç³»)</p>
</li>
<li><p>ä»æŸä¸ªæäº¤è®°å½•(2b5c3292)æ‹‰ä¸€ä¸ªæ–°åˆ†æ”¯å‡ºæ¥<br><code>$ git checkout 2b5c3292 -b [branch]</code></p>
</li>
<li><p>æäº¤å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“çš„å¯¹åº”çš„æ–°åˆ†æ”¯<br><code>$ git push -u origin [branch]</code>(-uä¼šå»ºç«‹æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„å…³è”å…³ç³»)</p>
</li>
<li><p>æ–°å»ºæœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å…³è”å…³ç³»<br><code>git branch --set-upstream-to [è¿œç¨‹åˆ†æ”¯] [æœ¬åœ°åˆ†æ”¯]</code></p>
</li>
<li><p>åˆ é™¤æœ¬åœ°åˆ†æ”¯<br>åˆ‡åˆ°å…¶ä»–åˆ†æ”¯ï¼Œç„¶å<code>git branch -d [æœ¬åœ°åˆ†æ”¯]</code></p>
</li>
<li><p>ä»è¿œç¨‹è·å–å…¶ä»–ç”¨æˆ·pushä¸Šæ¥çš„æ–°åˆ†æ”¯<br><code>git fetch</code></p>
</li>
</ul>
<hr>
<ul>
<li><p>æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯<br><code>git remote -v</code></p>
</li>
<li><p>ç§»é™¤è¿œç¨‹ä»“åº“<br><code>git remote remove origin</code></p>
</li>
<li><p>æ·»åŠ è¿œç¨‹ä»“åº“<br><code>git remote add origin [è¿œç¨‹ä»“åº“åœ°å€]</code></p>
</li>
<li><p>æŸ¥çœ‹è¯¥åˆ†æ”¯çš„è¿œç¨‹ä»“åº“<br><code>git remote show</code><br>upstreamï¼šè¢«forkçš„ä»“åº“/originï¼šè‡ªå·±forkçš„ä»“åº“</p>
</li>
<li><p>ä»è‡ªå·±æœ¬åœ°åˆ‡ä¸€ä¸ªåˆ†æ”¯å‡ºæ¥<br><code>git checkout -b [æœ¬åœ°åˆ†æ”¯å]</code></p>
</li>
<li><p>ä»è¿œç¨‹ä»“åº“åœ°å€pullä»£ç <br><code>git pull origin master --rebase</code> å…ˆæ‹‰è‡ªå·±forkä»“åº“çš„æœ€æ–°ä»£ç <br><code>git pull upstream master --rebase</code> å†æ‹‰è¢«forkä»“åº“çš„æœ€æ–°ä»£ç </p>
</li>
<li><p>æ¨é€ä»£ç åˆ°è‡ªå·±forkä»“åº“åˆ†æ”¯<br><code>git push origin [è‡ªå·±è¿œç¨‹ä»“åº“çš„åˆ†æ”¯]</code></p>
</li>
<li><p>åˆå¹¶å¤šä¸ªcommitè®°å½•ä¸ºä¸€ä¸ª<br><code>git rebase -i HEAD~</code></p>
</li>
<li><p>è‡ªå·±çš„è¿œç«¯æpull requeståˆ°upstreamçš„è¿œç«¯ï¼Œgithubä¸Šæ“ä½œ</p>
</li>
</ul>
<hr>
<ul>
<li>vscodeåˆå¹¶åˆ†æ”¯<br>åœ¨vscodeç•Œé¢ï¼Œè¾“å…¥ï¼š<code>ctrl(win)/command(mac)+shift+p</code>,ç„¶åè¾“å…¥<code>git merge</code>ï¼Œç„¶åé€‰ä¸€ä¸ªè¦åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯ï¼Œå›è½¦ç¡®å®šå³å¯ã€‚<br><img src="https://image-static.segmentfault.com/800/712/800712115-59e96580eae4c_articlex" alt="git merge"><br><img src="https://image-static.segmentfault.com/236/385/2363856556-59e965b2e3674_articlex" alt="é€‰æ‹©åˆ†æ”¯"></li>
</ul>
<h3 id="gité—®é¢˜è§£å†³ï¼š"><a href="#gité—®é¢˜è§£å†³ï¼š" class="headerlink" title="gité—®é¢˜è§£å†³ï¼š"></a>gité—®é¢˜è§£å†³ï¼š</h3><ul>
<li>git clone æ—¶å‡ºé”™ï¼š <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">error: RPC failed; result&#x3D;35, HTTP code &#x3D; 0</span><br><span class="line">fatal: The remote end hung up unexpectedly</span><br></pre></td></tr></table></figure>
è§£å†³ï¼š<ul>
<li>æŸ¥çœ‹å…¨å±€çš„postBufferé…ç½® <code>git config http.postBuffer</code></li>
<li>æŠŠè¿™ä¸ªé…ç½®æ”¹å¤§ä¸€ç‚¹ï¼š <code>git config http.postBuffer 24288000</code></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>svgå›¾æ ‡çš„ä½¿ç”¨</title>
    <url>/2020/07/04/svg%E5%9B%BE%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h3 id="svgå›¾æ ‡åœ¨å‰ç«¯åº”ç”¨çš„ä¼˜ç‚¹"><a href="#svgå›¾æ ‡åœ¨å‰ç«¯åº”ç”¨çš„ä¼˜ç‚¹" class="headerlink" title="svgå›¾æ ‡åœ¨å‰ç«¯åº”ç”¨çš„ä¼˜ç‚¹"></a>svgå›¾æ ‡åœ¨å‰ç«¯åº”ç”¨çš„ä¼˜ç‚¹</h3><ul>
<li>å’Œä¼ ç»Ÿçš„å›¾åƒæ¯”èµ·æ¥ï¼Œå°ºå¯¸æ›´å°ï¼Œä¸”å¯å‹ç¼©æ€§æ›´å¼º</li>
<li>å¯ä¼¸ç¼©</li>
<li>ä»»ä½•åˆ†è¾¨ç‡ä¹‹ä¸‹éƒ½å¯ä»¥è¢«å®Œç¾çš„æ‰“å°</li>
<li>svgä¸­å›¾åƒä¸­çš„æ–‡æœ¬æ˜¯å¯é€‰çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯æœç´¢çš„ï¼Œå¾ˆé€‚åˆåšåœ°å›¾ã€‚</li>
</ul>
<h3 id="svgå¿…é¡»çŸ¥é“çš„æ ‡ç­¾çŸ¥è¯†"><a href="#svgå¿…é¡»çŸ¥é“çš„æ ‡ç­¾çŸ¥è¯†" class="headerlink" title="svgå¿…é¡»çŸ¥é“çš„æ ‡ç­¾çŸ¥è¯†"></a>svgå¿…é¡»çŸ¥é“çš„æ ‡ç­¾çŸ¥è¯†</h3><ul>
<li><p><code>&lt;defs&gt;</code><br>SVG å…è®¸æˆ‘ä»¬å®šä¹‰ä»¥åéœ€è¦é‡å¤ä½¿ç”¨çš„å›¾å½¢å…ƒç´ ã€‚ å»ºè®®æŠŠæ‰€æœ‰éœ€è¦å†æ¬¡ä½¿ç”¨çš„å¼•ç”¨å…ƒç´ å®šä¹‰åœ¨defså…ƒç´ é‡Œé¢ã€‚è¿™æ ·åšå¯ä»¥å¢åŠ SVGå†…å®¹çš„æ˜“è¯»æ€§å’Œå¯è®¿é—®æ€§ã€‚ åœ¨defså…ƒç´ ä¸­å®šä¹‰çš„å›¾å½¢å…ƒç´ ä¸ä¼šç›´æ¥å‘ˆç°ã€‚ ä½ å¯ä»¥åœ¨ä½ çš„è§†å£çš„ä»»æ„åœ°æ–¹åˆ©ç”¨<code>&lt;use&gt;</code>å…ƒç´ å‘ˆç°è¿™äº›å…ƒç´ ã€‚</p>
</li>
<li><p><code>&lt;use&gt;</code><br>å®˜æ–¹è¯´æ³•ï¼šä½¿ç”¨URIå¼•ç”¨ä¸€ä¸ª<G>,<svg>æˆ–å…¶ä»–å…·æœ‰ä¸€ä¸ªå”¯ä¸€çš„IDå±æ€§å’Œé‡å¤çš„å›¾å½¢å…ƒç´ ã€‚å¤åˆ¶çš„æ˜¯åŸå§‹çš„å…ƒç´ ï¼Œå› æ­¤æ–‡ä»¶ä¸­çš„åŸå§‹å­˜åœ¨åªæ˜¯ä¸€ä¸ªå‚è€ƒã€‚åŸå§‹å½±å“åˆ°æ‰€æœ‰å‰¯æœ¬çš„ä»»ä½•æ”¹å˜ã€‚<br>ç†è§£ï¼šä½œç”¨æ˜¯èƒ½ä»SVGæ–‡æ¡£å†…éƒ¨å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡å”¯ä¸€çš„IDå±æ€§å…‹éš†å®ƒï¼Œå¹¶æŠŠå®ƒè¾“å‡ºåˆ°åˆ«å¤„ã€‚è·Ÿâ€˜å¼•ç”¨â€™å¾ˆç›¸ä¼¼ï¼Œä½†å®ƒæ˜¯æ·±åº¦å…‹éš†ã€‚</p>
</li>
<li><p><code>&lt;path&gt;</code><br>SVGè·¯å¾„ï¼Œpathå…ƒç´ æ˜¯ç”¨æ¥å®šä¹‰å½¢çŠ¶çš„é€šç”¨å…ƒç´ ã€‚æ‰€æœ‰çš„åŸºæœ¬å½¢çŠ¶éƒ½å¯ä»¥ç”¨pathå…ƒç´ æ¥åˆ›å»ºã€‚</p>
<h3 id="svgå¸¸ç”¨ä¿®æ”¹"><a href="#svgå¸¸ç”¨ä¿®æ”¹" class="headerlink" title="svgå¸¸ç”¨ä¿®æ”¹"></a>svgå¸¸ç”¨ä¿®æ”¹</h3></li>
<li><p>ä¿®æ”¹å®½(width)é«˜(height)<br>  ä¿®æ”¹svgæ ‡ç­¾å†…çš„widthã€heightæ¥ä¿®æ”¹å›¾æ ‡çš„å¤§å°å®½(width)é«˜(height)</p>
</li>
<li><p>ä¿®æ”¹é¢œè‰²</p>
<ol>
<li>åœ¨styleæ ‡ç­¾ä¸­å®šä¹‰ç±»ï¼Œä½¿ç”¨fillå…³é”®å­—å®šä¹‰é¢œè‰²ï¼Œå¦‚.st7ã€‚</li>
<li>åœ¨pathæ ‡ç­¾ä¸­å¢åŠ ç±»åï¼šclass=â€st7â€ï¼Œç”¨ç±»åæ§åˆ¶é¢œè‰²ã€‚</li>
</ol>
</li>
</ul>
<p>å¦‚ä¸‹ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!--  ä¿®æ”¹svgæ ‡ç­¾å†…çš„widthã€heightæ¥ä¿®æ”¹å›¾æ ‡çš„å¤§å°å®½(width)é«˜(height)  --&gt;</span><br><span class="line">&lt;svg version&#x3D;&quot;1.1&quot; id&#x3D;&quot;å›¾å±‚_1&quot; xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; x&#x3D;&quot;0px&quot; y&#x3D;&quot;0px&quot;</span><br><span class="line">  width&#x3D;&quot;17px&quot; height&#x3D;&quot;16px&quot; viewBox&#x3D;&quot;0 0 11 11&quot; style&#x3D;&quot;enable-background:new 0 0 11 11;&quot; xml:space&#x3D;&quot;preserve&quot;&gt;</span><br><span class="line">&lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line"> .st0&#123;fill:#08A6F1;&#125;</span><br><span class="line"> .st1&#123;fill:#18C27B;&#125;</span><br><span class="line"> .st2&#123;fill:#FFA200;&#125;</span><br><span class="line"> .st3&#123;fill-rule:evenodd;clip-rule:evenodd;fill:#18C27B;&#125;</span><br><span class="line"> .st4&#123;fill-rule:evenodd;clip-rule:evenodd;fill:#FFA200;&#125;</span><br><span class="line"> .st5&#123;fill:#F44436;&#125;</span><br><span class="line"> .st6&#123;clip-path:url(#SVGID_2_);&#125;</span><br><span class="line"> .st7&#123;fill:#00CDD9;&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;!--  1.åœ¨styleæ ‡ç­¾ä¸­å®šä¹‰ç±»ï¼Œä½¿ç”¨fillå…³é”®å­—å®šä¹‰é¢œè‰²ï¼Œå¦‚.st7ã€‚  --&gt;</span><br><span class="line">&lt;!--  2.åœ¨pathæ ‡ç­¾ä¸­å¢åŠ ç±»åï¼šclass&#x3D;&quot;st7&quot;ï¼Œç”¨ç±»åæ§åˆ¶é¢œè‰²ã€‚  --&gt;</span><br><span class="line">&lt;path class&#x3D;&quot;st7&quot; d&#x3D;&quot;M11,10.7c0,0.2-0.2,0.3-0.3,0.3H0.3C0.2,11,0,10.8,0,10.7V10c0-0.2,0.2-0.3,0.3-0.3h10.3c0.2,0,0.3,0.2,0.3,0.3L11,10.7</span><br><span class="line"> L11,10.7z M1.9,4.8l3.3,3.4c0.1,0.1,0.4,0.1,0.5,0l0,0l3.3-3.4c0.1-0.1,0.1-0.2,0.1-0.4C9.1,4.3,9,4.2,8.8,4.2h-2V0.3</span><br><span class="line"> C6.9,0.2,6.7,0,6.5,0H4.5C4.3,0,4.1,0.2,4.1,0.3v3.9h-2C2,4.2,1.8,4.4,1.8,4.6C1.8,4.7,1.8,4.8,1.9,4.8L1.9,4.8z&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;svg&gt;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>svg</tag>
      </tags>
  </entry>
  <entry>
    <title>NodeJså‰ç«¯è¯äº‹äºº</title>
    <url>/2020/07/01/NodeJs%E5%89%8D%E7%AB%AF%E8%AF%9D%E4%BA%8B%E4%BA%BA/</url>
    <content><![CDATA[<h4 id="NodeJs"><a href="#NodeJs" class="headerlink" title="NodeJs"></a>NodeJs</h4><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œæ—¶ã€‚ <a class="link"   href="http://nodejs.cn/"  target="_blank" rel="noopener">Node.js ä¸­æ–‡ç½‘<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="NodeJsåº”ç”¨åœºæ™¯"><a href="#NodeJsåº”ç”¨åœºæ™¯" class="headerlink" title="NodeJsåº”ç”¨åœºæ™¯"></a>NodeJsåº”ç”¨åœºæ™¯</h4><ul>
<li><p>æˆ‘è¦çš„åªæ˜¯ä¸€ä¸ªé¦™è•‰ï¼Œå¾—åˆ°çš„ç¡®æ˜¯æ•´ä¸ªæ£®æ—<br><img src="http://i.feidom.com/node_a.jpg" alt="å®é™…æƒ…å†µ"></p>
</li>
<li><p>SSR(æœåŠ¡å™¨ç«¯æ¸²æŸ“)</p>
<ul>
<li>SEOå‹å¥½</li>
<li>ä¼˜åŒ–å•é¡µåº”ç”¨çš„é¦–å±åŠ è½½æ—¶é—´</li>
</ul>
</li>
</ul>
<h4 id="NodeJsé—ªäº®ç™»åœº"><a href="#NodeJsé—ªäº®ç™»åœº" class="headerlink" title="NodeJsé—ªäº®ç™»åœº"></a>NodeJsé—ªäº®ç™»åœº</h4><p>SPA(single page web application) + NodeJs<br>æ–¹æ¡ˆï¼šNodeJsåšProxy(ä»£ç†)å±‚ï¼ŒåŠ è½½webé¡µï¼Œè¿æ¥åå°æœåŠ¡ã€‚</p>
<p>å®ç°äº†:</p>
<ul>
<li>æ¶ˆå‡æ¥å£è¿”å›çš„responseã€‚ç»è¿‡NodeJså±‚å¤„ç†è¿”å›çš„æ•°æ®ï¼Œå‰ç«¯æ‹¿åˆ°çš„åªæœ‰å¥¹è¯¥æ‹¿åˆ°çš„ä¸œè¥¿ï¼Œæ•°æ®å°äº†ï¼Œä¼ è¾“å¿«äº†ï¼Œæ€§èƒ½æ›´å¥½ã€‚</li>
<li>çœŸå‡è·¯ç”±æ··ç”¨ã€‚Nodeå¯ä»¥ç‹¬ç«‹æ§åˆ¶è·¯ç”±ï¼Œå¹¶ä¸å—åç«¯é™åˆ¶ï¼Œå¯ä»¥ç‹¬ç«‹éƒ¨ç½²ä¸Šçº¿ã€‚å‰ç«¯æ‹¥æœ‰æ›´å¼ºçš„ä¸»åŠ¨æ€§ã€‚<br>  Nodeå¯ä»¥ç‹¬ç«‹æ§åˆ¶è·¯ç”±ï¼Œå¯ä»¥åš<strong>åŒæ„</strong>ã€‚</li>
</ul>
<p>Q&amp;Aï¼š<br>    &emsp;Q:ä¸ºä»€ä¹ˆç”¨NodeJsåšä»£ç†å±‚ï¼Œè€Œä¸ç”¨å…¶ä»–è¯­è¨€ï¼Ÿ<br>    &emsp;A:NodeJsæ˜¯åŸºäºJavaScriptè¯­è¨€çš„ï¼Œå‰ç«¯æ¡†æ¶Vueç­‰åªæä¾›Jsçš„API(Nuxt.js)ã€‚</p>
]]></content>
      <categories>
        <category>nodejs</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/06/27/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a class="link"   href="https://hexo.io/"  target="_blank" rel="noopener">Hexo<i class="fas fa-external-link-alt"></i></a>! This is your very first post. Check <a class="link"   href="https://hexo.io/docs/"  target="_blank" rel="noopener">documentation<i class="fas fa-external-link-alt"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class="link"   href="https://hexo.io/docs/troubleshooting.html"  target="_blank" rel="noopener">troubleshooting<i class="fas fa-external-link-alt"></i></a> or you can ask me on <a class="link"   href="https://github.com/hexojs/hexo/issues"  target="_blank" rel="noopener">GitHub<i class="fas fa-external-link-alt"></i></a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a class="link"   href="https://hexo.io/docs/writing.html"  target="_blank" rel="noopener">Writing<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a class="link"   href="https://hexo.io/docs/server.html"  target="_blank" rel="noopener">Server<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a class="link"   href="https://hexo.io/docs/generating.html"  target="_blank" rel="noopener">Generating<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a class="link"   href="https://hexo.io/docs/one-command-deployment.html"  target="_blank" rel="noopener">Deployment<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="Clean"><a href="#Clean" class="headerlink" title="Clean"></a>Clean</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure>

<h3 id="New-categories"><a href="#New-categories" class="headerlink" title="New categories"></a>New categories</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new page categories</span><br></pre></td></tr></table></figure>

<h3 id="New-tags"><a href="#New-tags" class="headerlink" title="New tags"></a>New tags</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new page tags</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>hexo</category>
      </categories>
  </entry>
</search>
